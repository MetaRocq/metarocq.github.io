<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library VerifiedExtraction.Benchmarks.vs</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">BinPos</span> <span class="id" title="var">micromega.Lia</span>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Strict</span> <span class="id" title="keyword">Implicit</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">option</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">option</span> <span class="id" title="var">B</span>) (<span class="id" title="var">o</span> : <span class="id" title="var">option</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">omap</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">o</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">Some</span> (<span class="id" title="var">h</span> <span class="id" title="var">a</span>) | <span class="id" title="var">None</span> ⇒ <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">obnd</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">o</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">a</span> | <span class="id" title="var">None</span> ⇒ <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">option</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">obnd</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span>].<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isSome</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">o</span> : <span class="id" title="var">option</span> <span class="id" title="var">A</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">o</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">comp</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compose</span> := <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">comp</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">compose</span> [<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>].<br/>

<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;oo" := <span class="id" title="var">compose</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 54, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Stdlib.Lists.List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">zip_with_acc</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">acc</span> (<span class="id" title="var">l1</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">l1'</span>, <span class="id" title="var">b</span> :: <span class="id" title="var">l2'</span> ⇒ (<span class="id" title="var">a</span>, <span class="id" title="var">b</span>) :: <span class="id" title="var">zip_with_acc</span> <span class="id" title="var">acc</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">zip</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} := @<span class="id" title="var">zip_with_acc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> [].<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">iter</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">A</span> → <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iter</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> ⇒ <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ⇒ <span class="id" title="var">iter</span> <span class="id" title="var">n'</span> (<span class="id" title="var">f</span> <span class="id" title="var">n'</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">iter</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">iter</span> [<span class="id" title="var">A</span>].<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">tryfind</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">A</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">E</span> + <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">tryfind</span> (<span class="id" title="var">err</span> : <span class="id" title="var">E</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">inl</span> <span class="id" title="var">_</span> <span class="id" title="var">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">l'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inl</span> <span class="id" title="var">err'</span> ⇒ <span class="id" title="var">tryfind</span> <span class="id" title="var">err'</span> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inr</span> <span class="id" title="var">success</span> <span class="id" title="keyword">as</span> <span class="id" title="var">r</span> ⇒ <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">tryfind</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">max</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) := <span class="id" title="keyword">if</span> <span class="id" title="var">Nat.leb</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="keyword">then</span> <span class="id" title="var">m</span> <span class="id" title="keyword">else</span> <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">maxs</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) := <span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ⇒ <span class="id" title="var">max</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) <span class="id" title="var">l</span> 0.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">elemb</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) := <span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">m</span> ⇒ <span class="id" title="var">Nat.eqb</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Ppred</span> := <span class="id" title="var">Pos.pred</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Ple</span> := <span class="id" title="var">Pos.le</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Plt</span> := <span class="id" title="var">Pos.lt</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Ncompare</span> := <span class="id" title="var">N.compare</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Nle</span> := <span class="id" title="var">N.le</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Psucc</span> := <span class="id" title="var">Pos.succ</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ppred_decrease</span> <span class="id" title="var">n</span> : (<span class="id" title="var">n</span>&lt;&gt;1)%<span class="id" title="var">positive</span> → (<span class="id" title="var">nat_of_P</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>)&lt;<span class="id" title="var">nat_of_P</span> <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Psucc_pred</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hpred</span> | <span class="id" title="var">Hpred</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> <span class="id" title="var">n</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hpred</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_of_P_succ_morphism</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">Ppred_tac</span> <span class="id" title="var">n</span> := <br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Ppred_decrease</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span> <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>||<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>); <span class="id" title="tactic">congruence</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Pleb</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">positive</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Pcompare</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">Eq</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pleb_Ple</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">positive</span>) : <span class="id" title="var">Pleb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">true</span> ↔ <span class="id" title="var">Ple</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Pleb</span>, <span class="id" title="var">Ple</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">intro</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pos.compare</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Pos.compare</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Pos.compare_cont</span> <span class="id" title="var">Eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">NArith</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Nleb</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">N</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Ncompare</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Nleb_Nle</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">N</span>) : <span class="id" title="var">Nleb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">true</span> ↔ <span class="id" title="var">Nle</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Nleb</span>, <span class="id" title="var">Nle</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">intro</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="var">remember</span> ((<span class="id" title="var">x</span> ?= <span class="id" title="var">y</span>)%<span class="id" title="var">N</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">revc</span>.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">revc</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">revc</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ret_kind</span> (<span class="id" title="var">val</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">Success</span> : <span class="id" title="var">val</span> → <span class="id" title="var">ret_kind</span> <span class="id" title="var">val</span><br/>
| <span class="id" title="var">Failure</span> : <span class="id" title="var">ret_kind</span> <span class="id" title="var">val</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Success</span> [<span class="id" title="var">val</span>].<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Failure</span> {<span class="id" title="var">val</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span> <span class="id" title="var">List</span> <span class="id" title="var">Orders</span> <span class="id" title="var">POrderedType</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Ident</span> &lt;: <span class="id" title="var">UsualOrderedType</span> := <span class="id" title="var">Positive_as_OT</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">minid</span> : <span class="id" title="var">Ident.t</span> := <span class="id" title="var">xH</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">id2pos</span>: <span class="id" title="var">Ident.t</span> → <span class="id" title="var">positive</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">minid_eq</span>: <span class="id" title="var">id2pos</span> <span class="id" title="var">minid</span> = 1%<span class="id" title="var">positive</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ilt_morphism</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">Ident.lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> → <span class="id" title="var">Plt</span> (<span class="id" title="var">id2pos</span> <span class="id" title="var">x</span>) (<span class="id" title="var">id2pos</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">another_var</span>: <span class="id" title="var">Ident.t</span> → <span class="id" title="var">Ident.t</span> := <span class="id" title="var">Psucc</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z2id</span> (<span class="id" title="var">z</span> : <span class="id" title="var">Z</span>) : <span class="id" title="var">Ident.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">z</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> ⇒ 1%<span class="id" title="var">positive</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> ⇒ <span class="id" title="var">Pplus</span> <span class="id" title="var">p</span> 1%<span class="id" title="var">positive</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">_</span> ⇒  1%<span class="id" title="var">positive</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">add_id</span> := <span class="id" title="var">Pplus</span>.<br/>

<br/>
</div>

<div class="doc">
datatypes.v: Datatypes used throughout the development 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">var</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Ident.t</span>.<br/>

<br/>
</div>

<div class="doc">
expr:
Program expressions 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">expr</span> := <span class="id" title="var">Nil</span> | <span class="id" title="var">Var</span> : <span class="id" title="var">var</span> → <span class="id" title="var">expr</span>.<br/>

<br/>
</div>

<div class="doc">
pn_atom:
Pure (heap-independent) atoms 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">pn_atom</span> := <span class="id" title="var">Equ</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">pn_atom</span> | <span class="id" title="var">Nequ</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">pn_atom</span>.<br/>

<br/>
</div>

<div class="doc">
space_atom:
Spatial atoms are either next pointers or acyclic list segments. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">space_atom</span> :=<br/>
| <span class="id" title="keyword">Next</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">space_atom</span><br/>
| <span class="id" title="var">Lseg</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">space_atom</span>.<br/>

<br/>
</div>

<div class="doc">
assertion:
An assertion is composed of a list of pure atoms <span class="inlinecode"><span class="id" title="var">pi</span></span>, and a list of spatial 
atoms <span class="inlinecode"><span class="id" title="var">sigma</span></span>.  <span class="inlinecode"><span class="id" title="var">sigma</span></span> is interpreted as the <i>spatial</i> conjunction of the 
atoms, whereas <span class="inlinecode"><span class="id" title="var">pi</span></span> asserts the conjunction of its pure atoms. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">assertion</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Assertion</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">pi</span> : <span class="id" title="var">list</span> <span class="id" title="var">pn_atom</span>) (<span class="id" title="var">sigma</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>), <span class="id" title="var">assertion</span>.<br/>

<br/>
</div>

<div class="doc">
entailment:
An entailment is just a pair of assertions. Entailments are interpreted as:
In all models (pairs of heaps <span class="inlinecode"><span class="id" title="var">h</span></span> and stacks <span class="inlinecode"><span class="id" title="var">s</span></span>), the interpretation of the 
assertion on the left implies the interpretation of the assertion on the right. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">entailment</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Entailment</span> : <span class="id" title="var">assertion</span> → <span class="id" title="var">assertion</span> → <span class="id" title="var">entailment</span>.<br/>

<br/>
</div>

<div class="doc">
Various substitution functions:
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_var</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">j</span>: <span class="id" title="var">var</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">then</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Var</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_expr</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">t'</span>: <span class="id" title="var">expr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t'</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">Nil</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Var</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">then</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">t'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_pn</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">pn_atom</span>) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Equ</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="var">Equ</span> (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t2</span>) <br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Nequ</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="var">Nequ</span> (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t2</span>) <br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_pns</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">pa</span>: <span class="id" title="var">list</span> <span class="id" title="var">pn_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">pn_atom</span> := <span class="id" title="var">map</span> (<span class="id" title="var">subst_pn</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span>) <span class="id" title="var">pa</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_space</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="keyword">Next</span> (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="var">Lseg</span> (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_spaces</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> → <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> := <span class="id" title="var">map</span> (<span class="id" title="var">subst_space</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_assertion</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">e</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">assertion</span>) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Assertion</span> <span class="id" title="var">pi</span> <span class="id" title="var">sigma</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Assertion</span> (<span class="id" title="var">subst_pns</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pi</span>) (<span class="id" title="var">subst_spaces</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">sigma</span>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Stdlib.Lists.List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Sorted</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Stdlib.Sorting.Mergesort</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Permutation</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">StrictCompSpec</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">eq</span> <span class="id" title="var">lt</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">StrictOrder</span> <span class="id" title="var">lt</span> ∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">CompSpec</span> <span class="id" title="var">eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">CompSpec'</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">StrictCompSpec</span> (@<span class="id" title="var">Logic.eq</span> <span class="id" title="var">A</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">Lt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">cmp</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">do_comp</span> <span class="id" title="var">cspec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> := <span class="id" title="tactic">destruct</span> (<span class="id" title="var">CompSpec2Type</span> (<span class="id" title="var">proj2</span> <span class="id" title="var">cspec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_comp</span>: <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">StrictCompSpec</span> <span class="id" title="var">Logic.eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>: <span class="id" title="var">A</span>,  (<span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ↔ <span class="id" title="var">Lt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span> [[?<span class="id" title="var">H</span> ?<span class="id" title="var">H</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">do_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">_</span> (<span class="id" title="var">H1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">H2</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_comp</span>: <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">StrictCompSpec</span> <span class="id" title="var">Logic.eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>: <span class="id" title="var">A</span>,   (<span class="id" title="var">x</span> = <span class="id" title="var">y</span> ↔ <span class="id" title="var">Eq</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span> [[?<span class="id" title="var">H</span> ?<span class="id" title="var">H</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">do_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_comp</span>: <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">StrictCompSpec</span> <span class="id" title="var">Logic.eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">cmp</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>: <span class="id" title="var">A</span>,   (<span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ↔ <span class="id" title="var">Gt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span> [[?<span class="id" title="var">H</span> ?<span class="id" title="var">H</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">do_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">eq_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">y</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">do_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">_</span> (<span class="id" title="var">H1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l0</span> <span class="id" title="var">H2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">_</span> (<span class="id" title="var">H1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">H2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lt_comp</span> <span class="id" title="var">H</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_refl</span>: <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">cspec</span>: <span class="id" title="var">CompSpec'</span> <span class="id" title="var">cmp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> = <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="var">do_comp</span> <span class="id" title="var">cspec</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cspec</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">H</span> <span class="id" title="var">_</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>).<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cspec</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">H</span> <span class="id" title="var">_</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_trans</span>:  <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">cspec</span>: <span class="id" title="var">CompSpec'</span> <span class="id" title="var">cmp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <span class="id" title="var">Lt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> → <span class="id" title="var">Lt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> → <span class="id" title="var">Lt</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cspec</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> ?<span class="id" title="var">H</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isGe</span> (<span class="id" title="var">c</span>: <span class="id" title="var">comparison</span>) := <span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">False</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">True</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isGeq</span> <span class="id" title="var">cc</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">cc</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">false</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">insert</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">A</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">A</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> :: <span class="id" title="var">t</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">isGeq</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">a</span> :: <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">h</span> :: (<span class="id" title="var">insert</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">a</span> :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">rsort</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span> | <span class="id" title="var">h</span>::<span class="id" title="var">t</span> ⇒ <span class="id" title="var">insert</span> <span class="id" title="var">cmp</span> <span class="id" title="var">h</span> (<span class="id" title="var">rsort</span> <span class="id" title="var">cmp</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">insert_uniq</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">A</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">A</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> :: <span class="id" title="var">t</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">h</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">l</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">a</span> :: <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">h</span> :: (<span class="id" title="var">insert_uniq</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">a</span>::<span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">rsort_uniq</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span> | <span class="id" title="var">h</span>::<span class="id" title="var">t</span> ⇒ <span class="id" title="var">insert_uniq</span> <span class="id" title="var">cmp</span> <span class="id" title="var">h</span> (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">cmp</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">perm_insert</span> {<span class="id" title="var">T</span>} <span class="id" title="var">cmp</span> (<span class="id" title="var">a</span> : <span class="id" title="var">T</span>) <span class="id" title="var">l</span> : <span class="id" title="var">Permutation</span> (<span class="id" title="var">insert</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>) (<span class="id" title="var">a</span> :: <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">isGeq</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">a0</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Permutation_refl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Permutation_sym</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Permutation_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l'</span> := <span class="id" title="var">a0</span> :: <span class="id" title="var">a</span> :: <span class="id" title="var">l</span>).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">perm_swap</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Permutation_sym</span>...<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compare_list</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">xl</span> <span class="id" title="var">yl</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xl</span> , <span class="id" title="var">yl</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> :: <span class="id" title="var">xl'</span>, <span class="id" title="var">y</span> :: <span class="id" title="var">yl'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">compare_list</span> <span class="id" title="var">f</span> <span class="id" title="var">xl'</span> <span class="id" title="var">yl'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> , <span class="id" title="var">_</span> :: <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">_</span> , <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span>, <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_sortu</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span>  {<span class="id" title="var">A</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) <span class="id" title="var">l</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> → <span class="id" title="var">Forall</span> <span class="id" title="var">f</span>  (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">cmp</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>;  <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">inversion</span>  <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">H3</span>).<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rsort_uniq_in</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">R</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">EQ</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, (<span class="id" title="var">a</span>=<span class="id" title="var">b</span>) ↔ (<span class="id" title="var">Eq</span> = <span class="id" title="var">R</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">rsort_uniq</span>  <span class="id" title="var">R</span> <span class="id" title="var">l</span>) ↔ <span class="id" title="var">List.In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="var">remember</span> (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">R</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l'</span>.<br/>
<span class="id" title="tactic">clear</span> - <span class="id" title="var">EQ</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">l'</span>; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="var">case_eq</span> (<span class="id" title="var">R</span> <span class="id" title="var">a</span> <span class="id" title="var">a0</span>); <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">EQ</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span> <span class="id" title="var">List</span> <span class="id" title="var">Recdef</span> <span class="id" title="var">Stdlib.MSets.MSetInterface</span> <span class="id" title="var">Stdlib.Sorting.Mergesort</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Permutation</span> <span class="id" title="var">Stdlib.MSets.MSetAVL</span> <span class="id" title="var">Stdlib.MSets.MSetRBT</span>.<br/>

<br/>
</div>

<div class="doc">
The clause datatype and related definitions and lemmas 
<div class="paragraph"> </div>

 pure_atom:
pure atoms 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">pure_atom</span> := <span class="id" title="var">Eqv</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">pure_atom</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Definition</span> <span class="id" title="var">var1</span> : <span class="id" title="var">var</span> := <span class="id" title="var">Z2id</span> 1.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Definition</span> <span class="id" title="var">var0</span> : <span class="id" title="var">var</span> := <span class="id" title="var">Z2id</span> 0.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Definition</span> <span class="id" title="var">var2</span> : <span class="id" title="var">var</span> := <span class="id" title="var">Z2id</span> 2.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">list_prio</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">weight</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">p</span>: <span class="id" title="var">var</span>) : <span class="id" title="var">var</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>::<span class="id" title="var">l'</span> ⇒ <span class="id" title="var">list_prio</span> <span class="id" title="var">weight</span> <span class="id" title="var">l'</span> (<span class="id" title="var">add_id</span> <span class="id" title="var">weight</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Weight the positive atoms 1 each, and the negative atoms 2 each.
    Then the highest-priority terms will be the positive unit clauses 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prio</span> (<span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span>: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) : <span class="id" title="var">var</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">list_prio</span> <span class="id" title="var">var2</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">list_prio</span> <span class="id" title="var">var1</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">var0</span>).<br/>

<br/>
</div>

<div class="doc">
clause:
clauses are either pure (no spatial atoms), negative spatial (spatial atom on the left) 
or positive spatial. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">clause</span> : <span class="id" title="keyword">Type</span> := <br/>
| <span class="id" title="var">PureClause</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">gamma</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) (<span class="id" title="keyword">delta</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">priority</span> : <span class="id" title="var">var</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prio_ok</span>: <span class="id" title="var">prio</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> = <span class="id" title="var">priority</span>), <span class="id" title="var">clause</span><br/>
| <span class="id" title="var">PosSpaceClause</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">gamma</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) (<span class="id" title="keyword">delta</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">sigma</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>), <span class="id" title="var">clause</span><br/>
| <span class="id" title="var">NegSpaceClause</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">gamma</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) (<span class="id" title="var">sigma</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">delta</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>), <span class="id" title="var">clause</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span>, <span class="id" title="var">e'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Nil</span> , <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Nil</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Var</span> <span class="id" title="var">v</span>, <span class="id" title="var">Var</span> <span class="id" title="var">v'</span> ⇒ <span class="id" title="var">Ident.compare</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">expr_cmp_rfl</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span>:<span class="id" title="var">expr</span>, <span class="id" title="var">expr_cmp</span> <span class="id" title="var">e</span> <span class="id" title="var">e</span> = <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">proj2</span> (<span class="id" title="var">Pos.compare_eq_iff</span> <span class="id" title="var">v</span> <span class="id" title="var">v</span>)). <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">var_cspec</span> : <span class="id" title="var">StrictCompSpec</span> (@<span class="id" title="var">Logic.eq</span> <span class="id" title="var">var</span>) <span class="id" title="var">Ident.lt</span> <span class="id" title="var">Ident.compare</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">Ident.lt_strorder</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">Ident.compare_spec</span>]. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">var_cspec</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">a</span> <span class="id" title="var">a'</span>: <span class="id" title="var">pure_atom</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span>, <span class="id" title="var">a'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Eqv</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">e1</span> <span class="id" title="var">e1'</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">expr_cmp</span> <span class="id" title="var">e2</span> <span class="id" title="var">e2'</span> | <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pure_atom_cmp_rfl</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>:<span class="id" title="var">pure_atom</span>, <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span> = <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">expr_cmp_rfl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">expr_cmp_rfl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_list_pure_atom_cmp_rfl</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="keyword">delta</span>, <span class="id" title="var">compare_list</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="keyword">delta</span> <span class="id" title="keyword">delta</span> = <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="keyword">delta</span>. <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pure_atom_cmp_rfl</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Rewrite</span> @<span class="id" title="var">comp_refl</span> <span class="id" title="keyword">using</span> <span class="id" title="tactic">solve</span>[<span class="id" title="tactic">auto</span>] : <span class="id" title="var">comp</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">comp_tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">progress</span> (<span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">comp</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>)<br/>
&nbsp;&nbsp;|| <span class="id" title="tactic">discriminate</span><br/>
&nbsp;&nbsp;|| <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">eapply</span> <span class="id" title="var">comp_trans</span>;  <span class="id" title="tactic">eauto</span>]<br/>
&nbsp;&nbsp;|| <span class="id" title="tactic">subst</span><br/>
&nbsp;|| <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">Lt</span> = ?<span class="id" title="var">A</span> |- <span class="id" title="keyword">context</span> [?<span class="id" title="var">A</span>] ⇒ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">Gt</span> = ?<span class="id" title="var">A</span> |- <span class="id" title="keyword">context</span> [?<span class="id" title="var">A</span>] ⇒ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">Eq</span> = ?<span class="id" title="var">A</span> |- <span class="id" title="keyword">context</span> [?<span class="id" title="var">A</span>] ⇒ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> <br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
ordering expressions, atoms and clauses 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">expr_order</span> (<span class="id" title="var">t</span> <span class="id" title="var">t'</span>: <span class="id" title="var">expr</span>) := <span class="id" title="var">isGe</span> (<span class="id" title="var">expr_cmp</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">max_expr</span> (<span class="id" title="var">t</span> : <span class="id" title="var">expr</span>) : <span class="id" title="var">pure_atom</span> → <span class="id" title="keyword">Prop</span> := <br/>
| <span class="id" title="var">mexpr_left</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t'</span>, <span class="id" title="var">expr_order</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> → <span class="id" title="var">max_expr</span> <span class="id" title="var">t</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span>)<br/>
| <span class="id" title="var">mexpr_right</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t'</span>, <span class="id" title="var">expr_order</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span> → <span class="id" title="var">max_expr</span> <span class="id" title="var">t</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t'</span> <span class="id" title="var">t</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">order_eqv_pure_atom</span> (<span class="id" title="var">a</span>: <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">Eqv</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Eqv</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">a</span> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">false</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> <span class="id" title="keyword">end</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">normalize_atoms</span> <span class="id" title="var">pa</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">map</span> <span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">pa</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mkPureClause</span> (<span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span>: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">_</span> (<span class="id" title="var">eq_refl</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">order_eqv_clause</span> (<span class="id" title="var">c</span>: <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">pa'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkPureClause</span> (<span class="id" title="var">normalize_atoms</span> (<span class="id" title="var">filter</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">pa</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">normalize_atoms</span> <span class="id" title="var">pa'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">pa'</span> <span class="id" title="var">sa'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> (<span class="id" title="var">normalize_atoms</span> (<span class="id" title="var">filter</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">pa</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">normalize_atoms</span> <span class="id" title="var">pa'</span>) <span class="id" title="var">sa'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">sa</span> <span class="id" title="var">pa'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> (<span class="id" title="var">normalize_atoms</span> (<span class="id" title="var">filter</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">pa</span>)) <span class="id" title="var">sa</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">normalize_atoms</span> <span class="id" title="var">pa'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mk_pureL</span> (<span class="id" title="var">a</span>: <span class="id" title="var">pn_atom</span>) : <span class="id" title="var">clause</span> := <br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">Equ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">mkPureClause</span> <span class="id" title="var">nil</span> (<span class="id" title="var">order_eqv_pure_atom</span>(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)::<span class="id" title="var">nil</span>)<br/>
&nbsp;| <span class="id" title="var">Nequ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">mkPureClause</span> (<span class="id" title="var">order_eqv_pure_atom</span>(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)::<span class="id" title="var">nil</span>) <span class="id" title="var">nil</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">mk_pureR</span> (<span class="id" title="var">al</span>: <span class="id" title="var">list</span> <span class="id" title="var">pn_atom</span>) : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">al</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;| <span class="id" title="var">nil</span> ⇒ (<span class="id" title="var">nil</span>,<span class="id" title="var">nil</span>)<br/>
&nbsp;| <span class="id" title="var">Equ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :: <span class="id" title="var">l'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">mk_pureR</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span>,<span class="id" title="var">n</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">order_eqv_pure_atom</span>(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)::<span class="id" title="var">p</span>, <span class="id" title="var">n</span>) <span class="id" title="keyword">end</span><br/>
&nbsp;| <span class="id" title="var">Nequ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :: <span class="id" title="var">l'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">mk_pureR</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span>,<span class="id" title="var">n</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>, <span class="id" title="var">order_eqv_pure_atom</span>(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)::<span class="id" title="var">n</span>) <span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
cnf:
clausal normal form 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cnf</span> (<span class="id" title="var">en</span>: <span class="id" title="var">entailment</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">en</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Entailment</span> (<span class="id" title="var">Assertion</span> <span class="id" title="var">pureL</span> <span class="id" title="var">spaceL</span>) (<span class="id" title="var">Assertion</span> <span class="id" title="var">pureR</span> <span class="id" title="var">spaceR</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mk_pureR</span> <span class="id" title="var">pureR</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span>,<span class="id" title="var">n</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">mk_pureL</span> <span class="id" title="var">pureL</span> ++ (<span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">spaceL</span> :: <span class="id" title="var">nil</span>) ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">spaceL</span>, <span class="id" title="var">spaceR</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span>, <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">mkPureClause</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span> :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">p</span> <span class="id" title="var">spaceR</span> <span class="id" title="var">n</span> :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
various comparison functions 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_atom_geq</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="var">isGeq</span> (<span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_atom_gt</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_atom_eq</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">expr_lt</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">expr_geq</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">false</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">a</span> : <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">expr_lt</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_pure</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">a</span>: <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="var">Eqv</span> (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">subst_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span> <span class="id" title="var">t2</span>) <br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_pures</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">t</span>: <span class="id" title="var">expr</span>) (<span class="id" title="var">pa</span>: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> := <span class="id" title="var">map</span> (<span class="id" title="var">subst_pure</span> <span class="id" title="var">i</span> <span class="id" title="var">t</span>) <span class="id" title="var">pa</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_space_atom</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">space_atom</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> , <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> , <span class="id" title="keyword">Next</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">i'</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">expr_cmp</span> <span class="id" title="var">j</span> <span class="id" title="var">j'</span> | <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>, <span class="id" title="var">Lseg</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">i'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>, <span class="id" title="keyword">Next</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">i'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> , <span class="id" title="var">Lseg</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">i</span> <span class="id" title="var">i'</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">expr_cmp</span> <span class="id" title="var">j</span> <span class="id" title="var">j'</span> | <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_clause</span> (<span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl1</span> , <span class="id" title="var">cl2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">pos</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , @<span class="id" title="var">PureClause</span> <span class="id" title="var">neg'</span> <span class="id" title="var">pos'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">compare_list</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">neg</span> <span class="id" title="var">neg'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">compare_list</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">pos</span> <span class="id" title="var">pos'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , @<span class="id" title="var">PureClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma</span> , <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">delta'</span> <span class="id" title="var">sigma'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="var">sigma</span> <span class="id" title="keyword">delta</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma'</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">compare_list</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">gamma</span> <span class="id" title="var">gamma'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">compare_list</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">delta'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">compare_list</span> <span class="id" title="var">compare_space_atom</span> <span class="id" title="var">sigma</span> <span class="id" title="var">sigma'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> , <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rev_cmp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">Eq</span> | <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">Gt</span> | <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">Lt</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rev_cmp_eq</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x0</span> <span class="id" title="var">y0</span> : <span class="id" title="var">A</span>, <span class="id" title="var">Eq</span> = <span class="id" title="var">cmp</span> <span class="id" title="var">x0</span> <span class="id" title="var">y0</span> → <span class="id" title="var">x0</span> = <span class="id" title="var">y0</span>) → <br/>
&nbsp;&nbsp;<span class="id" title="var">Eq</span> = <span class="id" title="var">rev_cmp</span> <span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> → <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">rev_cmp</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">remember</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span>[<span class="id" title="tactic">congruence</span>].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prio1000</span> := <span class="id" title="var">Z2id</span> 1000.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prio1001</span> := <span class="id" title="var">Z2id</span> 1001.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">clause_prio</span> (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">var</span> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">prio</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">prio</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">prio1000</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="var">sigma</span> <span class="id" title="keyword">delta</span> ⇒ <span class="id" title="var">prio1001</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>%<span class="id" title="var">Z</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_clause'</span> (<span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Ident.compare</span> (<span class="id" title="var">clause_prio</span> <span class="id" title="var">cl1</span>) (<span class="id" title="var">clause_prio</span> <span class="id" title="var">cl2</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">compare_clause</span> <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">falsity</span> : <span class="id" title="var">False</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">clause_cspec'</span>: <span class="id" title="var">CompSpec'</span> <span class="id" title="var">compare_clause'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">destruct</span> <span class="id" title="var">falsity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">clause_cspec'</span> : <span class="id" title="var">core</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">clause_length</span> (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">Z</span> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Zlength</span> <span class="id" title="var">gamma</span> + <span class="id" title="var">Zlength</span> <span class="id" title="keyword">delta</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Zlength</span> <span class="id" title="var">gamma</span> + <span class="id" title="var">Zlength</span> <span class="id" title="keyword">delta</span> + <span class="id" title="var">Zlength</span> <span class="id" title="var">sigma</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="var">sigma</span> <span class="id" title="keyword">delta</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Zlength</span> <span class="id" title="var">gamma</span> + <span class="id" title="var">Zlength</span> <span class="id" title="var">sigma</span> + <span class="id" title="var">Zlength</span> <span class="id" title="keyword">delta</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>%<span class="id" title="var">Z</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_clause_length</span> (<span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> : <span class="id" title="var">clause</span>) := <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Z.compare</span> (<span class="id" title="var">clause_length</span> <span class="id" title="var">cl1</span>) (<span class="id" title="var">clause_length</span> <span class="id" title="var">cl2</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_clause'1</span> (<span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">compare_clause_length</span> <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">compare_clause</span> <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">c</span> ⇒ <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">OrderedClause</span> &lt;: <span class="id" title="var">OrderedType</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span>:=<span class="id" title="var">clause</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">compare</span>:=<span class="id" title="var">compare_clause'</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span> := <span class="id" title="var">clause</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq</span> : <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span> → <span class="id" title="keyword">Prop</span> := <span class="id" title="var">Logic.eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_equiv</span> : <span class="id" title="var">Equivalence</span> <span class="id" title="var">eq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_equivalence</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt</span> (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <span class="id" title="var">clause</span>) := <span class="id" title="var">Lt</span> = <span class="id" title="var">compare_clause'</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_compat</span> : <span class="id" title="var">Proper</span> (<span class="id" title="var">eq</span> ==&gt; <span class="id" title="var">eq</span> ==&gt; <span class="id" title="var">iff</span>) <span class="id" title="var">lt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>,<span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare</span> := <span class="id" title="var">compare_clause'</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_spec</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">CompSpec</span> <span class="id" title="var">eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> (<span class="id" title="var">compare</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">clause_cspec'</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_dec</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, {<span class="id" title="var">eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>}+{~<span class="id" title="var">eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">eq</span>.<br/>
<span class="id" title="var">remember</span> (<span class="id" title="var">compare</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">j</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">CompSpec2Type</span> (<span class="id" title="var">compare_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>. <span class="id" title="tactic">left</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">right</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">compare</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqj</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">comp_refl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqj</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heqj</span>.<br/>
<span class="id" title="var">do_comp</span> <span class="id" title="var">clause_cspec'</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">right</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">comp_refl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="tactic">right</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">comp_refl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_strorder</span> : <span class="id" title="var">StrictOrder</span> <span class="id" title="var">lt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">clause_cspec'</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">OrderedClause</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">M1</span> : <span class="id" title="var">MSetInterface_S_Ext</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">E.t</span> := <span class="id" title="var">OrderedClause.t</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">E.compare</span> := <span class="id" title="var">OrderedClause.compare</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">E.eq</span> := <span class="id" title="var">OrderedClause.eq</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">E.lt</span> := <span class="id" title="var">OrderedClause.lt</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">E.compare</span> := <span class="id" title="var">OrderedClause.compare</span>.<br/>
&nbsp;<span class="id" title="keyword">Include</span> <span class="id" title="var">MSetAVL.Make</span>(<span class="id" title="var">OrderedClause</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove_min</span> (<span class="id" title="var">s</span>: <span class="id" title="var">t</span>) : <span class="id" title="var">option</span> (<span class="id" title="var">elt</span> × <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">min_elt</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">Some</span> (<span class="id" title="var">x</span>, <span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_spec1x</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">s</span>: <span class="id" title="var">t</span>) <span class="id" title="var">k</span> <span class="id" title="var">s'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remove_min</span> <span class="id" title="var">s</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">k</span>,<span class="id" title="var">s'</span>)  ↔<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">min_elt</span> <span class="id" title="var">s</span> = <span class="id" title="var">Some</span> <span class="id" title="var">k</span> ∧ <span class="id" title="var">remove</span> <span class="id" title="var">k</span> <span class="id" title="var">s</span> = <span class="id" title="var">s'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">remove_min</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">min_elt</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_spec1</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">s</span>: <span class="id" title="var">t</span>) <span class="id" title="var">k</span> <span class="id" title="var">s'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remove_min</span> <span class="id" title="var">s</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">k</span>,<span class="id" title="var">s'</span>)  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">min_elt</span> <span class="id" title="var">s</span> = <span class="id" title="var">Some</span> <span class="id" title="var">k</span> ∧ <span class="id" title="var">Equal</span> (<span class="id" title="var">remove</span> <span class="id" title="var">k</span> <span class="id" title="var">s</span>) <span class="id" title="var">s'</span>).<br/>
&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">remove_min_spec1x</span> <span class="id" title="var">s</span> <span class="id" title="var">k</span> <span class="id" title="var">s'</span>) <span class="id" title="keyword">as</span> [? <span class="id" title="var">_</span>].<br/>
&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">H0</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_spec2x</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>, <span class="id" title="var">remove_min</span> <span class="id" title="var">s</span> = <span class="id" title="var">None</span> ↔ <span class="id" title="var">Empty</span> <span class="id" title="var">s</span>.<br/>
&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">remove_min</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">min_elt</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">min_elt_spec1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">min_elt_spec3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_spec2</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>, <span class="id" title="var">remove_min</span> <span class="id" title="var">s</span> = <span class="id" title="var">None</span> → <span class="id" title="var">Empty</span> <span class="id" title="var">s</span>.<br/>
&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">remove_min_spec2x</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mem_add</span> (<span class="id" title="var">x</span>: <span class="id" title="var">elt</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">t</span>) : <span class="id" title="var">option</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">None</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Some</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_add_spec</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>, <span class="id" title="var">mem_add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> = <span class="id" title="keyword">if</span> <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">None</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Some</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">M1</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">M</span> := <span class="id" title="var">MSetRBT.Make</span>(<span class="id" title="var">OrderedClause</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">clause_list2set</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) : <span class="id" title="var">M.t</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s0</span> <span class="id" title="var">c</span> ⇒ <span class="id" title="var">M.add</span> <span class="id" title="var">c</span> <span class="id" title="var">s0</span>) <span class="id" title="var">l</span> <span class="id" title="var">M.empty</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">empty_clause</span> : <span class="id" title="var">clause</span> := <span class="id" title="var">mkPureClause</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove_trivial_atoms</span> := <span class="id" title="var">filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_pures_delete</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">e</span>: <span class="id" title="var">expr</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> → <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">remove_trivial_atoms</span> <span class="id" title="var">oo</span> <span class="id" title="var">subst_pures</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isEq</span> <span class="id" title="var">cc</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">cc</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_space_atom</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">space_atom</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">isEq</span> (<span class="id" title="var">compare_space_atom</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_space_atomlist</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">isEq</span> (<span class="id" title="var">compare_list</span> <span class="id" title="var">compare_space_atom</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_var</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">bool</span> := <span class="id" title="var">isEq</span> (<span class="id" title="var">Ident.compare</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_reflex_lseg</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> → <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">sa</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sa</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Var</span> <span class="id" title="var">y</span>) ⇒ <span class="id" title="var">negb</span> (<span class="id" title="var">eq_var</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">Nil</span> <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">order_eqv_pure_atoms</span> := <span class="id" title="var">map</span> <span class="id" title="var">order_eqv_pure_atom</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">greater_than_expr</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">e</span>: <span class="id" title="var">expr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Var</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">Ident.compare</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">greatereq_than_expr</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) (<span class="id" title="var">e</span>: <span class="id" title="var">expr</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">Var</span> <span class="id" title="var">j</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">Ident.compare</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">Lt</span> ⇒ <span class="id" title="var">false</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Nil</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">greater_than_atom</span> (<span class="id" title="var">s</span> <span class="id" title="var">u</span> : <span class="id" title="var">pure_atom</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> , <span class="id" title="var">u</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> , <span class="id" title="var">Eqv</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">expr_lt</span> <span class="id" title="var">u</span> <span class="id" title="var">s</span> &amp;&amp; (<span class="id" title="var">expr_geq</span> <span class="id" title="var">s</span> <span class="id" title="var">v</span> || <span class="id" title="var">expr_geq</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">expr_lt</span> <span class="id" title="var">v</span> <span class="id" title="var">s</span> &amp;&amp; (<span class="id" title="var">expr_geq</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span> || <span class="id" title="var">expr_geq</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>))) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">expr_lt</span> <span class="id" title="var">u</span> <span class="id" title="var">t</span> &amp;&amp; (<span class="id" title="var">expr_geq</span> <span class="id" title="var">s</span> <span class="id" title="var">v</span> || <span class="id" title="var">expr_geq</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">expr_lt</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> &amp;&amp; (<span class="id" title="var">expr_geq</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span> || <span class="id" title="var">expr_geq</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">greater_than_atoms</span> (<span class="id" title="var">s</span> : <span class="id" title="var">pure_atom</span>) (<span class="id" title="keyword">delta</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">forallb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> ⇒ <span class="id" title="var">greater_than_atom</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span>) <span class="id" title="keyword">delta</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">greater_than_all</span> (<span class="id" title="var">i</span>: <span class="id" title="var">var</span>) : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> → <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">forallb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andb</span> (<span class="id" title="var">greater_than_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>) (<span class="id" title="var">greater_than_expr</span> <span class="id" title="var">i</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">end</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subst_clause</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">cl</span> : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">pa'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkPureClause</span> (<span class="id" title="var">subst_pures_delete</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa</span>) (<span class="id" title="var">subst_pures</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">sa</span> <span class="id" title="var">pa'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> (<span class="id" title="var">subst_pures_delete</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa</span>) (<span class="id" title="var">subst_spaces</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">sa</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">subst_pures</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">pa</span> <span class="id" title="var">pa'</span> <span class="id" title="var">sa'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> (<span class="id" title="var">subst_pures_delete</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa</span>) (<span class="id" title="var">subst_pures</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">pa'</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">subst_spaces</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span> <span class="id" title="var">sa'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ocons</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">o</span> : <span class="id" title="var">option</span> <span class="id" title="var">A</span>) <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">o</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">a</span> :: <span class="id" title="var">l</span> | <span class="id" title="var">None</span> ⇒ <span class="id" title="var">l</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">omapl</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">option</span> <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">l'</span> ⇒ <span class="id" title="var">ocons</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) (<span class="id" title="var">omapl</span> <span class="id" title="var">f</span> <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">merge</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">cmp</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">fix</span> <span class="id" title="var">merge_aux</span> <span class="id" title="var">l2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [], <span class="id" title="var">_</span> ⇒ <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, [] ⇒ <span class="id" title="var">l1</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a1</span>::<span class="id" title="var">l1'</span>, <span class="id" title="var">a2</span>::<span class="id" title="var">l2'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cmp</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> ⇒ <span class="id" title="var">a1</span> :: <span class="id" title="var">merge</span> <span class="id" title="var">cmp</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> ⇒ <span class="id" title="var">a1</span> :: <span class="id" title="var">merge</span> <span class="id" title="var">cmp</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">a2</span> :: <span class="id" title="var">merge_aux</span> <span class="id" title="var">l2'</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">merge_aux</span> <span class="id" title="var">l2</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">sortu_atms</span> := (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span>).<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">insu_atm</span> := (<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span>).<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">sortu_clauses</span> := (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">compare_clause</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pure_clause_ext</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">p</span> <span class="id" title="var">Pp</span> <span class="id" title="var">p'</span> <span class="id" title="var">Pp'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">p</span> <span class="id" title="var">Pp</span> = @<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">p'</span> <span class="id" title="var">Pp'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_spec'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>, <span class="id" title="var">M.mem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> = <span class="id" title="var">false</span> ↔ ¬<span class="id" title="var">M.In</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">M.mem_spec</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">M.mem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_empty_spec'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>, <span class="id" title="var">M.is_empty</span> <span class="id" title="var">s</span> = <span class="id" title="var">false</span> ↔ ¬<span class="id" title="var">M.Empty</span> <span class="id" title="var">s</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">M.is_empty_spec</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">M.is_empty</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_set_elems'</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>, <span class="id" title="var">M.Empty</span> <span class="id" title="var">s</span> ↔ <span class="id" title="var">M.elements</span> <span class="id" title="var">s</span> = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">generalize</span> (<span class="id" title="var">M.elements_spec1</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="tactic">intros</span> ? ?.<br/>
<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="var">contradiction</span> (<span class="id" title="var">H0</span> <span class="id" title="var">e</span>).<br/>
<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>. <span class="id" title="tactic">left</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Melements_spec1</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) <span class="id" title="var">x</span>, <span class="id" title="var">List.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>) ↔ <span class="id" title="var">M.In</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">M.elements_spec1</span>.<br/>
<span class="id" title="tactic">induction</span> (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intuition</span>; <br/>
<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>].<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">constructor</span> 2; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Finite_sets_facts</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
This file collects some axioms used throughout the Mechanized Semantic Library development.
  This file was developed in 2010 by Andrew W. Appel and Xavier Leroy, and harmonizes
  the axioms used by MSL and by the CompCert project.
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">Stdlib.Logic.ClassicalFacts</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab3"></a><h1 class="section">Extensionality axioms</h1>

<div class="paragraph"> </div>

 The following <span class="inlinecode"><span class="id" title="keyword">Require</span></span> <span class="inlinecode"><span class="id" title="keyword">Export</span></span> gives us functional extensionality for dependent function types:
<pre>
Axiom functional_extensionality_dep : forall {A} {B : A -&gt; Type}, 
  forall (f g : forall x : A, B x), 
  (forall x, f x = g x) -&gt; f = g.
</pre>
and, as a corollary, functional extensionality for non-dependent functions:
<pre>
Lemma functional_extensionality {A B} (f g : A -&gt; B) : 
  (forall x, f x = g x) -&gt; f = g.
</pre>

</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Stdlib.Logic.FunctionalExtensionality</span>.<br/>

<br/>
</div>

<div class="doc">
For compatibility with earlier developments, <span class="inlinecode"><span class="id" title="tactic">extensionality</span></span>
  is an alias for <span class="inlinecode"><span class="id" title="var">functional_extensionality</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="tactic">extensionality</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>),  (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">g</span> <span class="id" title="var">x</span>) → <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">functional_extensionality</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="tactic">extensionality</span>.<br/>

<br/>
</div>

<div class="doc">
We also assert propositional extensionality. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">prop_ext</span>: <span class="id" title="var">ClassicalFacts.prop_extensionality</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">prop_ext</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab4"></a><h1 class="section">Proof irrelevance</h1>

<div class="paragraph"> </div>

 We also use proof irrelevance, which is a consequence of propositional
    extensionality. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">proof_irr</span>: <span class="id" title="var">ClassicalFacts.proof_irrelevance</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ClassicalFacts.ext_prop_dep_proof_irrel_cic</span> <span class="id" title="var">prop_ext</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">proof_irr</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mcardinal_spec'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>,   <span class="id" title="var">cardinal</span> <span class="id" title="var">_</span> (<span class="id" title="var">Basics.flip</span> <span class="id" title="var">M.In</span> <span class="id" title="var">s</span>) (<span class="id" title="var">M.cardinal</span> <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">M.cardinal_spec</span> <span class="id" title="var">s</span>).<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">M.elements_spec1</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">Basics.flip</span> <span class="id" title="var">M.In</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">Basics.flip</span> (@<span class="id" title="var">List.In</span> <span class="id" title="var">_</span>) (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>)).<br/>
<span class="id" title="var">Focus</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Basics.flip</span>; <span class="id" title="tactic">apply</span> <span class="id" title="tactic">extensionality</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>;<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">prop_ext</span>; <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">H</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">clear</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">SetoidList.In_InA</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_equivalence</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">SetoidList.InA_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [? [? ?]].<br/>
<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">M.elements_spec2w</span> <span class="id" title="var">s</span>); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">s</span> <span class="id" title="var">Heql</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">Basics.flip</span> (@<span class="id" title="var">List.In</span> <span class="id" title="var">M.elt</span>) (@<span class="id" title="var">nil</span> <span class="id" title="var">clause</span>)) <span class="id" title="keyword">with</span> (@<span class="id" title="var">Empty_set</span> <span class="id" title="var">M.elt</span>).<br/>
&nbsp;<span class="id" title="tactic">constructor</span> 1.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">extensionality</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">prop_ext</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">Basics.flip</span> (@<span class="id" title="var">List.In</span> <span class="id" title="var">M.elt</span>) (@<span class="id" title="var">cons</span> <span class="id" title="var">clause</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>)) <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="keyword">Add</span> <span class="id" title="var">M.elt</span> (<span class="id" title="var">Basics.flip</span> (@<span class="id" title="var">List.In</span> <span class="id" title="var">_</span>) <span class="id" title="var">l</span>) <span class="id" title="var">x</span>).<br/>
&nbsp;<span class="id" title="tactic">constructor</span> 2; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="var">contradict</span> <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">SetoidList.In_InA</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_equivalence</span>.<br/>
&nbsp;<span class="id" title="tactic">clear</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">extensionality</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">prop_ext</span>; <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Basics.flip</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="keyword">Add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Singleton_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; [<span class="id" title="tactic">right</span> | <span class="id" title="tactic">left</span>].<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Singleton_intro</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_decreases</span>: <br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">giv</span> <span class="id" title="var">unselected</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">M.In</span> <span class="id" title="var">giv</span> <span class="id" title="var">unselected</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">M.cardinal</span>  (<span class="id" title="var">M.remove</span> <span class="id" title="var">giv</span> <span class="id" title="var">unselected</span>)  &lt; <span class="id" title="var">M.cardinal</span>  <span class="id" title="var">unselected</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">Mcardinal_spec'</span> (<span class="id" title="var">M.remove</span> <span class="id" title="var">giv</span> <span class="id" title="var">unselected</span>)); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">Mcardinal_spec'</span> <span class="id" title="var">unselected</span>); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">card_soustr_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">cardinal_is_functional</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H2</span>).<br/>
&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">M.cardinal</span> <span class="id" title="var">unselected</span> &gt; 0).<br/>
&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">Mcardinal_spec'</span> <span class="id" title="var">unselected</span>); <span class="id" title="tactic">intro</span>.<br/>
&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Empty_set</span> <span class="id" title="var">M.elt</span> <span class="id" title="var">giv</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Basics.flip</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;<span class="id" title="tactic">clear</span> - <span class="id" title="var">H</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">extensionality</span>;  <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Basics.flip</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">prop_ext</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">M.remove_spec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">In</span>, <span class="id" title="var">Basics.flip</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Singleton_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="var">contradiction</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">M.remove_spec</span>.<br/>
<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Singleton_intro</span>.<br/>
<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
a second comparison function on clauses that meets the requirements 
   of model generation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_atom2pn_atom</span> (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Equ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Nequ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pn_atom_cmp</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">pn_atom</span>) : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a1</span>, <span class="id" title="var">a2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Equ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Equ</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> ⇒ <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Nequ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Equ</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">e1</span> <span class="id" title="var">e1'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Gt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Equ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Nequ</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">e1</span> <span class="id" title="var">e1'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Lt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Nequ</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Nequ</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> ⇒ <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">Eqv</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_clause2pn_list</span> (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rsort</span> <span class="id" title="var">pn_atom_cmp</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">pure_atom2pn_atom</span> <span class="id" title="var">false</span>) <span class="id" title="var">gamma</span> ++ <span class="id" title="var">map</span> (<span class="id" title="var">pure_atom2pn_atom</span> <span class="id" title="var">true</span>) <span class="id" title="keyword">delta</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_clause2</span> (<span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> : <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl1</span>, <span class="id" title="var">cl2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, @<span class="id" title="var">PureClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compare_list</span> <span class="id" title="var">pn_atom_cmp</span> (<span class="id" title="var">pure_clause2pn_list</span> <span class="id" title="var">cl1</span>) (<span class="id" title="var">pure_clause2pn_list</span> <span class="id" title="var">cl2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">compare_clause</span> <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ce_type</span> := <span class="id" title="var">CexpL</span> | <span class="id" title="var">CexpR</span> | <span class="id" title="var">CexpEf</span>.<br/>

<br/>
</div>

<div class="doc">
Patch until Rocq extraction of sharing constraints is fixed 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">DebuggingHooks</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_new_pures_set</span> (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) := <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_wf_set</span> (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) := <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_unfold_set</span> (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) := <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_inferred_list</span> (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) := <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_pures_list</span> (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) := <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_eqs_list</span> (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) := <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_spatial_model</span> (<span class="id" title="var">c</span>: <span class="id" title="var">clause</span>) (<span class="id" title="var">R</span>: <span class="id" title="var">list</span> (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span>)) := <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_spatial_model2</span> (<span class="id" title="var">c</span> <span class="id" title="var">c'</span>: <span class="id" title="var">clause</span>) (<span class="id" title="var">R</span>: <span class="id" title="var">list</span> (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span>)) := <span class="id" title="var">c'</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">print_ce_clause</span> (<span class="id" title="var">R</span>: <span class="id" title="var">list</span> (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span>)) (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) (<span class="id" title="var">ct</span> : <span class="id" title="var">ce_type</span>) <br/>
&nbsp;&nbsp;:= (<span class="id" title="var">R</span>, <span class="id" title="var">cl</span>, <span class="id" title="var">ct</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">DebuggingHooks</span>.<br/>

<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">DebuggingHooks</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Unfold</span> <span class="id" title="var">print_new_pures_set</span> <span class="id" title="var">print_wf_set</span> <span class="id" title="var">print_inferred_list</span> <span class="id" title="var">print_spatial_model</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">print_pures_list</span> <span class="id" title="var">print_eqs_list</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">DEBUG_UNFOLD</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
A little module for doing naive congruence closure; we don't need anything 
    much fancier because in practice, for spatial entailments, we only discover 
    a few new equalities in each call to the superposition subsystem.

<div class="paragraph"> </div>

    Pure entailments are another matter entirely, but for now we seem to be fine 
    on those (see, eg, test/test.pure.entailments.sf) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">cclosure</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>).<br/>
<span class="id" title="keyword">Variables</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">A_cmp</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">comparison</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">B_cmp</span> : <span class="id" title="var">B</span> → <span class="id" title="var">B</span> → <span class="id" title="var">comparison</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">fAB</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">canons</span> := (<span class="id" title="var">list</span> (<span class="id" title="var">A</span>×<span class="id" title="var">B</span>)).<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lookC</span> (<span class="id" title="var">a</span>: <span class="id" title="var">A</span>) (<span class="id" title="var">cs</span>: <span class="id" title="var">canons</span>) : <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cs</span> <span class="id" title="keyword">with</span> <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">fAB</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">a1</span>, <span class="id" title="var">b1</span>)::<span class="id" title="var">cs'</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">A_cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">a1</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">b1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">lookC</span> <span class="id" title="var">a</span> <span class="id" title="var">cs'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">rewriteC</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">B</span>) (<span class="id" title="var">cs</span>: <span class="id" title="var">canons</span>) : <span class="id" title="var">canons</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cs</span> <span class="id" title="keyword">with</span> <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">a1</span>, <span class="id" title="var">b1'</span>)::<span class="id" title="var">cs'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_cs</span> := <span class="id" title="var">rewriteC</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">cs'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">B_cmp</span> <span class="id" title="var">b1</span> <span class="id" title="var">b1'</span>) <span class="id" title="keyword">then</span> (<span class="id" title="var">a1</span>, <span class="id" title="var">b2</span>)::<span class="id" title="var">new_cs</span> <span class="id" title="keyword">else</span> (<span class="id" title="var">a1</span>, <span class="id" title="var">b1'</span>)::<span class="id" title="var">new_cs</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mergeC</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">cs</span>: <span class="id" title="var">canons</span>) : <span class="id" title="var">canons</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lookC</span> <span class="id" title="var">a1</span> <span class="id" title="var">cs</span>, <span class="id" title="var">lookC</span> <span class="id" title="var">a2</span> <span class="id" title="var">cs</span> <span class="id" title="keyword">with</span> <span class="id" title="var">b1</span>, <span class="id" title="var">b2</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">B_cmp</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">cs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">a1</span>, <span class="id" title="var">b2</span>)::(<span class="id" title="var">a2</span>, <span class="id" title="var">b2</span>)::<span class="id" title="var">rewriteC</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">cs</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">cclosure</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">expr_get</span> := (<span class="id" title="var">lookC</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">expr_cmp</span> (@<span class="id" title="var">id</span> <span class="id" title="var">_</span>)).<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">expr_merge</span> := (@<span class="id" title="var">mergeC</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">expr_cmp</span> <span class="id" title="var">expr_cmp</span> (@<span class="id" title="var">id</span> <span class="id" title="var">_</span>)).<br/>

<br/>
<span class="id" title="keyword">Local Notation</span> <span class="id" title="var">expr_rewriteC</span> := (<span class="id" title="var">rewriteC</span> <span class="id" title="var">expr</span> <span class="id" title="var">_</span> <span class="id" title="var">expr_cmp</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">cclose_aux</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">expr</span> × <span class="id" title="var">expr</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| @<span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span> :: <span class="id" title="var">l'</span> ⇒ @<span class="id" title="var">expr_merge</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> (<span class="id" title="var">cclose_aux</span> <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cclose</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">e1</span>, <span class="id" title="var">e2</span>) ⇒ <span class="id" title="var">mkPureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>] <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cclose_aux</span> <span class="id" title="var">l</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">SUPERPOSITION</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">model</span> := <span class="id" title="var">list</span> (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">superposition_result</span> : <span class="id" title="keyword">Type</span> := <br/>
| <span class="id" title="var">Valid</span> : <span class="id" title="var">superposition_result</span><br/>
| <span class="id" title="var">C_example</span> : <span class="id" title="var">model</span> → <span class="id" title="var">M.t</span> → <span class="id" title="var">superposition_result</span><br/>
| <span class="id" title="var">Aborted</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">superposition_result</span>.<br/>

<br/>
</div>

<div class="doc">
check:
<ul class="doclist">
<li>Check a pure entailment of the form <span class="inlinecode"><span class="id" title="var">Pi</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">Pi'</span></span>

</li>
<li>Returns, when a <span class="inlinecode"><span class="id" title="var">C_example</span></span> is found, the model exhibiting the <span class="inlinecode"><span class="id" title="var">C_example</span></span> and 
 the final clause set (i.e., the set of clauses derived during proof search)

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">check</span> : <span class="id" title="var">entailment</span> → <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span>×<span class="id" title="var">M.t</span>.<br/>

<br/>
</div>

<div class="doc">
check_clauseset:
Just like check, except we operate instead on an initial <i>set</i> of clauses. 
This function is the one called by the main theorem prover, veristar.v. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">check_clauseset</span> : <span class="id" title="var">M.t</span> → <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span>×<span class="id" title="var">M.t</span>.<br/>

<br/>
</div>

<div class="doc">
is_model_of_PI:
Check whether R is a model of Pi+ /\ Pi-; used in the Veristar main loop 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">is_model_of_PI</span> : <span class="id" title="var">model</span> → <span class="id" title="var">clause</span> → <span class="id" title="var">bool</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">rewrite_by</span> : <span class="id" title="var">expr</span> → <span class="id" title="var">expr</span> → <span class="id" title="var">pure_atom</span> → <span class="id" title="var">pure_atom</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">demodulate</span> : <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">simplify</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">simplify_atoms</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> → <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">SUPERPOSITION</span>.<br/>

<br/>
</div>

<div class="doc">
Module Superposition:
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Superposition</span> &lt;: <span class="id" title="var">SUPERPOSITION</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">model</span> := <span class="id" title="var">list</span> (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">superposition_result</span> : <span class="id" title="keyword">Type</span> := <br/>
| <span class="id" title="var">Valid</span> : <span class="id" title="var">superposition_result</span><br/>
| <span class="id" title="var">C_example</span> : <span class="id" title="var">model</span> → <span class="id" title="var">M.t</span> → <span class="id" title="var">superposition_result</span><br/>
| <span class="id" title="var">Aborted</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">superposition_result</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
ef:
Equality factoring 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ef_aux</span> <span class="id" title="var">neg</span> <span class="id" title="var">u0</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">pos0</span> <span class="id" title="var">pos</span> <span class="id" title="var">l0</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">pos</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> <span class="id" title="var">a2</span>) :: <span class="id" title="var">pos'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span> &amp;&amp; <span class="id" title="var">greater_than_all</span> <span class="id" title="var">u0</span> <span class="id" title="var">neg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">mkPureClause</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insu_atm</span> (<span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>)) <span class="id" title="var">neg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insu_atm</span> (<span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">u</span> <span class="id" title="var">t</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merge</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">List.rev</span> <span class="id" title="var">pos0</span>) <span class="id" title="var">pos</span>)) ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ef_aux</span> <span class="id" title="var">neg</span> <span class="id" title="var">u0</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> (<span class="id" title="var">insu_atm</span> <span class="id" title="var">a2</span> <span class="id" title="var">pos0</span>) <span class="id" title="var">pos'</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ef</span> (<span class="id" title="var">cty</span> : <span class="id" title="var">ce_type</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) <span class="id" title="var">l0</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cty</span>, <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">CexpEf</span>, @<span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">u0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>) <span class="id" title="var">v</span> :: <span class="id" title="var">pos</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">greater_than_all</span> <span class="id" title="var">u0</span> <span class="id" title="var">neg</span> <span class="id" title="keyword">then</span> <span class="id" title="var">ef_aux</span> <span class="id" title="var">neg</span> <span class="id" title="var">u0</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">nil</span> <span class="id" title="var">pos</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
sp:
left and right superposition 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">PureClause</span> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sp</span> (<span class="id" title="var">cty</span> : <span class="id" title="var">ce_type</span>) (<span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">clause</span>) <span class="id" title="var">l0</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cty</span>, <span class="id" title="var">c</span>, <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id" title="var">CexpL</span>, <span class="id" title="var">PureClause</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">s'</span> <span class="id" title="var">v</span> :: <span class="id" title="var">neg'</span>) <span class="id" title="var">pos'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">s0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">s</span>) <span class="id" title="var">t</span> :: <span class="id" title="var">pos</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> &amp;&amp; <span class="id" title="var">expr_lt</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span> &amp;&amp; <span class="id" title="var">expr_lt</span> <span class="id" title="var">v</span> <span class="id" title="var">s'</span> &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pure_atom_gt1</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">pos</span> &amp;&amp; <span class="id" title="var">greater_than_all</span> <span class="id" title="var">s0</span> <span class="id" title="var">neg</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">mkPureClause</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insu_atm</span> (<span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)) (<span class="id" title="var">merge</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">neg</span> <span class="id" title="var">neg'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merge</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">pos</span> <span class="id" title="var">pos'</span>) :: <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id" title="var">CexpR</span>, <span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">s0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">s</span>) <span class="id" title="var">t</span> :: <span class="id" title="var">pos</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PureClause</span> <span class="id" title="var">neg'</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">s'0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">s'</span>) <span class="id" title="var">v</span> :: <span class="id" title="var">pos'</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> &amp;&amp; <span class="id" title="var">expr_lt</span> <span class="id" title="var">t</span> <span class="id" title="var">s</span> &amp;&amp; <span class="id" title="var">expr_lt</span> <span class="id" title="var">v</span> <span class="id" title="var">s'</span> &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pure_atom_gt1</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">pos</span> &amp;&amp; <span class="id" title="var">pure_atom_gt1</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">s'</span> <span class="id" title="var">v</span>) <span class="id" title="var">pos'</span> &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pure_atom_gt</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) (<span class="id" title="var">Eqv</span> <span class="id" title="var">s'</span> <span class="id" title="var">v</span>) &amp;&amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">greater_than_all</span> <span class="id" title="var">s0</span> <span class="id" title="var">neg</span> &amp;&amp; <span class="id" title="var">greater_than_all</span> <span class="id" title="var">s'0</span> <span class="id" title="var">neg'</span>       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">mkPureClause</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merge</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">neg</span> <span class="id" title="var">neg'</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insu_atm</span> (<span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)) (<span class="id" title="var">merge</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">pos</span> <span class="id" title="var">pos'</span>)) :: <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Retractive rules:
<ul class="doclist">
<li>demodulation (simplification by positive unit clauses), 

</li>
<li>equality resolution 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rewrite_expr</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span> := <span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span> <span class="id" title="keyword">then</span> <span class="id" title="var">t</span> <span class="id" title="keyword">else</span> <span class="id" title="var">u</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">atm</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">atm</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">u</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">v</span> <span class="id" title="keyword">then</span> <span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">s</span> <span class="id" title="var">v</span> <span class="id" title="keyword">then</span> <span class="id" title="var">norm_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">u</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">atm</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rewrite_in_space</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">atm</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">atm</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> ⇒ <span class="id" title="keyword">Next</span> (<span class="id" title="var">rewrite_expr</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) (<span class="id" title="var">rewrite_expr</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> ⇒ <span class="id" title="var">Lseg</span> (<span class="id" title="var">rewrite_expr</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) (<span class="id" title="var">rewrite_expr</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rewrite_clause_in_space</span> <span class="id" title="var">c</span> <span class="id" title="var">atm</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">rewrite_in_space</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">atm</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">atm</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Rewrite by a positive unit clause 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">demodulate</span> (<span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span>, <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">pos</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkPureClause</span> (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">neg</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">pos</span>)  <br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">pos</span> <span class="id" title="var">space</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">neg</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">pos</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_in_space</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">space</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">space</span> <span class="id" title="var">pos</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">neg</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_in_space</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">space</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) <span class="id" title="var">pos</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Delete resolved negative atoms, i.e., atoms of the form <span class="inlinecode"><span class="id" title="var">Eqv</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> 
    lying in negative positions.  This is called equality resolution by some. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">delete_resolved</span> (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">pos</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mkPureClause</span> (<span class="id" title="var">sortu_atms</span> (<span class="id" title="var">remove_trivial_atoms</span> <span class="id" title="var">neg</span>)) (<span class="id" title="var">sortu_atms</span> <span class="id" title="var">pos</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">c</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Filter tautological clauses 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_taut</span> (<span class="id" title="var">c</span>: <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">negb</span> (<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">neg</span> <span class="id" title="var">pos</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pure_atom_eq</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) <span class="id" title="var">pos</span>) <span class="id" title="var">neg</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Eqv</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> ⇒ <span class="id" title="var">expr_eq</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">end</span>) <span class="id" title="var">pos</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
</div>

<div class="doc">
Rewrite <span class="inlinecode"><span class="id" title="var">c</span></span> by positive unit clauses in <span class="inlinecode"><span class="id" title="var">l</span></span>. Delete resolved atoms 
    from the resulting clause. Argument <span class="inlinecode"><span class="id" title="var">l</span></span> is already sorted so no need to 
    re-sort. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">simplify</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">delete_resolved</span> (<span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> <span class="id" title="var">c</span> ⇒ <span class="id" title="var">demodulate</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>) <span class="id" title="var">l</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">simplify_atoms</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) (<span class="id" title="var">atms</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">atms</span> <span class="id" title="var">d</span> ⇒ <span class="id" title="var">map</span> (<span class="id" title="var">rewrite_clause_in_space</span> <span class="id" title="var">d</span>) <span class="id" title="var">atms</span>) <span class="id" title="var">l</span> <span class="id" title="var">atms</span>.<br/>

<br/>
</div>

<div class="doc">
Derive clauses from clause <span class="inlinecode"><span class="id" title="var">c</span></span> and clauses <span class="inlinecode"><span class="id" title="var">l</span></span> using <span class="inlinecode"><span class="id" title="var">cty</span></span> inferences alone. 
    Forward-simplify any resulting clauses using facts in <span class="inlinecode"><span class="id" title="var">l</span></span> (note: we do no 
    backward simplification here since this would greatly complicate the termination 
    proof). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">infer</span> (<span class="id" title="var">cty</span> : <span class="id" title="var">ce_type</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">print_inferred_list</span> (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">compare_clause</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">filter</span> <span class="id" title="var">not_taut</span> (<span class="id" title="var">map</span> (<span class="id" title="var">simplify</span> <span class="id" title="var">nil</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ef</span> <span class="id" title="var">cty</span> <span class="id" title="var">c</span> (<span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l0</span> <span class="id" title="var">d</span> ⇒ <span class="id" title="var">sp</span> <span class="id" title="var">cty</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">l0</span>) <span class="id" title="var">l</span> <span class="id" title="var">nil</span>))))).<br/>

<br/>
</div>

<div class="doc">
Model generation: build a candidate model for clauses <span class="inlinecode"><span class="id" title="var">l</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">apply_model</span> (<span class="id" title="var">R</span> : <span class="id" title="var">model</span>) (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve</span> ⇒ <span class="id" title="var">subst_clause</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">ve</span>)) <span class="id" title="var">cl</span> <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_model_of</span> (<span class="id" title="var">R</span> : <span class="id" title="var">model</span>) (<span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> : <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve</span> ⇒ <span class="id" title="var">subst_pures_delete</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">ve</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">remove_trivial_atoms</span> <span class="id" title="var">gamma</span>) <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve</span> ⇒ <span class="id" title="var">subst_pures</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">ve</span>)) <span class="id" title="keyword">delta</span> <span class="id" title="var">R</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>::<span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> , <span class="id" title="var">delta'</span> ⇒ <span class="id" title="var">negb</span> (<span class="id" title="var">forallb</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">delta'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check whether R is a model of <span class="inlinecode"><span class="id" title="var">Pi</span>+</span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" title="var">Pi</span>-</span>; used in the Veristar main loop 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_model_of_PI</span> (<span class="id" title="var">R</span>: <span class="id" title="var">model</span>) (<span class="id" title="var">nc</span> :  <span class="id" title="var">clause</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">nc</span> <span class="id" title="keyword">with</span> <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">pi_plus</span> <span class="id" title="var">_</span> <span class="id" title="var">pi_minus</span> ⇒<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">subst_pures_delete</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">ve</span>)) (<span class="id" title="var">remove_trivial_atoms</span> <span class="id" title="var">pi_plus</span>) <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">subst_pures</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">ve</span>)) <span class="id" title="var">pi_minus</span> <span class="id" title="var">R</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> , <span class="id" title="var">pi_minus'</span> ⇒ <span class="id" title="var">forallb</span> <span class="id" title="var">nonreflex_atom</span> <span class="id" title="var">pi_minus'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Is there a rewrite rule <span class="inlinecode"><span class="id" title="var">v'</span>→<span class="id" title="var">r</span></span> in <span class="inlinecode"><span class="id" title="var">R</span></span> s.t. <span class="inlinecode"><span class="id" title="var">v</span>==<span class="id" title="var">v'</span></span>? 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">reduces</span> (<span class="id" title="var">R</span>: <span class="id" title="var">model</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">var</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="var">existsb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ve'</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">v</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ve'</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>) <span class="id" title="var">R</span>.<br/>

<br/>
</div>

<div class="doc">
Does clause <span class="inlinecode"><span class="id" title="var">cl</span></span> generate a new rewrite rule that must be added to the 
    candidate model <span class="inlinecode"><span class="id" title="var">R</span></span>? If so, return the rewrite rule paired with <span class="inlinecode"><span class="id" title="var">cl</span></span>. Otherwise 
    <span class="inlinecode"><span class="id" title="var">cl</span></span> is a c-example for the current candidate model (invariant: <span class="inlinecode"><span class="id" title="var">clause_generate</span></span> 
    <span class="inlinecode"><span class="id" title="var">R</span></span> <span class="inlinecode"><span class="id" title="var">cl</span></span> is only called when <span class="inlinecode"><span class="id" title="var">R</span></span> is <span class="inlinecode"><span class="id" title="var">not</span></span> already a model for <span class="inlinecode"><span class="id" title="var">cl</span></span>) so determine which 
    type of c-example <span class="inlinecode"><span class="id" title="var">cl</span></span> is, and return that as a value of <span class="inlinecode"><span class="id" title="var">ce_type</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">clause_generate</span> (<span class="id" title="var">R</span> : <span class="id" title="var">model</span>) (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) <br/>
&nbsp;&nbsp;: (<span class="id" title="var">var</span> × <span class="id" title="var">expr</span> × <span class="id" title="var">clause</span>) + <span class="id" title="var">ce_type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>) <span class="id" title="var">r</span> :: <span class="id" title="keyword">delta</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">c'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">greater_than_expr</span> <span class="id" title="var">l'</span> <span class="id" title="var">r</span> &amp;&amp; <span class="id" title="var">greater_than_all</span> <span class="id" title="var">l'</span> <span class="id" title="var">gamma</span> &amp;&amp; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">greater_than_atoms</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">delta</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">reduces</span> <span class="id" title="var">R</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">inr</span> <span class="id" title="var">_</span> <span class="id" title="var">CexpR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">is_model_of</span> (<span class="id" title="var">List.rev</span> <span class="id" title="var">R</span>) <span class="id" title="var">nil</span> (<span class="id" title="var">map</span> (<span class="id" title="var">rewrite_by</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">delta</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">inr</span> <span class="id" title="var">_</span> <span class="id" title="var">CexpEf</span> <span class="id" title="keyword">else</span> <span class="id" title="var">inl</span> <span class="id" title="var">_</span> (<span class="id" title="var">l'</span>, <span class="id" title="var">r</span>, <span class="id" title="var">cl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">inr</span> <span class="id" title="var">_</span> <span class="id" title="var">CexpL</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">inr</span> <span class="id" title="var">_</span> <span class="id" title="var">CexpL</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Construct a candidate model for <span class="inlinecode"><span class="id" title="var">l</span></span> or fail with (1) the partial model built
    so far (for debugging); (2) the clause that failed; and (3) its <span class="inlinecode"><span class="id" title="var">ce_type</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">partial_mod</span> (<span class="id" title="var">R</span> : <span class="id" title="var">model</span>) (<span class="id" title="var">acc</span> <span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) <br/>
&nbsp;&nbsp;: (<span class="id" title="var">model</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) + (<span class="id" title="var">model</span> × <span class="id" title="var">clause</span> × <span class="id" title="var">ce_type</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">inl</span> <span class="id" title="var">_</span> (<span class="id" title="var">R</span>, <span class="id" title="var">acc</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">cl</span> :: <span class="id" title="var">l'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">is_model_of</span> (<span class="id" title="var">List.rev</span> <span class="id" title="var">R</span>) <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="keyword">then</span> <span class="id" title="var">partial_mod</span> <span class="id" title="var">R</span> <span class="id" title="var">acc</span> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">clause_generate</span> <span class="id" title="var">R</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">inl</span> (<span class="id" title="var">v</span>, <span class="id" title="var">exp</span>, <span class="id" title="var">cl'</span>)) ⇒ <span class="id" title="var">partial_mod</span> ((<span class="id" title="var">v</span>, <span class="id" title="var">exp</span>) :: <span class="id" title="var">R</span>) (<span class="id" title="var">cl'</span> :: <span class="id" title="var">acc</span>) <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">inr</span> <span class="id" title="var">cty</span>) ⇒ <span class="id" title="var">inr</span> <span class="id" title="var">_</span> (<span class="id" title="var">print_ce_clause</span> <span class="id" title="var">R</span> <span class="id" title="var">cl</span> <span class="id" title="var">cty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">inl</span> <span class="id" title="var">_</span> (<span class="id" title="var">R</span>, <span class="id" title="var">acc</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_empty_clause</span> (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_unit_clause</span> (<span class="id" title="var">cl</span> : <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">nil</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ppred_decrease</span> <span class="id" title="var">n</span> : (<span class="id" title="var">n</span>&lt;&gt;1)%<span class="id" title="var">positive</span> → (<span class="id" title="var">nat_of_P</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>)&lt;<span class="id" title="var">nat_of_P</span> <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Psucc_pred</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hpred</span> | <span class="id" title="var">Hpred</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>;<br/>
<span class="id" title="tactic">pattern</span> <span class="id" title="var">n</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hpred</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_of_P_succ_morphism</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Recdef</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
The Superpose main loop 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Function</span> <span class="id" title="var">main</span> (<span class="id" title="var">n</span> : <span class="id" title="var">positive</span>) (<span class="id" title="var">units</span> <span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span>) {<span class="id" title="keyword">measure</span> <span class="id" title="var">nat_of_P</span> <span class="id" title="var">n</span>} <br/>
&nbsp;&nbsp;: <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span>×<span class="id" title="var">M.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Pos.eqb</span> <span class="id" title="var">n</span> 1 <span class="id" title="keyword">then</span> (<span class="id" title="var">Aborted</span> <span class="id" title="var">l</span>, <span class="id" title="var">units</span>, <span class="id" title="var">M.empty</span>, <span class="id" title="var">M.empty</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">existsb</span> <span class="id" title="var">is_empty_clause</span> (<span class="id" title="var">map</span> <span class="id" title="var">delete_resolved</span> <span class="id" title="var">l</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> (<span class="id" title="var">Valid</span>, <span class="id" title="var">units</span>, <span class="id" title="var">M.empty</span>, <span class="id" title="var">M.empty</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">partition</span> <span class="id" title="var">is_unit_clause</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">us</span>, <span class="id" title="var">rs</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">us'</span> := <span class="id" title="var">cclose</span> <span class="id" title="var">us</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l'</span> := <span class="id" title="var">filter</span> <span class="id" title="var">not_taut</span> (<span class="id" title="var">map</span> (<span class="id" title="var">simplify</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">print_eqs_list</span> <span class="id" title="var">us'</span>)) <span class="id" title="var">rs</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">partial_mod</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inl</span> (<span class="id" title="var">R</span>, <span class="id" title="var">selected</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">C_example</span> <span class="id" title="var">R</span> (<span class="id" title="var">clause_list2set</span> <span class="id" title="var">selected</span>), <span class="id" title="var">cclose</span> (<span class="id" title="var">us'</span>++<span class="id" title="var">units</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clause_list2set</span> <span class="id" title="var">l'</span>, <span class="id" title="var">M.empty</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inr</span> (<span class="id" title="var">R</span>, <span class="id" title="var">cl</span>, <span class="id" title="var">cty</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r</span> := <span class="id" title="var">infer</span> <span class="id" title="var">cty</span> <span class="id" title="var">cl</span> <span class="id" title="var">l'</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">main</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>) (<span class="id" title="var">cclose</span> (<span class="id" title="var">us'</span>++<span class="id" title="var">units</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">print_pures_list</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_clause2</span>) (<span class="id" title="var">r</span> ++ <span class="id" title="var">l'</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">falsity</span>. <span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">main</span>.<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">positive</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">list</span> <span class="id" title="var">clause</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span> × <span class="id" title="var">M.t</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Convert a pure entailment to clausal-nf 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">purecnf</span> (<span class="id" title="var">en</span>: <span class="id" title="var">entailment</span>) : <span class="id" title="var">M.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">en</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Entailment</span> (<span class="id" title="var">Assertion</span> <span class="id" title="var">pureL</span> <span class="id" title="var">spaceL</span>) (<span class="id" title="var">Assertion</span> <span class="id" title="var">pureR</span> <span class="id" title="var">spaceR</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mk_pureR</span> <span class="id" title="var">pureL</span>, <span class="id" title="var">mk_pureR</span> <span class="id" title="var">pureR</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span>, <span class="id" title="var">n</span>), (<span class="id" title="var">p'</span>, <span class="id" title="var">n'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pureplus</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">mkPureClause</span> <span class="id" title="var">nil</span> (<span class="id" title="var">norm_pure_atom</span> <span class="id" title="var">a</span>::<span class="id" title="var">nil</span>)) <span class="id" title="var">p</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pureminus</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">mkPureClause</span> (<span class="id" title="var">norm_pure_atom</span> <span class="id" title="var">a</span>::<span class="id" title="var">nil</span>) <span class="id" title="var">nil</span>) <span class="id" title="var">n</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pureplus'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">map</span> <span class="id" title="var">norm_pure_atom</span> <span class="id" title="var">p'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pureminus'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">map</span> <span class="id" title="var">norm_pure_atom</span> <span class="id" title="var">n'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cl</span> := <span class="id" title="var">mkPureClause</span> <span class="id" title="var">pureplus'</span> <span class="id" title="var">pureminus'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clause_list2set</span> (<span class="id" title="var">cl</span> :: <span class="id" title="var">pureplus</span> ++ <span class="id" title="var">pureminus</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">check</span> (<span class="id" title="var">ent</span> : <span class="id" title="var">entailment</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span>×<span class="id" title="var">M.t</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">main</span> 1000000000 <span class="id" title="var">nil</span> (<span class="id" title="var">print_pures_list</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_clause2</span>) (<span class="id" title="var">M.elements</span> (<span class="id" title="var">purecnf</span> <span class="id" title="var">ent</span>)))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">check_clauseset</span> (<span class="id" title="var">s</span> : <span class="id" title="var">M.t</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">superposition_result</span> × <span class="id" title="var">list</span> <span class="id" title="var">clause</span> × <span class="id" title="var">M.t</span>×<span class="id" title="var">M.t</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">main</span> 1000000000 <span class="id" title="var">nil</span> (<span class="id" title="var">print_pures_list</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_clause2</span>) (<span class="id" title="var">M.elements</span> (<span class="id" title="var">M.filter</span> <span class="id" title="var">not_taut</span> <span class="id" title="var">s</span>)))).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Superposition</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">HeapResolve</span>.<br/>

<br/>
</div>

<div class="doc">
Normalization Rules 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">normalize1_3</span> (<span class="id" title="var">pc</span> <span class="id" title="var">sc</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">pc</span> , <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x</span>) <span class="id" title="var">y</span> :: <span class="id" title="keyword">delta</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">delta'</span> <span class="id" title="var">sigma</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">gamma</span>++<span class="id" title="var">gamma'</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="keyword">delta</span>++<span class="id" title="var">delta'</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">subst_spaces</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sigma</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">Eqv</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x</span>) <span class="id" title="var">y</span> :: <span class="id" title="keyword">delta</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> (<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">gamma</span>++<span class="id" title="var">gamma'</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">subst_spaces</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sigma</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="keyword">delta</span>++<span class="id" title="var">delta'</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span>  ⇒ <span class="id" title="var">sc</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">normalize2_4</span> (<span class="id" title="var">sc</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> (<span class="id" title="var">drop_reflex_lseg</span> <span class="id" title="var">sigma</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="var">sigma</span> <span class="id" title="keyword">delta</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">drop_reflex_lseg</span> <span class="id" title="var">sigma</span>) <span class="id" title="keyword">delta</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">sc</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">norm</span> (<span class="id" title="var">s</span>:  <span class="id" title="var">M.t</span>) (<span class="id" title="var">sc</span>: <span class="id" title="var">clause</span>) : <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">normalize2_4</span> (<span class="id" title="var">List.fold_right</span> <span class="id" title="var">normalize1_3</span> <span class="id" title="var">sc</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_clause2</span>) (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>))).<br/>

<br/>
</div>

<div class="doc">
Wellformedness Rules 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">do_well1_2</span> (<span class="id" title="var">sc</span>: <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> <span class="id" title="var">Nil</span> <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">nil</span> :: <span class="id" title="var">do_well1_2</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> <span class="id" title="var">Nil</span> <span class="id" title="var">y</span> :: <span class="id" title="var">sc'</span> ⇒ [<span class="id" title="var">Eqv</span> <span class="id" title="var">y</span> <span class="id" title="var">Nil</span>] :: <span class="id" title="var">do_well1_2</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">do_well1_2</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Next x ? \in sc 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">next_in_dom</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Ident.t</span>) (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span>) <span class="id" title="var">y</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">next_in_dom</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">next_in_dom</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Next x ? \in sc, ?=y 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">next_in_dom1</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Ident.t</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">expr</span>) (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span>) <span class="id" title="var">y'</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">next_in_dom1</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span> <span class="id" title="keyword">else</span> <span class="id" title="var">next_in_dom1</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">next_in_dom1</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Next x ? \in sc, ?&lt;&gt;y 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">next_in_dom2</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Ident.t</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">expr</span>) (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">option</span> <span class="id" title="var">expr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span>) <span class="id" title="var">y'</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">expr_eq</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">next_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">Some</span> <span class="id" title="var">y'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">next_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">next_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">do_well3</span> (<span class="id" title="var">sc</span>: <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x</span>) <span class="id" title="var">y</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">next_in_dom</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">nil</span> :: <span class="id" title="var">do_well3</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">do_well3</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">do_well3</span> <span class="id" title="var">sc'</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Lseg x ?, ?&lt;&gt;y 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lseg_in_dom2</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Ident.t</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">expr</span>) (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">option</span> <span class="id" title="var">expr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x0</span>) <span class="id" title="var">y0</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">negb</span> (<span class="id" title="var">expr_eq</span> <span class="id" title="var">y0</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">Some</span> <span class="id" title="var">y0</span> <span class="id" title="keyword">else</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lseg_in_dom_atoms</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Ident.t</span>) (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x0</span>) <span class="id" title="var">y0</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">order_eqv_pure_atom</span> (<span class="id" title="var">Eqv</span> <span class="id" title="var">x0</span> <span class="id" title="var">y0</span>) :: <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">x</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">do_well4_5</span> (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">Next</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span>) <span class="id" title="var">y</span> :: <span class="id" title="var">sc'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">atms</span> := <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ [<span class="id" title="var">a</span>]) (<span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">x'</span> <span class="id" title="var">sc'</span>) <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">atms</span> ++ <span class="id" title="var">do_well4_5</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x0</span>) <span class="id" title="var">y</span> :: <span class="id" title="var">sc'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">x'</span> <span class="id" title="var">sc'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l0</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">do_well4_5</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">atms</span> := <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">normalize_atoms</span> [<span class="id" title="var">Eqv</span> <span class="id" title="var">x0</span> <span class="id" title="var">y</span>; <span class="id" title="var">a</span>]) <span class="id" title="var">l0</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">atms</span> ++ <span class="id" title="var">do_well4_5</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">a</span> :: <span class="id" title="var">sc'</span> ⇒ <span class="id" title="var">do_well4_5</span> <span class="id" title="var">sc'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">do_well</span> (<span class="id" title="var">sc</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">pure_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">do_well1_2</span> <span class="id" title="var">sc</span> ++ <span class="id" title="var">do_well3</span> <span class="id" title="var">sc</span> ++ <span class="id" title="var">do_well4_5</span> <span class="id" title="var">sc</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">do_wellformed</span> (<span class="id" title="var">sc</span>: <span class="id" title="var">clause</span>) : <span class="id" title="var">M.t</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma'</span> := <span class="id" title="var">rsort</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) <span class="id" title="var">sigma</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clause_list2set</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ats</span> ⇒ <span class="id" title="var">mkPureClause</span> <span class="id" title="var">gamma</span> (<span class="id" title="var">normalize_atoms</span> (<span class="id" title="var">ats</span>++<span class="id" title="keyword">delta</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">do_well</span> <span class="id" title="var">sigma'</span>))<br/>
&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">M.empty</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Unfolding Rules 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">spatial_resolution</span> (<span class="id" title="var">pc</span> <span class="id" title="var">nc</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">M.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">pc</span> , <span class="id" title="var">nc</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">delta'</span> <span class="id" title="var">sigma'</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="var">sigma</span> <span class="id" title="keyword">delta</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">eq_space_atomlist</span> (<span class="id" title="var">rsort</span> <span class="id" title="var">compare_space_atom</span> <span class="id" title="var">sigma</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rsort</span> <span class="id" title="var">compare_space_atom</span> <span class="id" title="var">sigma'</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span> ⇒ <span class="id" title="var">M.singleton</span> (<span class="id" title="var">order_eqv_clause</span> (<span class="id" title="var">mkPureClause</span> (<span class="id" title="var">gamma</span>++<span class="id" title="var">gamma'</span>) (<span class="id" title="keyword">delta</span>++<span class="id" title="var">delta'</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span> ⇒ <span class="id" title="var">M.empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">M.empty</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding1'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) <span class="id" title="var">z</span> :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">next_in_dom1</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="keyword">Next</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>) (<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">unfolding1'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">unfolding1'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding1'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding1</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding1'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">p</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">atm</span>, <span class="id" title="var">sigma2'</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">atm</span>) <span class="id" title="var">delta'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding2'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) <span class="id" title="var">z</span> :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">next_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Eqv</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="keyword">Next</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) (<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">unfolding2'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">unfolding2'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding2'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding2</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding2'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">p</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">atm</span>, <span class="id" title="var">sigma2'</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">atm</span>) <span class="id" title="var">delta'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding3'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) <span class="id" title="var">Nil</span> :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">Nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">Nil</span>) (<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">unfolding3'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">Nil</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">unfolding3'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">Nil</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding3'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding3</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding3'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">sigma2'</span> := <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2'</span> <span class="id" title="var">delta'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
NPR's rule given in the paper. Confirmed unsound by NP.
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding4NPR'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Var</span> <span class="id" title="var">z'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">z</span>) :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">next_in_dom</span> <span class="id" title="var">z'</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) (<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">unfolding4NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">unfolding4NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">unfolding4NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding4NPR'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfoldingNPR4</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding4NPR'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">sigma2'</span> := <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2'</span> <span class="id" title="var">delta'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Our rule; also suggested by NP. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding4</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding4NPR'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">GG'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">gamma</span> ++ <span class="id" title="var">gamma'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">DD'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="keyword">delta</span> ++ <span class="id" title="var">delta'</span>) <span class="id" title="tactic">in</span>    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">sigma2'</span> := <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">GG'</span> <span class="id" title="var">sigma2'</span> <span class="id" title="var">DD'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Unsound rule as given in NPR's paper 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Var</span> <span class="id" title="var">z'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">z</span>) :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">atms</span> := <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">z'</span> <span class="id" title="var">sigma1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atm</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">atm</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atms</span> ++ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding5NPR</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding5NPR'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">p</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">atm</span>, <span class="id" title="var">sigma2'</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">atm</span>) <span class="id" title="var">delta'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Rule as given in NPR's paper, corrected variable uses 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding5NPRALT'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Var</span> <span class="id" title="var">z'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">z</span>) :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span>, <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span>, <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">atms</span> := <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">z'</span> <span class="id" title="var">sigma1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atm</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">atm</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atms</span> ++ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding5NPR'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Our version - also suggested by NP in his reply. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding5</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding5NPR'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">GG'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">gamma</span> ++ <span class="id" title="var">gamma'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">DD'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="keyword">delta</span> ++ <span class="id" title="var">delta'</span>) <span class="id" title="tactic">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">p</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">atm</span>, <span class="id" title="var">sigma2'</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">GG'</span> <span class="id" title="var">sigma2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">atm</span>) <span class="id" title="var">DD'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Same as unfolding5NPR', but with added side-condition 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">unfolding6NPR'</span> (<span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> : <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) <br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">pure_atom</span> × <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sigma2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lseg</span> (<span class="id" title="var">Var</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Var</span> <span class="id" title="var">z'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">z</span>) :: <span class="id" title="var">sigma2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Ident.eq_dec</span> <span class="id" title="var">x'</span> <span class="id" title="var">z'</span> <span class="id" title="keyword">then</span> <span class="id" title="var">unfolding6NPR'</span> <span class="id" title="var">sigma0</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span> <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lseg_in_dom2</span> <span class="id" title="var">x'</span> <span class="id" title="var">z</span> <span class="id" title="var">sigma1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">y</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">atms</span> := <span class="id" title="var">lseg_in_dom_atoms</span> <span class="id" title="var">z'</span> <span class="id" title="var">sigma1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atm</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">atm</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert</span> (<span class="id" title="var">rev_cmp</span> <span class="id" title="var">compare_space_atom</span>) (<span class="id" title="var">Lseg</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">rev</span> <span class="id" title="var">sigma0</span> ++ <span class="id" title="var">sigma2'</span>))) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">build_res</span> <span class="id" title="var">atms</span> ++ <span class="id" title="var">unfolding6NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unfolding6NPR'</span> (<span class="id" title="var">Lseg</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">sigma2'</span> ⇒ <span class="id" title="var">unfolding6NPR'</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">sigma0</span>) <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding6</span> (<span class="id" title="var">sc1</span> <span class="id" title="var">sc2</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sc1</span> , <span class="id" title="var">sc2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">sigma1</span> , <span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">sigma2</span> <span class="id" title="var">delta'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l0</span> := <span class="id" title="var">unfolding6NPR'</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma1</span> <span class="id" title="var">sigma2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">GG'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">gamma</span> ++ <span class="id" title="var">gamma'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">DD'</span> := <span class="id" title="var">rsort_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="keyword">delta</span> ++ <span class="id" title="var">delta'</span>) <span class="id" title="tactic">in</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">p</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">atm</span>, <span class="id" title="var">sigma2'</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">GG'</span> <span class="id" title="var">sigma2'</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">insert_uniq</span> <span class="id" title="var">pure_atom_cmp</span> (<span class="id" title="var">order_eqv_pure_atom</span> <span class="id" title="var">atm</span>) <span class="id" title="var">DD'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> <span class="id" title="var">build_clause</span> <span class="id" title="var">l0</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mem_add</span> (<span class="id" title="var">x</span>: <span class="id" title="var">M.elt</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) : <span class="id" title="var">option</span> <span class="id" title="var">M.t</span> :=<br/>
&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">M.mem</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">None</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Some</span> (<span class="id" title="var">M.add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">add_list_to_set_simple</span> (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">M.elt</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) : <span class="id" title="var">M.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">fold_left</span> (<span class="id" title="var">Basics.flip</span> <span class="id" title="var">M.add</span>) <span class="id" title="var">l</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">add_list_to_set</span> (<span class="id" title="var">l</span>: <span class="id" title="var">list</span> <span class="id" title="var">M.elt</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) : <span class="id" title="var">option</span> <span class="id" title="var">M.t</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">x</span>::<span class="id" title="var">xs</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">mem_add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">add_list_to_set</span> <span class="id" title="var">xs</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">s'</span> ⇒ <span class="id" title="var">Some</span> (<span class="id" title="var">add_list_to_set_simple</span> <span class="id" title="var">xs</span> <span class="id" title="var">s'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;| <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">None</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">do_unfold'</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> <span class="id" title="var">l</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">unfolding1</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> ++<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolding2</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> ++ <span class="id" title="var">unfolding3</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> ++<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolding4</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> ++ <span class="id" title="var">unfolding6</span> <span class="id" title="var">pc</span> <span class="id" title="var">nc</span> ++ <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">do_unfold</span> (<span class="id" title="var">n</span>: <span class="id" title="var">nat</span>) (<span class="id" title="var">pc</span> : <span class="id" title="var">clause</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">M.t</span>) : <span class="id" title="var">M.t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">O</span> ⇒ <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">add_list_to_set</span>  (<span class="id" title="var">M.fold</span> (<span class="id" title="var">do_unfold'</span> <span class="id" title="var">pc</span>) <span class="id" title="var">s</span> <span class="id" title="var">nil</span>)  <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">s''</span> ⇒ <span class="id" title="var">do_unfold</span> <span class="id" title="var">n'</span> <span class="id" title="var">pc</span> <span class="id" title="var">s''</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> ⇒ <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfolding</span> (<span class="id" title="var">pc</span> <span class="id" title="var">nc</span> : <span class="id" title="var">clause</span>) : <span class="id" title="var">M.t</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">M.fold</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> ⇒ <span class="id" title="var">M.union</span> (<span class="id" title="var">spatial_resolution</span> <span class="id" title="var">pc</span> <span class="id" title="var">c</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">do_unfold</span> 500 <span class="id" title="var">pc</span> (<span class="id" title="var">M.add</span> <span class="id" title="var">nc</span> <span class="id" title="var">M.empty</span>)) <span class="id" title="var">M.empty</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">HeapResolve</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Superposition</span>. <span class="id" title="keyword">Import</span> <span class="id" title="var">HeapResolve</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">Recdef</span>.<br/>

<br/>
</div>

<div class="doc">
The VeriStar interface 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">veristar_result</span> :=<br/>
| <span class="id" title="var">Valid</span> : <span class="id" title="var">veristar_result</span><br/>
| <span class="id" title="var">C_example</span> : <span class="id" title="var">model</span> → <span class="id" title="var">veristar_result</span><br/>
| <span class="id" title="var">Aborted</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span> → <span class="id" title="var">veristar_result</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">VERISTAR</span>.<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">check_entailment</span> : <span class="id" title="var">entailment</span> → <span class="id" title="var">veristar_result</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">VERISTAR</span>.<br/>

<br/>
</div>

<div class="doc">
The VeriStar implementation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">VeriStar</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">veristar_result</span> :=<br/>
| <span class="id" title="var">Valid</span> : <span class="id" title="var">veristar_result</span><br/>
| <span class="id" title="var">C_example</span> : <span class="id" title="var">model</span> → <span class="id" title="var">veristar_result</span><br/>
| <span class="id" title="var">Aborted</span> : <span class="id" title="var">list</span> <span class="id" title="var">clause</span> → <span class="id" title="var">clause</span> → <span class="id" title="var">veristar_result</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pureb</span> <span class="id" title="var">c</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span> <span class="id" title="var">PureClause</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pure_clauses</span> := <span class="id" title="var">filter</span> <span class="id" title="var">pureb</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_empty_clause</span> (<span class="id" title="var">c</span> : <span class="id" title="var">clause</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span> <span class="id" title="var">PureClause</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pures</span> := <span class="id" title="var">M.filter</span> <span class="id" title="var">pureb</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ppred_decrease</span> <span class="id" title="var">n</span> : <br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span>&lt;&gt;1)%<span class="id" title="var">positive</span> → (<span class="id" title="var">nat_of_P</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>)&lt;<span class="id" title="var">nat_of_P</span> <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Psucc_pred</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hpred</span> | <span class="id" title="var">Hpred</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> <span class="id" title="var">n</span> <span class="id" title="tactic">at</span> 2; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hpred</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_of_P_succ_morphism</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Top-level redundancy elimination 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">RedundancyElim</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>}.<br/>
<span class="id" title="keyword">Variable</span> (<span class="id" title="var">cmp</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span>→<span class="id" title="var">comparison</span>).<br/>

<br/>
</div>

<div class="doc">
Linear time sublist for sorted lists 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">sublistg</span> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">l1'</span>, <span class="id" title="var">b</span>::<span class="id" title="var">l2'</span> ⇒ <span class="id" title="var">andb</span> (<span class="id" title="var">isEq</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)) (<span class="id" title="var">sublistg</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>::<span class="id" title="var">_</span>, <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">sublist</span> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l1</span>, <span class="id" title="var">l2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">l1'</span>, <span class="id" title="var">b</span>::<span class="id" title="var">l2'</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">cmp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">sublistg</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span> <span class="id" title="keyword">else</span> <span class="id" title="var">sublist</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>::<span class="id" title="var">_</span>, <span class="id" title="var">nil</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">RedundancyElim</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">impl_pure_clause</span> (<span class="id" title="var">c</span> <span class="id" title="var">d</span>: <span class="id" title="var">clause</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span>, <span class="id" title="var">d</span> <span class="id" title="keyword">with</span> <span class="id" title="var">PureClause</span> <span class="id" title="var">gamma</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">PureClause</span> <span class="id" title="var">gamma'</span> <span class="id" title="var">delta'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andb</span> (<span class="id" title="var">sublist</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="var">gamma</span> <span class="id" title="var">gamma'</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">sublist</span> <span class="id" title="var">pure_atom_cmp</span> <span class="id" title="keyword">delta</span> <span class="id" title="var">delta'</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">relim1</span> (<span class="id" title="var">c</span>: <span class="id" title="var">clause</span>) (<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">M.filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> ⇒ <span class="id" title="var">negb</span> (<span class="id" title="var">impl_pure_clause</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>)) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">incorp</span> (<span class="id" title="var">s</span> <span class="id" title="var">t</span> : <span class="id" title="var">M.t</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="var">M.union</span> <span class="id" title="var">s</span> (<span class="id" title="var">M.fold</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> <span class="id" title="var">t0</span> ⇒ <span class="id" title="var">relim1</span> <span class="id" title="var">c</span> <span class="id" title="var">t0</span>) <span class="id" title="var">s</span> <span class="id" title="var">t</span>).<br/>

<br/>
</div>

<div class="doc">
The main loop of the prover 
<div class="paragraph"> </div>

************************
          Lemma the_loop_termination1: 
forall (n : positive) (sigma : list space_atom) (nc : clause) (s : M.t),
(n =? 1)positive = false -&gt;
forall (p : superposition_result * list clause * M.t) (t : M.t)
  (p0 : superposition_result * list clause) (s_star : M.t)
  (s0 : superposition_result) (units : list clause) (R : model)
  (selected : M.t),
s0 = Superposition.C_example R selected -&gt;
p0 = (Superposition.C_example R selected, units) -&gt;
p = (Superposition.C_example R selected, units, s_star) -&gt;
check_clauseset s = (Superposition.C_example R selected, units, s_star, t) -&gt;
isEq
  (M.compare
     (incorp
        (print_wf_set
           (do_wellformed
              (print_spatial_model
                 (norm (print_wf_set selected)
                    (PosSpaceClause <font size=-2>&#9744;</font> <font size=-2>&#9744;</font> (simplify_atoms units sigma))) R)))
        s_star) s_star) = false -&gt; Pos.to_nat (Pos.pred n) &lt; Pos.to_nat n.
Admitted.

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Function</span> <span class="id" title="var">the_loop</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span>: <span class="id" title="var">positive</span>) (<span class="id" title="var">sigma</span>: <span class="id" title="var">list</span> <span class="id" title="var">space_atom</span>) (<span class="id" title="var">nc</span>: <span class="id" title="var">clause</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">s</span>: <span class="id" title="var">M.t</span>) (<span class="id" title="var">cl</span>: <span class="id" title="var">clause</span>) {<span class="id" title="keyword">measure</span> <span class="id" title="var">nat_of_P</span> <span class="id" title="var">n</span>} : <span class="id" title="var">veristar_result</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Pos.eqb</span> <span class="id" title="var">n</span> 1 <span class="id" title="keyword">then</span> <span class="id" title="var">Aborted</span> (<span class="id" title="var">M.elements</span> <span class="id" title="var">s</span>) <span class="id" title="var">cl</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">check_clauseset</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">Superposition.Valid</span>, <span class="id" title="var">units</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>) ⇒ <span class="id" title="var">Valid</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">Superposition.C_example</span> <span class="id" title="var">R</span> <span class="id" title="var">selected</span>, <span class="id" title="var">units</span>, <span class="id" title="var">s_star</span>, <span class="id" title="var">_</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma'</span> := <span class="id" title="var">simplify_atoms</span> <span class="id" title="var">units</span> <span class="id" title="var">sigma</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">nc'</span> := <span class="id" title="var">simplify</span> <span class="id" title="var">units</span> <span class="id" title="var">nc</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <span class="id" title="var">print_spatial_model</span> (<span class="id" title="var">norm</span> (<span class="id" title="var">print_wf_set</span> <span class="id" title="var">selected</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">PosSpaceClause</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">sigma'</span>)) <span class="id" title="var">R</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">nu_s</span> := <span class="id" title="var">incorp</span> (<span class="id" title="var">print_wf_set</span> (<span class="id" title="var">do_wellformed</span> <span class="id" title="var">c</span>)) <span class="id" title="var">s_star</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">M.compare</span> <span class="id" title="var">nu_s</span> <span class="id" title="var">s_star</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">if</span> <span class="id" title="var">is_model_of_PI</span> (<span class="id" title="var">List.rev</span> <span class="id" title="var">R</span>) (<span class="id" title="var">print_spatial_model</span> <span class="id" title="var">nc'</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">let</span> <span class="id" title="var">c'</span> := <span class="id" title="var">print_spatial_model2</span> <span class="id" title="var">c</span> (<span class="id" title="var">norm</span> <span class="id" title="var">selected</span> <span class="id" title="var">nc'</span>) <span class="id" title="var">R</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pcns_u</span> := <span class="id" title="var">pures</span> (<span class="id" title="var">unfolding</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s_star'</span> := <span class="id" title="var">incorp</span> (<span class="id" title="var">print_unfold_set</span> <span class="id" title="var">pcns_u</span>) <span class="id" title="var">nu_s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">isEq</span> (<span class="id" title="var">M.compare</span> <span class="id" title="var">nu_s</span> <span class="id" title="var">s_star'</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">C_example</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">the_loop</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>) <span class="id" title="var">sigma'</span> <span class="id" title="var">nc'</span> <span class="id" title="var">s_star'</span> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">C_example</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">the_loop</span> (<span class="id" title="var">Ppred</span> <span class="id" title="var">n</span>) <span class="id" title="var">sigma'</span> <span class="id" title="var">nc'</span> <span class="id" title="var">nu_s</span> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">Superposition.Aborted</span> <span class="id" title="var">l</span>, <span class="id" title="var">units</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>) ⇒ <span class="id" title="var">Aborted</span> <span class="id" title="var">l</span> <span class="id" title="var">cl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">falsity</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eq_sym</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">check_entailment</span> (<span class="id" title="var">ent</span>: <span class="id" title="var">entailment</span>) : <span class="id" title="var">veristar_result</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="var">clause_list2set</span> (<span class="id" title="var">pure_clauses</span> (<span class="id" title="var">map</span> <span class="id" title="var">order_eqv_clause</span> (<span class="id" title="var">cnf</span> <span class="id" title="var">ent</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="keyword">match</span> <span class="id" title="var">ent</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Entailment</span> (<span class="id" title="var">Assertion</span> <span class="id" title="var">pi</span> <span class="id" title="var">sigma</span>) (<span class="id" title="var">Assertion</span> <span class="id" title="var">pi'</span> <span class="id" title="var">sigma'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mk_pureR</span> <span class="id" title="var">pi</span>, <span class="id" title="var">mk_pureR</span> <span class="id" title="var">pi'</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">piplus</span>, <span class="id" title="var">piminus</span>), (<span class="id" title="var">pi'plus</span>, <span class="id" title="var">pi'minus</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">the_loop</span> 1000000000 <span class="id" title="var">sigma</span> (<span class="id" title="var">NegSpaceClause</span> <span class="id" title="var">pi'plus</span> <span class="id" title="var">sigma'</span> <span class="id" title="var">pi'minus</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">print_new_pures_set</span> <span class="id" title="var">s</span>) <span class="id" title="var">empty_clause</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">VeriStar</span>.<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">VeriStar.check_entailment</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">VeriStar</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">a</span> := <span class="id" title="var">Var</span> 1%<span class="id" title="var">positive</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">b</span> := <span class="id" title="var">Var</span> 2%<span class="id" title="var">positive</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">c</span> := <span class="id" title="var">Var</span> 3%<span class="id" title="var">positive</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">d</span> := <span class="id" title="var">Var</span> 4%<span class="id" title="var">positive</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">e</span> := <span class="id" title="var">Var</span> 5%<span class="id" title="var">positive</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example_ent</span> : <span class="id" title="var">entailment</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Nequ</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span>] [<span class="id" title="var">Lseg</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ; <span class="id" title="var">Lseg</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> ; <span class="id" title="keyword">Next</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> ; <span class="id" title="var">Lseg</span> <span class="id" title="var">d</span> <span class="id" title="var">e</span>])<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> <span class="id" title="var">nil</span> [<span class="id" title="var">Lseg</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> ; <span class="id" title="var">Lseg</span> <span class="id" title="var">c</span> <span class="id" title="var">e</span>]).<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">positive_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">x</span> (<span class="id" title="var">p</span> : <span class="id" title="var">positive</span>) := <span class="id" title="var">Var</span> <span class="id" title="var">p</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">harder_ent</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Entailment</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 9) (<span class="id" title="var">x</span> 3);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 7) (<span class="id" title="var">x</span> 8);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 1) (<span class="id" title="var">x</span> 6);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 2);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 3) (<span class="id" title="var">x</span> 7);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 5) (<span class="id" title="var">x</span> 10);    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 4) (<span class="id" title="var">x</span> 9);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 13) (<span class="id" title="var">x</span> 5);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 8) (<span class="id" title="var">x</span> 5); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 11) (<span class="id" title="var">x</span> 12);   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 12) (<span class="id" title="var">x</span> 11);   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 2) (<span class="id" title="var">x</span> 4); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 6) (<span class="id" title="var">x</span> 3)])   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 2) (<span class="id" title="var">x</span> 10);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 12) (<span class="id" title="var">x</span> 11);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 11) (<span class="id" title="var">x</span> 12);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 6) (<span class="id" title="var">x</span> 3);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 1) (<span class="id" title="var">x</span> 6);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 13) (<span class="id" title="var">x</span> 5);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 2)]).<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">harder_ent2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Entailment</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 2) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 3) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 5); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 4) (<span class="id" title="var">x</span> 20); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 16) (<span class="id" title="var">x</span> 11);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 6) (<span class="id" title="var">x</span> 14); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 20) (<span class="id" title="var">x</span> 11); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 17) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 19) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 11) (<span class="id" title="var">x</span> 1);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 15) (<span class="id" title="var">x</span> 13); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 1) (<span class="id" title="var">x</span> 17); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 5) (<span class="id" title="var">x</span> 18); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 8) (<span class="id" title="var">x</span> 5); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 7) (<span class="id" title="var">x</span> 13); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 14) (<span class="id" title="var">x</span> 2);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 18) (<span class="id" title="var">x</span> 6); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 12) (<span class="id" title="var">x</span> 17); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 13) (<span class="id" title="var">x</span> 8); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 9) (<span class="id" title="var">x</span> 10)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 15) (<span class="id" title="var">x</span> 2); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 4) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 19) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 5); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 7) (<span class="id" title="var">x</span> 13);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 2) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 16) (<span class="id" title="var">x</span> 11); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 3) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 12) (<span class="id" title="var">x</span> 17); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 9) (<span class="id" title="var">x</span> 10)]).<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">harder_ent3</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Entailment</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 1) (<span class="id" title="var">x</span> 14); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 14) (<span class="id" title="var">x</span> 19); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 5) (<span class="id" title="var">x</span> 8); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 13) (<span class="id" title="var">x</span> 18); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 18) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 15) (<span class="id" title="var">x</span> 2);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 17) (<span class="id" title="var">x</span> 15); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 20) (<span class="id" title="var">x</span> 6); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 6) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 11) (<span class="id" title="var">x</span> 19); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 7) (<span class="id" title="var">x</span> 12); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 17);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 16) (<span class="id" title="var">x</span> 20); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 2) (<span class="id" title="var">x</span> 20); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 19) (<span class="id" title="var">x</span> 4); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 9) (<span class="id" title="var">x</span> 3); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 8) (<span class="id" title="var">x</span> 12); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 12) (<span class="id" title="var">x</span> 20); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 4) (<span class="id" title="var">x</span> 6); <span class="id" title="keyword">Next</span> (<span class="id" title="var">x</span> 3) (<span class="id" title="var">x</span> 20)])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Assertion</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 6) (<span class="id" title="var">x</span> 18); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 4) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 7) (<span class="id" title="var">x</span> 6); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 1) (<span class="id" title="var">x</span> 4);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 11) (<span class="id" title="var">x</span> 19); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 18) (<span class="id" title="var">x</span> 13); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 16) (<span class="id" title="var">x</span> 20); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 10) (<span class="id" title="var">x</span> 20); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 5) (<span class="id" title="var">x</span> 12);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 3) (<span class="id" title="var">x</span> 20); <span class="id" title="var">Lseg</span> (<span class="id" title="var">x</span> 9) (<span class="id" title="var">x</span> 3)]).<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example_myent</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span>] <span class="id" title="var">nil</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example_myent</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example_myent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example1_myent</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span>] <span class="id" title="var">nil</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example1_myent</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example1_myent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example2_myent</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>; <span class="id" title="var">Equ</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>] <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span>] <span class="id" title="var">nil</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example2_myent</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example2_myent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example1_myfail</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">nil</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example1_myfail</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example1_myfail</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">example2_myfail</span> := <span class="id" title="var">Entailment</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>] <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Assertion</span> [<span class="id" title="var">Equ</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">nil</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example2_myfail</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example2_myfail</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_example_ent</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">example_ent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">myMain</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> <span class="id" title="var">check_entailment</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">example_myent</span>; <span class="id" title="var">example1_myent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">example2_myent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">example1_myfail</span>; <span class="id" title="var">example1_myfail</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">example_ent</span>; <span class="id" title="var">harder_ent</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">harder_ent2</span>; <span class="id" title="var">harder_ent3</span>].<br/>
<span class="id" title="keyword">Extraction</span> "myMain" <span class="id" title="var">myMain</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_harder_ent</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">harder_ent</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_harder_ent2</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">harder_ent</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ce_harder_ent3</span> := <span class="id" title="var">check_entailment</span> <span class="id" title="var">harder_ent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">main_h</span> (<span class="id" title="var">u</span> : <span class="id" title="var">unit</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">check_entailment</span> <span class="id" title="var">harder_ent</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">main</span> (<span class="id" title="var">u</span> : <span class="id" title="var">unit</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">check_entailment</span> <span class="id" title="var">example_ent</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Extraction</span> "vs" <span class="id" title="var">main</span>.<br/>

<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
