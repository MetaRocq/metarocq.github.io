<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.Erasure.EGlobalFragment</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">utils</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">config</span> <span class="id" title="var">Kernames</span> <span class="id" title="var">uGraph</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">EGlobalEnv</span> <span class="id" title="var">ErasureFunction</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">EAstUtils</span> <span class="id" title="var">EArities</span> <span class="id" title="keyword">Extract</span> <span class="id" title="var">Prelim</span> <span class="id" title="var">EDeps</span> <span class="id" title="var">ErasureProperties</span> <span class="id" title="var">ErasureCorrectness</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.SafeChecker</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PCUICErrors</span> <span class="id" title="var">PCUICWfEnv</span> <span class="id" title="var">PCUICSafeReduce</span> <span class="id" title="var">PCUICSafeRetyping</span> <span class="id" title="var">PCUICRetypingEnvIrrelevance</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PCUICAst</span> <span class="id" title="var">PCUICAstUtils</span> <span class="id" title="var">PCUICPrimitive</span><br/>
&nbsp;&nbsp;<span class="id" title="var">PCUICReduction</span> <span class="id" title="var">PCUICReflect</span> <span class="id" title="var">PCUICWeakeningEnv</span> <span class="id" title="var">PCUICWeakeningEnvTyp</span> <span class="id" title="var">PCUICCasesContexts</span><br/>
&nbsp;&nbsp;<span class="id" title="var">PCUICWeakeningConv</span> <span class="id" title="var">PCUICWeakeningTyp</span> <span class="id" title="var">PCUICContextConversionTyp</span> <span class="id" title="var">PCUICTyping</span> <span class="id" title="var">PCUICGlobalEnv</span> <span class="id" title="var">PCUICInversion</span> <span class="id" title="var">PCUICGeneration</span><br/>
&nbsp;&nbsp;<span class="id" title="var">PCUICConfluence</span> <span class="id" title="var">PCUICConversion</span> <span class="id" title="var">PCUICUnivSubstitutionTyp</span> <span class="id" title="var">PCUICCumulativity</span> <span class="id" title="var">PCUICSR</span> <span class="id" title="var">PCUICSafeLemmata</span> <span class="id" title="var">PCUICNormalization</span><br/>
&nbsp;&nbsp;<span class="id" title="var">PCUICValidity</span> <span class="id" title="var">PCUICPrincipality</span> <span class="id" title="var">PCUICElimination</span> <span class="id" title="var">PCUICOnFreeVars</span> <span class="id" title="var">PCUICWellScopedCumulativity</span> <span class="id" title="var">PCUICSN</span> <span class="id" title="var">PCUICEtaExpand</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Σ&nbsp;is&nbsp;a&nbsp;fragment&nbsp;of&nbsp;Σ'&nbsp;if&nbsp;every&nbsp;lookup&nbsp;in&nbsp;Σ&nbsp;gives&nbsp;the&nbsp;same&nbsp;result&nbsp;as&nbsp;Σ'&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eglobal_env_fragment</span> <span class="id" title="var">Σ</span> <span class="id" title="var">Σ'</span> :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">kn</span> <span class="id" title="var">decl</span>, <span class="id" title="var">lookup_env</span> <span class="id" title="var">Σ</span> <span class="id" title="var">kn</span> = <span class="id" title="var">Some</span> <span class="id" title="var">decl</span> → <span class="id" title="var">lookup_env</span> <span class="id" title="var">Σ'</span> <span class="id" title="var">kn</span> = <span class="id" title="var">Some</span> <span class="id" title="var">decl</span>).<br/>

<br/>
<span class="comment">(*&nbsp;we&nbsp;use&nbsp;the&nbsp;<span class="inlinecode"><span class="id" title="keyword">match</span></span>&nbsp;trick&nbsp;to&nbsp;get&nbsp;typeclass&nbsp;resolution&nbsp;to&nbsp;pick&nbsp;up&nbsp;the&nbsp;right&nbsp;instances&nbsp;without&nbsp;leaving&nbsp;any&nbsp;evidence&nbsp;in&nbsp;the&nbsp;resulting&nbsp;term,&nbsp;and&nbsp;without&nbsp;having&nbsp;to&nbsp;pass&nbsp;them&nbsp;manually&nbsp;everywhere&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">NormalizationIn_erase_global_decls</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span><br/>
&nbsp;&nbsp;:= (<span class="id" title="keyword">match</span> <span class="id" title="var">extraction_checker_flags</span>, <span class="id" title="var">extraction_normalizing</span> <span class="id" title="keyword">return</span> <span class="id" title="var">_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">cf</span>, <span class="id" title="keyword">no</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> &lt; <span class="id" title="var">List.length</span> <span class="id" title="var">decls</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X'</span> := <span class="id" title="var">iter</span> <span class="id" title="var">abstract_pop_decls</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">X</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">kn</span> <span class="id" title="var">cb</span> <span class="id" title="var">pf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.hd_error</span> (<span class="id" title="var">List.skipn</span> <span class="id" title="var">n</span> <span class="id" title="var">decls</span>) = <span class="id" title="var">Some</span> (<span class="id" title="var">kn</span>, <span class="id" title="var">ConstantDecl</span> <span class="id" title="var">cb</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Xext</span> := <span class="id" title="var">abstract_make_wf_env_ext</span> <span class="id" title="var">X'</span> (<span class="id" title="var">cst_universes</span> <span class="id" title="var">cb</span>) <span class="id" title="var">pf</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span>, <span class="id" title="var">wf_ext</span> <span class="id" title="var">Σ</span> → <span class="id" title="var">Σ</span> ∼<span class="id" title="var">_ext</span> <span class="id" title="var">Xext</span> → <span class="id" title="var">NormalizationIn</span> <span class="id" title="var">Σ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">erase_global</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">X_type</span> : <span class="id" title="var">abstract_env_impl</span>} (<span class="id" title="var">X</span> : <span class="id" title="var">X_type</span>.π1) (<span class="id" title="var">decls</span> : <span class="id" title="var">global_declarations</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">normalization_in</span> : <span class="id" title="var">NormalizationIn_erase_global_decls</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">prop</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">decls</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">E.global_declarations</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">decls</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [] ⇒ []<br/>
&nbsp;&nbsp;| (<span class="id" title="var">kn</span>, <span class="id" title="var">ConstantDecl</span> <span class="id" title="var">cb</span>) :: <span class="id" title="var">decls</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X'</span> := <span class="id" title="var">abstract_pop_decls</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Xext</span> := <span class="id" title="var">abstract_make_wf_env_ext</span> <span class="id" title="var">X'</span> (<span class="id" title="var">cst_universes</span> <span class="id" title="var">cb</span>) <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">normalization_in'</span> : @<span class="id" title="var">id</span> <span class="id" title="keyword">Prop</span> <span class="id" title="var">_</span> := <span class="id" title="var">_</span> <span class="id" title="tactic">in</span> <span class="comment">(*&nbsp;hack&nbsp;to&nbsp;avoid&nbsp;program&nbsp;erroring&nbsp;out&nbsp;on&nbsp;unresolved&nbsp;tc&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cb'</span> := @<span class="id" title="var">erase_constant_body</span> <span class="id" title="var">X_type</span> <span class="id" title="var">Xext</span> <span class="id" title="var">normalization_in'</span> <span class="id" title="var">cb</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X''</span> := <span class="id" title="var">erase_global</span> <span class="id" title="var">X'</span> <span class="id" title="var">decls</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">kn</span>, <span class="id" title="var">E.ConstantDecl</span> (<span class="id" title="var">fst</span> <span class="id" title="var">cb'</span>)) :: <span class="id" title="var">X''</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">kn</span>, <span class="id" title="var">InductiveDecl</span> <span class="id" title="var">mib</span>) :: <span class="id" title="var">decls</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X'</span> := <span class="id" title="var">abstract_pop_decls</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">mib'</span> := <span class="id" title="var">erase_mutual_inductive_body</span> <span class="id" title="var">mib</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X''</span> := <span class="id" title="var">erase_global</span> <span class="id" title="var">X'</span> <span class="id" title="var">decls</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">kn</span>, <span class="id" title="var">E.InductiveDecl</span> <span class="id" title="var">mib'</span>) :: <span class="id" title="var">X''</span>)<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> [<span class="id" title="keyword">wf</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wfX</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> [? []].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">prop</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>, <span class="id" title="var">Σ</span>, <span class="id" title="var">H0</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">sq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfX</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">o0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">o1</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cbv</span> [<span class="id" title="var">id</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">normalization_in</span> 0); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_ext_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> [<span class="id" title="keyword">wf</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> (<span class="id" title="var">abstract_pop_decls</span> <span class="id" title="var">X</span>)) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX'</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">HX'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wfX'</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wfX</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">HX'</span>) <span class="id" title="keyword">as</span> [? []].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_make_wf_env_ext_correct</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX'</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span> <span class="id" title="var">HX'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">prop</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>, <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [[] <span class="id" title="var">u</span>], <span class="id" title="var">H0</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">sq</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfX</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">prop</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o0</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">o0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">o1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">on_global_decl_d</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">normalization_in</span> (<span class="id" title="var">S</span> <span class="id" title="var">_</span>)); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">revgoals</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">normalization_in</span> (<span class="id" title="var">S</span> <span class="id" title="var">_</span>)); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">revgoals</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
<span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">normalization_in</span> (<span class="id" title="var">S</span> <span class="id" title="var">_</span>)); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">revgoals</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="var">normalization_in</span> (<span class="id" title="var">S</span> <span class="id" title="var">_</span>)); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">revgoals</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_env_exists</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">HX</span>]].<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">prop'</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="tactic">∃</span> <span class="id" title="var">d</span>, <span class="id" title="var">Σ</span>.(<span class="id" title="var">declarations</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">decls</span>).<br/>
{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
<span class="id" title="var">now</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">abstract_pop_decls_correct</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HX</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">erase_global_fast_fragment</span><br/>
&nbsp;&nbsp;<span class="id" title="var">X_type</span> <span class="id" title="var">deps</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> {<span class="id" title="var">normalization_in</span>} (<span class="id" title="var">prf</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">Σ</span> : <span class="id" title="var">global_env</span>, <span class="id" title="var">abstract_env_rel</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ</span> → <span class="id" title="var">declarations</span> <span class="id" title="var">Σ</span> = <span class="id" title="var">decls</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">eglobal_env_fragment</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">ErasureFunction.erase_global_fast</span> <span class="id" title="var">X_type</span> <span class="id" title="var">deps</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">normalization_in</span> <span class="id" title="var">prf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">E</span>)<br/>
<br/>
<br/>
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">erase_program_fst</span> {<span class="id" title="var">guard</span> : <span class="id" title="var">abstract_guard_impl</span>} (<span class="id" title="var">p</span> <span class="id" title="var">p'</span> : <span class="id" title="var">pcuic_program</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">normalization_in</span> : <span class="id" title="var">PCUICTyping.wf_ext</span> <span class="id" title="var">p</span>.1 → <span class="id" title="var">PCUICSN.NormalizationIn</span> <span class="id" title="var">p</span>.1}<br/>
&nbsp;&nbsp;{<span class="id" title="var">normalization_in'</span> : <span class="id" title="var">PCUICTyping.wf_ext</span> <span class="id" title="var">p'</span>.1 → <span class="id" title="var">PCUICSN.NormalizationIn</span> <span class="id" title="var">p'</span>.1}<br/>
{<span class="id" title="var">normalization_in_adjust_universes</span> : <span class="id" title="var">PCUICTyping.wf_ext</span> <span class="id" title="var">p</span>.1 →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PCUICWeakeningEnvSN.normalizationInAdjustUniversesIn</span> <span class="id" title="var">p</span>.1}<br/>
{<span class="id" title="var">normalization_in_adjust_universes'</span> : <span class="id" title="var">PCUICTyping.wf_ext</span> <span class="id" title="var">p'</span>.1 →<br/>
<span class="id" title="var">PCUICWeakeningEnvSN.normalizationInAdjustUniversesIn</span><br/>
&nbsp;&nbsp;<span class="id" title="var">p'</span>.1} <span class="id" title="var">wt</span> <span class="id" title="var">wt'</span> :<br/>
<span class="id" title="var">p</span>.1 = <span class="id" title="var">p'</span>.1 →<br/>
(<span class="id" title="var">erase_program</span> <span class="id" title="var">p</span> <span class="id" title="var">wt</span>).1 = (<span class="id" title="var">erase_program</span> <span class="id" title="var">p'</span> <span class="id" title="var">wt'</span>).1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>, <span class="id" title="var">p'</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">g0</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">erase_program</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">map_squash</span> <span class="id" title="var">fst</span> <span class="id" title="var">wt</span> = <span class="id" title="var">map_squash</span> <span class="id" title="var">fst</span> <span class="id" title="var">wt'</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">proof_irrelevance</span>.<br/>
<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">H</span>. <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> <span class="id" title="var">ErasureFunction.erase_irrel_global_env</span>.<br/>
<span class="id" title="var">Abort.Lemma</span> <span class="id" title="var">erase_global_fragment</span> <span class="id" title="var">Σ</span><br/>
<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
