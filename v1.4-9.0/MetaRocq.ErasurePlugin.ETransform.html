<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.ErasurePlugin.ETransform</h1>

<div class="code">
<span class="comment">(*&nbsp;Distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;MIT&nbsp;license.&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Program</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">ssrbool</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Equations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.Environment.html#"><span class="id" title="library">Environment</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#"><span class="id" title="library">Transform</span></a> <a class="idref" href="MetaRocq.Common.config.html#"><span class="id" title="library">config</span></a> <a class="idref" href="MetaRocq.Common.BasicAst.html#"><span class="id" title="library">BasicAst</span></a> <a class="idref" href="MetaRocq.Common.uGraph.html#"><span class="id" title="library">uGraph</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Template</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaRocq.Template.Pretty.html#"><span class="id" title="library">Pretty</span></a> <a class="idref" href="MetaRocq.Template.Typing.html#"><span class="id" title="library">Typing</span></a> <a class="idref" href="MetaRocq.Template.WcbvEval.html#"><span class="id" title="library">WcbvEval</span></a> <a class="idref" href="MetaRocq.Template.EtaExpand.html#"><span class="id" title="library">EtaExpand</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="library">PCUICAst</span></a> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#"><span class="id" title="library">PCUICAstUtils</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#"><span class="id" title="library">PCUICProgram</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICWeakeningEnvSN.html#"><span class="id" title="library">PCUICWeakeningEnvSN</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "+notation-overridden".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.SafeChecker</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#"><span class="id" title="library">PCUICErrors</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#"><span class="id" title="library">PCUICWfEnv</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#"><span class="id" title="library">PCUICWfEnvImpl</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#"><span class="id" title="library">EAstUtils</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#"><span class="id" title="library">ErasureCorrectness</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#"><span class="id" title="library">Extract</span></a> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#"><span class="id" title="library">EOptimizePropDiscr</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#"><span class="id" title="library">ERemoveParams</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#"><span class="id" title="library">EProgram</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#"><span class="id" title="library">ErasureFunction</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#"><span class="id" title="library">ErasureFunctionProperties</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.TemplatePCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#"><span class="id" title="library">PCUICTransform</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="module">PCUICAst</span></a> (<span class="id" title="var">term</span>) <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#"><span class="id" title="module">PCUICProgram</span></a> <a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#"><span class="id" title="module">PCUICTransform</span></a> (<span class="id" title="var">eval_pcuic_program</span>) <a class="idref" href="MetaRocq.Erasure.Extract.html#"><span class="id" title="module">Extract</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#"><span class="id" title="module">EProgram</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#"><span class="id" title="module">EAst</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform"><span class="id" title="module">Transform</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#"><span class="id" title="module">ERemoveParams</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EEnvMap.html#"><span class="id" title="module">EEnvMap</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#"><span class="id" title="module">EGlobalEnv</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#"><span class="id" title="module">EWellformed</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_wf_env_from_env" class="idref" href="#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> {<a id="cf:1" class="idref" href="#cf:1"><span class="id" title="binder">cf</span></a> : <a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} (<a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#global_env_map"><span class="id" title="record">global_env_map</span></a>) (<a id="9c77acedd153c05882e0fedfeff8f884" class="idref" href="#9c77acedd153c05882e0fedfeff8f884"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">PCUICTyping.wf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env"><span class="id" title="record">wf_env</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_reference"><span class="id" title="projection">wf_env_reference</span></a> := {| <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#trans_env_env"><span class="id" title="projection">trans_env_env</span></a>); <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_wf"><span class="id" title="projection">reference_impl_wf</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#9c77acedd153c05882e0fedfeff8f884"><span class="id" title="variable">wfΣ</span></a> |} ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_map"><span class="id" title="projection">wf_env_map</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#trans_env_map"><span class="id" title="projection">trans_env_map</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_map_repr"><span class="id" title="projection">wf_env_map_repr</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#trans_env_repr"><span class="id" title="projection">trans_env_repr</span></a>);<br/>
&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="NormalizationIn_erase_pcuic_program_1" class="idref" href="#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;:= (@<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a> <span class="id" title="var">p</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> (<span class="id" title="var">cf</span>:=<a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) (<span class="id" title="keyword">no</span>:=<a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#extraction_normalizing"><span class="id" title="instance">PCUICSN.extraction_normalizing</span></a>) <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="NormalizationIn_erase_pcuic_program_2" class="idref" href="#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;:= (@<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a> <span class="id" title="var">p</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICWeakeningEnvSN.html#normalizationInAdjustUniversesIn"><span class="id" title="class">PCUICWeakeningEnvSN.normalizationInAdjustUniversesIn</span></a> (<span class="id" title="var">cf</span>:=<a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) (<span class="id" title="keyword">no</span>:=<a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#extraction_normalizing"><span class="id" title="instance">PCUICSN.extraction_normalizing</span></a>) <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;Where&nbsp;should&nbsp;this&nbsp;go?&nbsp;*)</span><br/>
#[<span class="id" title="var">local</span>]<br/>
<span class="id" title="keyword">Lemma</span> <a id="reference_impl_env_iter_pop_eq'" class="idref" href="#reference_impl_env_iter_pop_eq'"><span class="id" title="lemma">reference_impl_env_iter_pop_eq'</span></a><br/>
&nbsp;&nbsp;(<a id="cf:4" class="idref" href="#cf:4"><span class="id" title="binder">cf</span></a> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>)<br/>
&nbsp;&nbsp;(<a id="no:5" class="idref" href="#no:5"><span class="id" title="binder">no</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#extraction_normalizing"><span class="id" title="instance">PCUICSN.extraction_normalizing</span></a>)<br/>
&nbsp;&nbsp;{<a id="guard:6" class="idref" href="#guard:6"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>}<br/>
&nbsp;&nbsp;(<a id="wfe:7" class="idref" href="#wfe:7"><span class="id" title="binder">wfe</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env"><span class="id" title="record">wf_env</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:8" class="idref" href="#n:8"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="X':9" class="idref" href="#X':9"><span class="id" title="binder">X'</span></a> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#iter"><span class="id" title="definition">ErasureFunction.iter</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls"><span class="id" title="method">abstract_pop_decls</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:8"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:7"><span class="id" title="variable">wfe</span></a>)<br/>
&nbsp;&nbsp;(<a id="wfe':10" class="idref" href="#wfe':10"><span class="id" title="binder">wfe'</span></a> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#iter"><span class="id" title="definition">ErasureFunction.iter</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_pop"><span class="id" title="definition">reference_pop</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:8"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:7"><span class="id" title="variable">wfe</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X':9"><span class="id" title="variable">X'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe':10"><span class="id" title="variable">wfe'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">X'</span> <span class="id" title="var">wfe'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">wfe</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfe</span> <span class="id" title="keyword">as</span> [[[? [|[]]]]]; <span class="id" title="tactic">cbv</span> [<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optim_pop"><span class="id" title="definition">optim_pop</span></a>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>]<br/>
<span class="id" title="keyword">Lemma</span> <a id="reference_impl_env_iter_pop_eq" class="idref" href="#reference_impl_env_iter_pop_eq"><span class="id" title="lemma">reference_impl_env_iter_pop_eq</span></a><br/>
&nbsp;&nbsp;(<a id="cf:11" class="idref" href="#cf:11"><span class="id" title="binder">cf</span></a> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>)<br/>
&nbsp;&nbsp;(<a id="no:12" class="idref" href="#no:12"><span class="id" title="binder">no</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#extraction_normalizing"><span class="id" title="instance">PCUICSN.extraction_normalizing</span></a>)<br/>
&nbsp;&nbsp;{<a id="guard:13" class="idref" href="#guard:13"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>}<br/>
&nbsp;&nbsp;(<a id="wfe:14" class="idref" href="#wfe:14"><span class="id" title="binder">wfe</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env"><span class="id" title="record">wf_env</span></a>)<br/>
&nbsp;&nbsp;(<a id="n:15" class="idref" href="#n:15"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="X':16" class="idref" href="#X':16"><span class="id" title="binder">X'</span></a> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#iter"><span class="id" title="definition">ErasureFunction.iter</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls"><span class="id" title="method">abstract_pop_decls</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:15"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:14"><span class="id" title="variable">wfe</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X':16"><span class="id" title="variable">X'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">PCUICAst.PCUICEnvironment.universes</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">PCUICAst.PCUICEnvironment.universes</span></a> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:14"><span class="id" title="variable">wfe</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:15"><span class="id" title="variable">n</span></a>) (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:14"><span class="id" title="variable">wfe</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">PCUICAst.PCUICEnvironment.retroknowledge</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">PCUICAst.PCUICEnvironment.retroknowledge</span></a> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env"><span class="id" title="projection">reference_impl_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:14"><span class="id" title="variable">wfe</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">X'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">wfe</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfe</span> <span class="id" title="keyword">as</span> [[[? [|[]]]]]; <span class="id" title="tactic">cbv</span> [<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optim_pop"><span class="id" title="definition">optim_pop</span></a>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Lemma</span> <a id="erase_pcuic_program_normalization_helper" class="idref" href="#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a><br/>
&nbsp;&nbsp;(<a id="cf:17" class="idref" href="#cf:17"><span class="id" title="binder">cf</span></a> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) (<a id="no:18" class="idref" href="#no:18"><span class="id" title="binder">no</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#extraction_normalizing"><span class="id" title="instance">PCUICSN.extraction_normalizing</span></a>)<br/>
&nbsp;&nbsp;{<a id="guard:19" class="idref" href="#guard:19"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} (<a id="p:20" class="idref" href="#p:20"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#global_env_ext_map"><span class="id" title="definition">global_env_ext_map</span></a>)<br/>
&nbsp;&nbsp;{<a id="normalization_in:21" class="idref" href="#normalization_in:21"><span class="id" title="binder">normalization_in</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a>}<br/>
&nbsp;&nbsp;{<a id="normalization_in_adjust_universes:22" class="idref" href="#normalization_in_adjust_universes:22"><span class="id" title="binder">normalization_in_adjust_universes</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a>}<br/>
&nbsp;&nbsp;(<a id="cf08c5ced949193fdc5dcea4b35ea32e" class="idref" href="#cf08c5ced949193fdc5dcea4b35ea32e"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> (<span class="id" title="var">H</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> <a id="wfe:24" class="idref" href="#wfe:24"><span class="id" title="binder">wfe</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">PCUICTyping.wf_ext_wf</span></a> <span class="id" title="var">_</span>) (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf08c5ced949193fdc5dcea4b35ea32e"><span class="id" title="variable">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> (<span class="id" title="var">H</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="n:25" class="idref" href="#n:25"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:25"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">∀</span> <a id="kn:26" class="idref" href="#kn:26"><span class="id" title="binder">kn</span></a> <a id="cb:27" class="idref" href="#cb:27"><span class="id" title="binder">cb</span></a> <a id="pf:28" class="idref" href="#pf:28"><span class="id" title="binder">pf</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">hd_error</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:25"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:26"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.ConstantDecl"><span class="id" title="constructor">PCUICAst.PCUICEnvironment.ConstantDecl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cb:27"><span class="id" title="variable">cb</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="b45015ea779d7a6908b541de791ac941" class="idref" href="#b45015ea779d7a6908b541de791ac941"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">PCUICAst.PCUICEnvironment.global_env_ext</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b45015ea779d7a6908b541de791ac941"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b45015ea779d7a6908b541de791ac941"><span class="id" title="variable">Σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> @<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a> <span class="id" title="var">_</span>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:24"><span class="id" title="variable">wfe</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.cst_universes"><span class="id" title="projection">PCUICAst.PCUICEnvironment.cst_universes</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cb:27"><span class="id" title="variable">cb</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pf:28"><span class="id" title="variable">pf</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b45015ea779d7a6908b541de791ac941"><span class="id" title="variable">Σ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> <a id="wfe:30" class="idref" href="#wfe:30"><span class="id" title="binder">wfe</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">PCUICTyping.wf_ext_wf</span></a> <span class="id" title="var">_</span>) (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf08c5ced949193fdc5dcea4b35ea32e"><span class="id" title="variable">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> (<span class="id" title="var">H</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="n:31" class="idref" href="#n:31"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:31"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">let</span> <a id="X':32" class="idref" href="#X':32"><span class="id" title="binder">X'</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#iter"><span class="id" title="definition">ErasureFunction.iter</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls"><span class="id" title="method">abstract_pop_decls</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:31"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:30"><span class="id" title="variable">wfe</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="kn:33" class="idref" href="#kn:33"><span class="id" title="binder">kn</span></a> <a id="cb:34" class="idref" href="#cb:34"><span class="id" title="binder">cb</span></a> <a id="pf:35" class="idref" href="#pf:35"><span class="id" title="binder">pf</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">hd_error</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#n:31"><span class="id" title="variable">n</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:20"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:33"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.ConstantDecl"><span class="id" title="constructor">PCUICAst.PCUICEnvironment.ConstantDecl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cb:34"><span class="id" title="variable">cb</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="Xext:36" class="idref" href="#Xext:36"><span class="id" title="binder">Xext</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a> <span class="id" title="var">_</span>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X':32"><span class="id" title="variable">X'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.cst_universes"><span class="id" title="projection">PCUICAst.PCUICEnvironment.cst_universes</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cb:34"><span class="id" title="variable">cb</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pf:35"><span class="id" title="variable">pf</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="01696af10e39986da2e9d1f22eb04999" class="idref" href="#01696af10e39986da2e9d1f22eb04999"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">PCUICAst.PCUICEnvironment.global_env_ext</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#01696af10e39986da2e9d1f22eb04999"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#01696af10e39986da2e9d1f22eb04999"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#Xext:36"><span class="id" title="variable">Xext</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#01696af10e39986da2e9d1f22eb04999"><span class="id" title="variable">Σ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- ?<span class="id" title="var">A</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> ?<span class="id" title="var">B</span> ⇒ <span class="id" title="tactic">cut</span> (<span class="id" title="var">A</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="var">A</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">B</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>); [ <span class="id" title="tactic">tauto</span> | ] <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cbv</span> <span class="id" title="keyword">beta</span> <span class="id" title="keyword">zeta</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="keyword">∀</span> <a id="x:38" class="idref" href="#x:38"><span class="id" title="binder"><span id="x:39" class="id">x</span></span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#x:38"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#squash"><span class="id" title="record">squash</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : ?<span class="id" title="var">A</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> ?<span class="id" title="var">B</span>, <span class="id" title="var">H'</span> : ?<span class="id" title="var">A</span> |- <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">H'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> ?]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="var">revert</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">normalization_in_adjust_universes</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cbv</span> [<a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="var">H</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">PCUICAst.PCUICEnvironment.lookup_env</span></a> -<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_global_Some_iff_In_NoDup"><span class="id" title="lemma">PCUICAst.PCUICEnvironment.lookup_global_Some_iff_In_NoDup</span></a> -?<a class="idref" href="MetaRocq.Utils.MRList.html#hd_error_skipn_iff_In"><span class="id" title="lemma">hd_error_skipn_iff_In</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#NoDup_on_global_decls"><span class="id" title="lemma">PCUICAst.NoDup_on_global_decls</span></a>, <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">eexists</span>; <span class="id" title="var">eassumption</span> ]. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> ?]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="var">revert</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span> ⇒ <span class="id" title="var">normalization_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reference_impl_env_iter_pop_eq"><span class="id" title="lemma">reference_impl_env_iter_pop_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reference_impl_env_iter_pop_eq"><span class="id" title="lemma">reference_impl_env_iter_pop_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">normalization_in_adjust_universes</span> <span class="id" title="tactic">in</span> <span class="id" title="var">normalization_in</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">revgoals</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">eassumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="var">multimatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="var">H</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">PCUICAst.PCUICEnvironment.lookup_env</span></a> -<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_global_Some_iff_In_NoDup"><span class="id" title="lemma">PCUICAst.PCUICEnvironment.lookup_global_Some_iff_In_NoDup</span></a> -?<a class="idref" href="MetaRocq.Utils.MRList.html#hd_error_skipn_iff_In"><span class="id" title="lemma">hd_error_skipn_iff_In</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#NoDup_on_global_decls"><span class="id" title="lemma">PCUICAst.NoDup_on_global_decls</span></a>, <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">eexists</span>; <span class="id" title="var">eassumption</span> ]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">normalization_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICWeakeningEnvSN.html#weakening_env_normalization_in"><span class="id" title="lemma">PCUICWeakeningEnvSN.weakening_env_normalization_in</span></a>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">refine</span> (@<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">PCUICTyping.wf_ext_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.extends_decls_extends"><span class="id" title="instance">PCUICAst.PCUICEnvironment.extends_decls_extends</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.strictly_extends_decls_extends_decls"><span class="id" title="instance">PCUICAst.PCUICEnvironment.strictly_extends_decls_extends_decls</span></a>; <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">firstn_skipn</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">program_simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="erase_pcuic_program" class="idref" href="#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a> {<a id="guard:40" class="idref" href="#guard:40"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} (<a id="p:41" class="idref" href="#p:41"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#pcuic_program"><span class="id" title="definition">pcuic_program</span></a>)<br/>
&nbsp;&nbsp;{<a id="normalization_in:42" class="idref" href="#normalization_in:42"><span class="id" title="binder">normalization_in</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>}<br/>
&nbsp;&nbsp;{<a id="normalization_in_adjust_universes:43" class="idref" href="#normalization_in_adjust_universes:43"><span class="id" title="binder">normalization_in_adjust_universes</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>}<br/>
&nbsp;&nbsp;(<a id="6e94498633c235c1fbcc9b543d023c7e" class="idref" href="#6e94498633c235c1fbcc9b543d023c7e"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> (<span class="id" title="var">H</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;(<a id="wt:46" class="idref" href="#wt:46"><span class="id" title="binder">wt</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="T:45" class="idref" href="#T:45"><span class="id" title="binder">T</span></a><a class="idref" href="MetaRocq.Utils.MRPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#typing"><span class="id" title="inductive">PCUICTyping.typing</span></a> (<span class="id" title="var">H</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#T:45"><span class="id" title="variable">T</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram_env"><span class="id" title="definition">eprogram_env</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="wfe:47" class="idref" href="#wfe:47"><span class="id" title="binder">wfe</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">PCUICTyping.wf_ext_wf</span></a> <span class="id" title="var">_</span>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#6e94498633c235c1fbcc9b543d023c7e"><span class="id" title="variable">wfΣ</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="wfext:48" class="idref" href="#wfext:48"><span class="id" title="binder">wfext</span></a> := @<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:47"><span class="id" title="variable">wfe</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="t:52" class="idref" href="#t:52"><span class="id" title="binder">t</span></a> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">ErasureFunction.erase</span></a> (<span class="id" title="var">normalization_in</span>:=<span class="id" title="var">_</span>) <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfext:48"><span class="id" title="variable">wfext</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="bee78f44e79dd1f39e7aa3afe03ef2db" class="idref" href="#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="binder">Σ</span></a> <a id="0170232837e3524581d01df000f30bae" class="idref" href="#0170232837e3524581d01df000f30bae"><span class="id" title="binder">wfΣ</span></a> ⇒ <span class="id" title="keyword">let</span> '(<a class="idref" href="MetaRocq.Utils.MRSquash.html#sq"><span class="id" title="constructor">sq</span></a> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><span class="id" title="var">T</span><a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <span class="id" title="var">ty</span><a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">)</span></a>) := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wt:46"><span class="id" title="variable">wt</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#iswelltyped"><span class="id" title="constructor">PCUICTyping.iswelltyped</span></a> <span class="id" title="var">ty</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="8c1c1745d8246e72b40a14314bc0c42a" class="idref" href="#8c1c1745d8246e72b40a14314bc0c42a"><span class="id" title="binder">Σ'</span></a> := <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_fast"><span class="id" title="definition">ErasureFunctionProperties.erase_global_fast</span></a> (<span class="id" title="var">normalization_in</span>:=<span class="id" title="var">_</span>) <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#term_global_deps"><span class="id" title="definition">EAstUtils.term_global_deps</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:52"><span class="id" title="variable">t</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:47"><span class="id" title="variable">wfe</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:41"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a>)) <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#8c1c1745d8246e72b40a14314bc0c42a"><span class="id" title="variable">Σ'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:52"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>. <span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_glob_fresh"><span class="id" title="lemma">wf_glob_fresh</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_fast_wf_glob"><span class="id" title="lemma">ErasureFunctionProperties.erase_global_fast_wf_glob</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Local Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">idtac</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Extract.html#"><span class="id" title="module">Extract</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="erase_program" class="idref" href="#erase_program"><span class="id" title="definition">erase_program</span></a> {<a id="guard:54" class="idref" href="#guard:54"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} (<a id="p:55" class="idref" href="#p:55"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#pcuic_program"><span class="id" title="definition">pcuic_program</span></a>)<br/>
&nbsp;&nbsp;{<a id="normalization_in:56" class="idref" href="#normalization_in:56"><span class="id" title="binder">normalization_in</span></a> <a id="normalization_in_adjust_universes:57" class="idref" href="#normalization_in_adjust_universes:57"><span class="id" title="binder">normalization_in_adjust_universes</span></a>}<br/>
&nbsp;&nbsp;(<a id="wtp:58" class="idref" href="#wtp:58"><span class="id" title="binder">wtp</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#wt_pcuic_program"><span class="id" title="definition">wt_pcuic_program</span></a> (<span class="id" title="var">cf</span>:=<a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:55"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram_env"><span class="id" title="definition">eprogram_env</span></a> :=<br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guard:54"><span class="id" title="variable">guard</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:55"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#normalization_in:56"><span class="id" title="variable">normalization_in</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#normalization_in_adjust_universes:57"><span class="id" title="variable">normalization_in_adjust_universes</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wtp:58"><span class="id" title="variable">wtp</span></a>) (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wtp:58"><span class="id" title="variable">wtp</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="expanded_erase_program" class="idref" href="#expanded_erase_program"><span class="id" title="lemma">expanded_erase_program</span></a> {<a id="guard:59" class="idref" href="#guard:59"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} <a id="p:60" class="idref" href="#p:60"><span class="id" title="binder">p</span></a> {<a id="normalization_in:61" class="idref" href="#normalization_in:61"><span class="id" title="binder">normalization_in</span></a> <a id="normalization_in_adjust_universes:62" class="idref" href="#normalization_in_adjust_universes:62"><span class="id" title="binder">normalization_in_adjust_universes</span></a>} (<a id="wtp:63" class="idref" href="#wtp:63"><span class="id" title="binder">wtp</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#wt_pcuic_program"><span class="id" title="definition">wt_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:60"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_pcuic_program"><span class="id" title="definition">PCUICEtaExpand.expanded_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:60"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> (@<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guard:59"><span class="id" title="variable">guard</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:60"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#normalization_in:61"><span class="id" title="variable">normalization_in</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#normalization_in_adjust_universes:62"><span class="id" title="variable">normalization_in_adjust_universes</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wtp:63"><span class="id" title="variable">wtp</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">etaenv</span> <span class="id" title="var">etat</span>]. <span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#expanded_erase_global_fast"><span class="id" title="lemma">ErasureFunctionProperties.expanded_erase_global_fast</span></a>, <span class="id" title="var">etaenv</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#expanded_erase_fast"><span class="id" title="lemma">ErasureFunctionProperties.expanded_erase_fast</span></a> (<span class="id" title="var">X_type</span>:=<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">etat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="expanded_eprogram_env_expanded_eprogram_cstrs" class="idref" href="#expanded_eprogram_env_expanded_eprogram_cstrs"><span class="id" title="lemma">expanded_eprogram_env_expanded_eprogram_cstrs</span></a> <a id="p:64" class="idref" href="#p:64"><span class="id" title="binder">p</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:64"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:64"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ [] <span class="id" title="var">etaenv</span> <span class="id" title="var">etat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#isEtaExpFix_env_isEtaExp_env"><span class="id" title="lemma">EEtaExpanded.isEtaExpFix_env_isEtaExp_env</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env_isEtaExp_env"><span class="id" title="lemma">EEtaExpandedFix.expanded_global_env_isEtaExp_env</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#isEtaExpFix_isEtaExp"><span class="id" title="lemma">EEtaExpanded.isEtaExpFix_isEtaExp</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_isEtaExp"><span class="id" title="lemma">EEtaExpandedFix.expanded_isEtaExp</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">eauto</span> ].<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="erase_transform" class="idref" href="#erase_transform"><span class="id" title="definition">erase_transform</span></a> {<a id="guard:65" class="idref" href="#guard:65"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} : <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#term"><span class="id" title="inductive">PCUICAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#term"><span class="id" title="inductive">PCUICAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#eval_pcuic_program"><span class="id" title="definition">eval_pcuic_program</span></a> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">EWcbvEval.default_wcbv_flags</span></a>) :=<br/>
&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "erasure";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:66" class="idref" href="#p:66"><span class="id" title="binder">p</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#wt_pcuic_program"><span class="id" title="definition">wt_pcuic_program</span></a> (<span class="id" title="var">cf</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:66"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_pcuic_program"><span class="id" title="definition">PCUICEtaExpand.expanded_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:66"><span class="id" title="variable">p</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:66"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:66"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:67" class="idref" href="#p:67"><span class="id" title="binder">p</span></a> <a id="hp:68" class="idref" href="#hp:68"><span class="id" title="binder">hp</span></a> := <span class="id" title="keyword">let</span> <a id="nhs:69" class="idref" href="#nhs:69"><span class="id" title="binder">nhs</span></a> := <a class="idref" href="MetaRocq.Utils.MRProd.html#proj2"><span class="id" title="definition">proj2</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj2"><span class="id" title="definition">proj2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hp:68"><span class="id" title="variable">hp</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guard:65"><span class="id" title="variable">guard</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:67"><span class="id" title="variable">p</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj1"><span class="id" title="definition">proj1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#nhs:69"><span class="id" title="variable">nhs</span></a>) (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj2"><span class="id" title="definition">proj2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#nhs:69"><span class="id" title="variable">nhs</span></a>) (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj1"><span class="id" title="definition">proj1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hp:68"><span class="id" title="variable">hp</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:70" class="idref" href="#p:70"><span class="id" title="binder">p</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">[/\</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:70"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:70"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:71" class="idref" href="#p:71"><span class="id" title="binder">p</span></a> <a id="hp:72" class="idref" href="#hp:72"><span class="id" title="binder">hp</span></a> <a id="p':73" class="idref" href="#p':73"><span class="id" title="binder">p'</span></a> <a id="v:74" class="idref" href="#v:74"><span class="id" title="binder">v</span></a> <a id="v':75" class="idref" href="#v':75"><span class="id" title="binder">v'</span></a> := <span class="id" title="keyword">let</span> <a id="0e0d57bbddb84fea16244eabbdac2294" class="idref" href="#0e0d57bbddb84fea16244eabbdac2294"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:71"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#0e0d57bbddb84fea16244eabbdac2294"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">;;;</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">|-</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:74"><span class="id" title="variable">v</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">⇝</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">ℇ</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':75"><span class="id" title="variable">v'</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">p</span> (<span class="id" title="var">wtp</span>&amp;<span class="id" title="var">etap</span>&amp;?&amp;?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">egf</span> := <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_fast"><span class="id" title="definition">erase_global_fast</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">ef</span> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">egf</span> <span class="id" title="var">ef</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">injection</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">intros</span> &lt;- &lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_fast_wf_glob"><span class="id" title="lemma">erase_global_fast_wf_glob</span></a>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_wellformed_fast"><span class="id" title="lemma">erase_wellformed_fast</span></a> (<span class="id" title="var">X_type</span>:=<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>)); <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">e</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#expanded_erase_program"><span class="id" title="lemma">expanded_erase_program</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">guard</span> <span class="id" title="var">p</span> <span class="id" title="var">v</span> [[<span class="id" title="keyword">wf</span> [<span class="id" title="var">T</span> [<span class="id" title="var">HT1</span> <span class="id" title="var">HT2</span>]]]]. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#eval_pcuic_program"><span class="id" title="definition">eval_pcuic_program</span></a>, <a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">injection</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">intros</span> &lt;- &lt;-.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">e</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Σ'</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ev'</span> :<span class="id" title="keyword">∀</span> <a id="2aea6aca3fbbaf8871675cbb17479035" class="idref" href="#2aea6aca3fbbaf8871675cbb17479035"><span class="id" title="binder"><span id="77c43bc4276c0db6b72741fe6ffc041e" class="id">Σ0</span></span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICAst.PCUICEnvironment.global_env</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#2aea6aca3fbbaf8871675cbb17479035"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">Σ'</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICWcbvEval.html#eval"><span class="id" title="inductive">PCUICWcbvEval.eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#2aea6aca3fbbaf8871675cbb17479035"><span class="id" title="variable">Σ0</span></a> <span class="id" title="var">t</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_correct"><span class="id" title="lemma">erase_correct</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <span class="id" title="var">Σ'</span> <span class="id" title="var">Σ</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#term_global_deps"><span class="id" title="definition">EAstUtils.term_global_deps</span></a> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;4:{ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_deps_fast_spec"><span class="id" title="lemma">erase_global_deps_fast_spec</span></a>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="var">trea</span>.<br/>
&nbsp;&nbsp;2:<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.subset_spec"><span class="id" title="lemma">Kernames.KernameSet.subset_spec</span></a>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">v'</span> [<span class="id" title="var">he</span> [<span class="id" title="var">hev</span>]]]. <span class="id" title="tactic">∃</span> <span class="id" title="var">v'</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">sq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">hev</span>. <span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">Σ'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">multimatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reference_impl_env_iter_pop_eq"><span class="id" title="lemma">reference_impl_env_iter_pop_eq</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reference_impl_env_iter_pop_eq"><span class="id" title="lemma">reference_impl_env_iter_pop_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>. <span class="id" title="var">sq</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Typed erasure variant, using erasure but also keeping type information useful for later optimizations,
    e.g., de-arging. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="typed_erasure_pre" class="idref" href="#typed_erasure_pre"><span class="id" title="definition">typed_erasure_pre</span></a> (<a id="p:79" class="idref" href="#p:79"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#pcuic_program"><span class="id" title="definition">pcuic_program</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#wt_pcuic_program"><span class="id" title="definition">wt_pcuic_program</span></a> (<span class="id" title="var">cf</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:79"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_pcuic_program"><span class="id" title="definition">PCUICEtaExpand.expanded_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:79"><span class="id" title="variable">p</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:79"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:79"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#"><span class="id" title="library">Erasure</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#"><span class="id" title="library">ExAst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#"><span class="id" title="library">Optimize</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#"><span class="id" title="library">ExtractionCorrectness</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#"><span class="id" title="library">OptimizeCorrectness</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#"><span class="id" title="library">EWellformed</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#"><span class="id" title="library">PCUICTyping</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.SafeChecker</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#"><span class="id" title="library">PCUICWfEnvImpl</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Transparent</span>.<br/>
<span class="id" title="keyword">Equations</span>? <a id="erase_program_typed" class="idref" href="#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a> <a id="guard:80" class="idref" href="#guard:80"><span class="id" title="binder">guard</span></a> (<a id="p:81" class="idref" href="#p:81"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#pcuic_program"><span class="id" title="definition">pcuic_program</span></a>) (<a id="pre:82" class="idref" href="#pre:82"><span class="id" title="binder">pre</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#typed_erasure_pre"><span class="id" title="definition">typed_erasure_pre</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:81"><span class="id" title="variable">p</span></a>) : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> :=<br/>
&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed:87"><span class="id" title="definition">erase_program_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guard:84"><span class="id" title="variable">guard</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:85"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre:86"><span class="id" title="variable">pre</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="90fe39a690ac55af9e0161048d531a06" class="idref" href="#90fe39a690ac55af9e0161048d531a06"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> := <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="X:89" class="idref" href="#X:89"><span class="id" title="binder">X</span></a> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">PCUICWfEnvImpl.build_wf_env_from_env</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#90fe39a690ac55af9e0161048d531a06"><span class="id" title="variable">wfΣ</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="t':90" class="idref" href="#t':90"><span class="id" title="binder">t'</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#90fe39a690ac55af9e0161048d531a06"><span class="id" title="variable">wfΣ</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X_type</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">PCUICWfEnvImpl.optimized_abstract_env_impl</span></a> (<span class="id" title="var">guard</span> := <span class="id" title="var">guard</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X:89"><span class="id" title="variable">X</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#PEnv.universes"><span class="id" title="projection">PEnv.universes</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#PEnv.retroknowledge"><span class="id" title="projection">PEnv.retroknowledge</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="71aff70e6f76efea9a31805327476131" class="idref" href="#71aff70e6f76efea9a31805327476131"><span class="id" title="binder">Σ'</span></a> <a id="eq:92" class="idref" href="#eq:92"><span class="id" title="binder">eq</span></a> ⇒ <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#term_global_deps"><span class="id" title="definition">EAstUtils.term_global_deps</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t':90"><span class="id" title="variable">t'</span></a>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t':90"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">pre0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="var">now</span> <span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">pre0</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="keyword">wf</span> []]] <span class="id" title="var">_</span>]. <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">clear</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span>(<span class="id" title="var">x</span> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">trans_env_env</span>; <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="trans_ex_prog" class="idref" href="#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> (<a id="p:93" class="idref" href="#p:93"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_context"><span class="id" title="abbreviation">EAst.global_context</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">ExAst.trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:93"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:93"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_typed_eprogram" class="idref" href="#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a> <a id="fl:94" class="idref" href="#fl:94"><span class="id" title="binder">fl</span></a> :=<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:95" class="idref" href="#p:95"><span class="id" title="binder">p</span></a> <a id="v:96" class="idref" href="#v:96"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> @<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:94"><span class="id" title="variable">fl</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">ExAst.trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:95"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:95"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:96"><span class="id" title="variable">v</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>).<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="typed_erase_transform" class="idref" href="#typed_erase_transform"><span class="id" title="definition">typed_erase_transform</span></a> (<a id="guard:97" class="idref" href="#guard:97"><span class="id" title="binder">guard</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_guard_impl_instance"><span class="id" title="instance">fake_guard_impl_instance</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#term"><span class="id" title="inductive">PCUICAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#term"><span class="id" title="inductive">PCUICAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#eval_pcuic_program"><span class="id" title="definition">eval_pcuic_program</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">EWcbvEval.default_wcbv_flags</span></a>) :=<br/>
&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "typed erasure";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:98" class="idref" href="#p:98"><span class="id" title="binder">p</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#wt_pcuic_program"><span class="id" title="definition">wt_pcuic_program</span></a> (<span class="id" title="var">cf</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:98"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_pcuic_program"><span class="id" title="definition">PCUICEtaExpand.expanded_pcuic_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:98"><span class="id" title="variable">p</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_1"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:98"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#NormalizationIn_erase_pcuic_program_2"><span class="id" title="abbreviation">NormalizationIn_erase_pcuic_program_2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:98"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:99" class="idref" href="#p:99"><span class="id" title="binder">p</span></a> <a id="hp:100" class="idref" href="#hp:100"><span class="id" title="binder">hp</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guard:97"><span class="id" title="variable">guard</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:99"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hp:100"><span class="id" title="variable">hp</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:101" class="idref" href="#p:101"><span class="id" title="binder">p</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">[/\</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:101"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:101"><span class="id" title="variable">p</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#53e4c1e546d9b20e029d981f761726c2"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:102" class="idref" href="#p:102"><span class="id" title="binder">p</span></a> <a id="hp:103" class="idref" href="#hp:103"><span class="id" title="binder">hp</span></a> <a id="p':104" class="idref" href="#p':104"><span class="id" title="binder">p'</span></a> <a id="v:105" class="idref" href="#v:105"><span class="id" title="binder">v</span></a> <a id="v':106" class="idref" href="#v':106"><span class="id" title="binder">v'</span></a> := <span class="id" title="keyword">let</span> <a id="3cedca6701e55d274b90a4066ad3c858" class="idref" href="#3cedca6701e55d274b90a4066ad3c858"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:102"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#3cedca6701e55d274b90a4066ad3c858"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">;;;</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">|-</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:105"><span class="id" title="variable">v</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">⇝</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">ℇ</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':106"><span class="id" title="variable">v'</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program"><span class="id" title="definition">erase_program</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> (<span class="id" title="var">wtp</span>&amp;<span class="id" title="var">etap</span>&amp;?&amp;?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program"><span class="id" title="definition">erase_pcuic_program</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">egf</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">ef</span> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<span class="id" title="var">egf</span> <span class="id" title="var">ef</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">injection</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">intros</span> &lt;- &lt;-. <span class="id" title="tactic">clear</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#extends_wellformed"><span class="id" title="lemma">extends_wellformed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_wellformed_weaken"><span class="id" title="lemma">erase_wellformed_weaken</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <span class="id" title="var">p</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Γ</span>:=<span class="id" title="notation">[]</span>)); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4:<span class="id" title="tactic">exact</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.empty"><span class="id" title="definition">KernameSet.empty</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">abstract</span> (<span class="id" title="var">cbn</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">congruence</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_deps_erase_global"><span class="id" title="lemma">erase_global_deps_erase_global</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#trans_env_erase_global_decls"><span class="id" title="lemma">trans_env_erase_global_decls</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kn</span> <span class="id" title="var">hin</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">hin</span>; [<span class="id" title="var">knset</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> ?<span class="id" title="var">X_type</span> ?<span class="id" title="var">X</span> ?<span class="id" title="var">nin</span> ?<span class="id" title="var">G</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">wt</span> ] |- <span class="id" title="keyword">context</span> [ @<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> ?<span class="id" title="var">X_type'</span> ?<span class="id" title="var">X'</span> ?<span class="id" title="var">nin'</span> ?<span class="id" title="var">G'</span> ?<span class="id" title="var">t'</span> ?<span class="id" title="var">wt'</span> ] ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_irrel_global_env"><span class="id" title="lemma">erase_irrel_global_env</span></a> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">nin</span> <span class="id" title="var">X_type'</span> <span class="id" title="var">X'</span> <span class="id" title="var">nin'</span> <span class="id" title="var">G</span> <span class="id" title="var">t</span> <span class="id" title="var">wt</span> <span class="id" title="var">wt'</span>); <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">wtp</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">wf_fresh_globals</span></a>, <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>: <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;- &lt;-]. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#expanded_erase_global_decls_recursive"><span class="id" title="lemma">expanded_erase_global_decls_recursive</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">etap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#expanded_erase"><span class="id" title="lemma">expanded_erase</span></a> ⇒ //; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">etap</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">guard</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">cf</span> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">p</span> <span class="id" title="var">v</span> [[<span class="id" title="keyword">wf</span> [<span class="id" title="var">T</span> [<span class="id" title="var">HT1</span> <span class="id" title="var">HT2</span>]]]]. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.TemplatePCUIC.PCUICTransform.html#eval_pcuic_program"><span class="id" title="definition">eval_pcuic_program</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_program_typed"><span class="id" title="definition">erase_program_typed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">er</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">et</span> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">edestruct</span> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#erase_pcuic_program_normalization_helper"><span class="id" title="lemma">erase_pcuic_program_normalization_helper</span></a>); <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#make_env"><span class="id" title="definition">make_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">et</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>] <span class="id" title="tactic">in</span> <span class="id" title="var">et</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_exists"><span class="id" title="method">abstract_env_ext_exists</span></a> <span class="id" title="var">e</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">Σe</span> <span class="id" title="var">he</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;[<span class="id" title="var">H</span> := <span class="id" title="keyword">context</span> [ @<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> ?<span class="id" title="var">X_type</span> ?<span class="id" title="var">X</span> ?<span class="id" title="var">nin</span> ?<span class="id" title="var">Γ</span> <span class="id" title="var">t</span> ?<span class="id" title="var">wt</span> ] |- <span class="id" title="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erases_erase"><span class="id" title="lemma">erases_erase</span></a> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">nin</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span> <span class="id" title="var">wt</span> <span class="id" title="var">_</span> <span class="id" title="var">he</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">he</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">Σe</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">univs</span>]; <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">wv</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#welltyped"><span class="id" title="inductive">welltyped</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">univs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">[]</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICClassification.html#subject_reduction_eval"><span class="id" title="lemma">PCUICClassification.subject_reduction_eval</span></a>; <span class="id" title="var">tea</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#erases_correct"><span class="id" title="lemma">ErasureCorrectness.erases_correct</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">Σ</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#trans_env_env"><span class="id" title="projection">trans_env_env</span></a> <span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">univs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<span class="id" title="var">Σ'</span> := <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">er</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">erv</span>&amp;<span class="id" title="var">erase_to</span>&amp;[<span class="id" title="var">erev</span>]);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">wf</span> <span class="id" title="keyword">as</span> [<span class="id" title="keyword">wf</span> []]. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_erases_deps"><span class="id" title="lemma">erase_global_erases_deps</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">er</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl</span> := <span class="id" title="keyword">fun</span> <a id="fd452f793c9f64a17d439fa827da77f2" class="idref" href="#fd452f793c9f64a17d439fa827da77f2"><span class="id" title="binder"><span id="31fbca5729d0f440dfe91439c4275a5d" class="id">Σ'</span></span></a> ⇒ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl'</span> := <span class="id" title="keyword">fun</span> <a id="a3491959433793a13c1160d18e76814e" class="idref" href="#a3491959433793a13c1160d18e76814e"><span class="id" title="binder"><span id="12b91e69a2675bf94c71119be30f1cd2" class="id">Σ'</span></span></a> ⇒ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">trans_env_env</span>. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <span class="id" title="var">e</span>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_global_decls_deps_recursive_correct"><span class="id" title="lemma">ErasureCorrectness.erase_global_decls_deps_recursive_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#term_global_deps_spec"><span class="id" title="lemma">term_global_deps_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">hin</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span> <span class="id" title="var">eq</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="keyword">wf</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
De-arging requires first the removal of match-on-box which allows getting rid of all
  dependencies on propositional inductive types. 
</div>
<div class="code">
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#"><span class="id" title="module">EOptimizePropDiscr</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#"><span class="id" title="module">OptimizePropDiscr</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#"><span class="id" title="module">EWcbvEval</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="remove_match_on_box_typed_env" class="idref" href="#remove_match_on_box_typed_env"><span class="id" title="definition">remove_match_on_box_typed_env</span></a> <a id="m:112" class="idref" href="#m:112"><span class="id" title="binder">m</span></a> (<a id="67028e5db0d7f321f964117e73116fa2" class="idref" href="#67028e5db0d7f321f964117e73116fa2"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_decl"><span class="id" title="definition">remove_match_on_box_decl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#m:112"><span class="id" title="variable">m</span></a>)) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#67028e5db0d7f321f964117e73116fa2"><span class="id" title="variable">Σ</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="map_of_typed_global_env" class="idref" href="#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a> (<a id="p:114" class="idref" href="#p:114"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) (<a id="fr:115" class="idref" href="#fr:115"><span class="id" title="binder">fr</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_globals"><span class="id" title="inductive">fresh_globals</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:114"><span class="id" title="variable">p</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">GlobalContextMap.make</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:114"><span class="id" title="variable">p</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_env_obligation_1"><span class="id" title="lemma">OptimizePropDiscr.remove_match_on_box_env_obligation_1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:114"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fr:115"><span class="id" title="variable">fr</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="pre_remove_match_on_box_typed" class="idref" href="#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a id="efl:116" class="idref" href="#efl:116"><span class="id" title="binder">efl</span></a> (<a id="p:117" class="idref" href="#p:117"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:116"><span class="id" title="variable">efl</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:117"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:117"><span class="id" title="variable">p</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fresh_global_trans" class="idref" href="#fresh_global_trans"><span class="id" title="lemma">fresh_global_trans</span></a> <a id="kn:118" class="idref" href="#kn:118"><span class="id" title="binder">kn</span></a> <a id="g:119" class="idref" href="#g:119"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_global"><span class="id" title="definition">EnvMap.EnvMap.fresh_global</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:118"><span class="id" title="variable">kn</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#g:119"><span class="id" title="variable">g</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_global"><span class="id" title="definition">fresh_global</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:118"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#g:119"><span class="id" title="variable">g</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [ | [[<span class="id" title="var">kn'</span> <span class="id" title="var">b</span>] <span class="id" title="var">d</span>] <span class="id" title="var">tl</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">depelim</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#Forall_map_inv"><span class="id" title="lemma">Forall_map_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">ELiftSubst.solve_all</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="pre_remove_match_on_box_typed_fresh" class="idref" href="#pre_remove_match_on_box_typed_fresh"><span class="id" title="lemma">pre_remove_match_on_box_typed_fresh</span></a> <a id="efl:120" class="idref" href="#efl:120"><span class="id" title="binder">efl</span></a> <a id="p:121" class="idref" href="#p:121"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:120"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:121"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_globals"><span class="id" title="inductive">fresh_globals</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:121"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> []. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_glob_fresh"><span class="id" title="lemma">wf_glob_fresh</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>; <span class="id" title="var">depind</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>; <span class="id" title="var">noconf</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">g0</span>; <span class="id" title="var">noconf</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">kn'</span> <span class="id" title="var">b</span>] <span class="id" title="var">d'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fresh_global_trans"><span class="id" title="lemma">fresh_global_trans</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="map_trans_env" class="idref" href="#map_trans_env"><span class="id" title="lemma">map_trans_env</span></a> <a id="89c991e573d576d4ce9b4ce8f6af8d89" class="idref" href="#89c991e573d576d4ce9b4ce8f6af8d89"><span class="id" title="binder">Σ</span></a> <a id="m:123" class="idref" href="#m:123"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_decl"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box_decl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#m:123"><span class="id" title="variable">m</span></a>)) (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#89c991e573d576d4ce9b4ce8f6af8d89"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_decl"><span class="id" title="definition">OptimizePropDiscr.remove_match_on_box_decl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#m:123"><span class="id" title="variable">m</span></a>)) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#89c991e573d576d4ce9b4ce8f6af8d89"><span class="id" title="variable">Σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span>; <span class="id" title="var">cbn</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">kn</span> <span class="id" title="var">b</span>] <span class="id" title="var">d</span>]; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> ⇒ //. <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHΣ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="remove_match_on_box_program_typed" class="idref" href="#remove_match_on_box_program_typed"><span class="id" title="definition">remove_match_on_box_program_typed</span></a> <a id="efl:124" class="idref" href="#efl:124"><span class="id" title="binder">efl</span></a> (<a id="p:125" class="idref" href="#p:125"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) (<a id="pre:126" class="idref" href="#pre:126"><span class="id" title="binder">pre</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:124"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:125"><span class="id" title="variable">p</span></a>) : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="m:127" class="idref" href="#m:127"><span class="id" title="binder">m</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:125"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed_fresh"><span class="id" title="lemma">pre_remove_match_on_box_typed_fresh</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:124"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:125"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre:126"><span class="id" title="variable">pre</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_typed_env"><span class="id" title="definition">remove_match_on_box_typed_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#m:127"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:125"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#m:127"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:125"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#"><span class="id" title="module">EOptimizePropDiscr</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="remove_match_on_box_typed_transform" class="idref" href="#remove_match_on_box_typed_transform"><span class="id" title="definition">remove_match_on_box_typed_transform</span></a> {<a id="fl:128" class="idref" href="#fl:128"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:129" class="idref" href="#wcon:129"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:130" class="idref" href="#efl:130"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="hastrel:131" class="idref" href="#hastrel:131"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:132" class="idref" href="#hastbox:132"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:128"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#disable_prop_cases"><span class="id" title="definition">disable_prop_cases</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:128"><span class="id" title="variable">fl</span></a>)) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "optimize_prop_discr";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:134" class="idref" href="#p:134"><span class="id" title="binder">p</span></a> <a id="pr:135" class="idref" href="#pr:135"><span class="id" title="binder">pr</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_program_typed"><span class="id" title="definition">remove_match_on_box_program_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:130"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:134"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pr:135"><span class="id" title="variable">pr</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:133" class="idref" href="#p:133"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:130"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:133"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:136" class="idref" href="#p:136"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:130"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:136"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:137" class="idref" href="#p:137"><span class="id" title="binder">p</span></a> <a id="hp:138" class="idref" href="#hp:138"><span class="id" title="binder">hp</span></a> <a id="p':139" class="idref" href="#p':139"><span class="id" title="binder">p'</span></a> <a id="v:140" class="idref" href="#v:140"><span class="id" title="binder">v</span></a> <a id="v':141" class="idref" href="#v':141"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':141"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:137"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed_fresh"><span class="id" title="lemma">pre_remove_match_on_box_typed_fresh</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:130"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:137"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hp:138"><span class="id" title="variable">hp</span></a>)) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:140"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">etap</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_program_typed"><span class="id" title="definition">remove_match_on_box_program_typed</span></a>; <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_remove_match_on_box_env"><span class="id" title="lemma">trans_env_remove_match_on_box_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_env_wf"><span class="id" title="lemma">remove_match_on_box_env_wf</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">wfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_env"><span class="id" title="definition">remove_match_on_box_env</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl</span> := <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_globals"><span class="id" title="lemma">trans_env_fresh_globals</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl'</span> := <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_env_obligation_1"><span class="id" title="lemma">OptimizePropDiscr.remove_match_on_box_env_obligation_1</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">obl</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">obl'</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="axiom">proof_irrelevance</span>. <span class="id" title="var">clearbody</span> <span class="id" title="var">obl</span> <span class="id" title="var">obl'</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">obl'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_wellformed_irrel"><span class="id" title="lemma">remove_match_on_box_wellformed_irrel</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">wfp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_wellformed"><span class="id" title="lemma">remove_match_on_box_wellformed</span></a> ⇒ //=. <span class="id" title="tactic">apply</span> <span class="id" title="var">wfp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wfp</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> /= /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_typed_env"><span class="id" title="definition">remove_match_on_box_typed_env</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_trans_env"><span class="id" title="lemma">map_trans_env</span></a>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trans_ex_prog"><span class="id" title="definition">trans_ex_prog</span></a> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e'</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program_expanded_fix"><span class="id" title="definition">remove_match_on_box_program_expanded_fix</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">e'</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">wfp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a>. <span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">etap</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>] <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_program_typed"><span class="id" title="definition">remove_match_on_box_program_typed</span></a>. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed_fresh"><span class="id" title="lemma">pre_remove_match_on_box_typed_fresh</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_correct"><span class="id" title="lemma">EOptimizePropDiscr.remove_match_on_box_correct</span></a> (<span class="id" title="var">Σ</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_of_typed_global_env"><span class="id" title="definition">map_of_typed_global_env</span></a> <span class="id" title="var">_</span> <span class="id" title="var">obl</span>) <span class="id" title="var">t</span> <span class="id" title="var">v</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#map_trans_env"><span class="id" title="lemma">map_trans_env</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>, <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>, <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="dearging_config" class="idref" href="#dearging_config"><span class="id" title="record">dearging_config</span></a> :=<br/>
&nbsp;&nbsp;{ <a id="overridden_masks" class="idref" href="#overridden_masks"><span class="id" title="projection">overridden_masks</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#bitmask"><span class="id" title="definition">bitmask</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="do_trim_const_masks" class="idref" href="#do_trim_const_masks"><span class="id" title="projection">do_trim_const_masks</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="do_trim_ctor_masks" class="idref" href="#do_trim_ctor_masks"><span class="id" title="projection">do_trim_ctor_masks</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> }.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="check_dearging_precond" class="idref" href="#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a> (<a id="cf:146" class="idref" href="#cf:146"><span class="id" title="binder">cf</span></a> : <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#dearging_config"><span class="id" title="record">dearging_config</span></a>) <a id="b5068c6cd8c41337afac36deb35caa4d" class="idref" href="#b5068c6cd8c41337afac36deb35caa4d"><span class="id" title="binder">Σ</span></a> <a id="t:148" class="idref" href="#t:148"><span class="id" title="binder">t</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b5068c6cd8c41337afac36deb35caa4d"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">ExtractionCorrectness.compute_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:146"><span class="id" title="variable">cf</span></a>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#overridden_masks"><span class="id" title="projection">overridden_masks</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:146"><span class="id" title="variable">cf</span></a>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#do_trim_const_masks"><span class="id" title="projection">do_trim_const_masks</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:146"><span class="id" title="variable">cf</span></a>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#do_trim_ctor_masks"><span class="id" title="projection">do_trim_ctor_masks</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b5068c6cd8c41337afac36deb35caa4d"><span class="id" title="variable">Σ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">ResultMonad.Ok</span></a> <span class="id" title="var">masks</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <span class="id" title="var">masks</span>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:148"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <span class="id" title="var">masks</span>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <span class="id" title="var">masks</span>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:148"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">masks</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="check_dearging_precond_spec" class="idref" href="#check_dearging_precond_spec"><span class="id" title="lemma">check_dearging_precond_spec</span></a> <a id="cf:149" class="idref" href="#cf:149"><span class="id" title="binder">cf</span></a> <a id="env:150" class="idref" href="#env:150"><span class="id" title="binder">env</span></a> <a id="t:151" class="idref" href="#t:151"><span class="id" title="binder">t</span></a> <a id="d:152" class="idref" href="#d:152"><span class="id" title="binder">d</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:149"><span class="id" title="variable">cf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:150"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:151"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:150"><span class="id" title="variable">env</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:150"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:150"><span class="id" title="variable">env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:151"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#d:152"><span class="id" title="variable">d</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:151"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">ExtractionCorrectness.compute_masks</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.Utils.html#timed"><span class="id" title="definition">Utils.timed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#analyze_env"><span class="id" title="definition">analyze_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eqm</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">isex</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">vm</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">vc</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">ise</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;-]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="check_dearging_trans" class="idref" href="#check_dearging_trans"><span class="id" title="definition">check_dearging_trans</span></a> <a id="cf:153" class="idref" href="#cf:153"><span class="id" title="binder">cf</span></a> <a id="p:154" class="idref" href="#p:154"><span class="id" title="binder">p</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">((</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:153"><span class="id" title="variable">cf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:154"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:154"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:154"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">),</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:154"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_typed_eprogram_masks" class="idref" href="#eval_typed_eprogram_masks"><span class="id" title="definition">eval_typed_eprogram_masks</span></a> <a id="fl:155" class="idref" href="#fl:155"><span class="id" title="binder">fl</span></a> :=<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="p:156" class="idref" href="#p:156"><span class="id" title="binder">p</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_set"><span class="id" title="record">dearg_set</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) <a id="v:157" class="idref" href="#v:157"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> @<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:155"><span class="id" title="variable">fl</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">ExAst.trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:156"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:156"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:157"><span class="id" title="variable">v</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="post_dearging_checks" class="idref" href="#post_dearging_checks"><span class="id" title="definition">post_dearging_checks</span></a> <a id="efl:158" class="idref" href="#efl:158"><span class="id" title="binder">efl</span></a> <a id="cf:159" class="idref" href="#cf:159"><span class="id" title="binder">cf</span></a> (<a id="p:160" class="idref" href="#p:160"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_set"><span class="id" title="record">dearg_set</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:159"><span class="id" title="variable">cf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:158"><span class="id" title="variable">efl</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:160"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="dearging_checks_transform" class="idref" href="#dearging_checks_transform"><span class="id" title="definition">dearging_checks_transform</span></a> {<a id="efl:161" class="idref" href="#efl:161"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} <a id="cf:162" class="idref" href="#cf:162"><span class="id" title="binder">cf</span></a> {<a id="hastrel:163" class="idref" href="#hastrel:163"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:164" class="idref" href="#hastbox:164"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram"><span class="id" title="definition">eval_typed_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>) (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram_masks"><span class="id" title="definition">eval_typed_eprogram_masks</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "dearging";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:166" class="idref" href="#p:166"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_trans"><span class="id" title="definition">check_dearging_trans</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:162"><span class="id" title="variable">cf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:166"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:165" class="idref" href="#p:165"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre_remove_match_on_box_typed"><span class="id" title="definition">pre_remove_match_on_box_typed</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:161"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:165"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#post_dearging_checks"><span class="id" title="definition">post_dearging_checks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:161"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:162"><span class="id" title="variable">cf</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:167" class="idref" href="#p:167"><span class="id" title="binder">p</span></a> <a id="hp:168" class="idref" href="#hp:168"><span class="id" title="binder">hp</span></a> <a id="p':169" class="idref" href="#p':169"><span class="id" title="binder">p'</span></a> <a id="v:170" class="idref" href="#v:170"><span class="id" title="binder">v</span></a> <a id="v':171" class="idref" href="#v':171"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':171"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:170"><span class="id" title="variable">v</span></a> |}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Dearging" class="idref" href="#Dearging"><span class="id" title="section">Dearging</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#"><span class="id" title="module">Optimize</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#"><span class="id" title="module">OptimizeCorrectness</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="dearg" class="idref" href="#dearg"><span class="id" title="definition">dearg</span></a> (<a id="p:172" class="idref" href="#p:172"><span class="id" title="binder">p</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_set"><span class="id" title="record">dearg_set</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_context"><span class="id" title="abbreviation">global_context</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:172"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">masks</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> <span class="id" title="var">masks</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:172"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_term"><span class="id" title="definition">dearg_term</span></a> <span class="id" title="var">masks</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:172"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:172"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:172"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="dearging_transform" class="idref" href="#dearging_transform"><span class="id" title="definition">dearging_transform</span></a> (<a id="efl:173" class="idref" href="#efl:173"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>) <a id="cf:174" class="idref" href="#cf:174"><span class="id" title="binder">cf</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram_masks"><span class="id" title="definition">eval_typed_eprogram_masks</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "dearging";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:176" class="idref" href="#p:176"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#dearg"><span class="id" title="definition">dearg</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:176"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:175" class="idref" href="#p:175"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#post_dearging_checks"><span class="id" title="definition">post_dearging_checks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:173"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#cf:174"><span class="id" title="variable">cf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:175"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:177" class="idref" href="#p:177"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:173"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:177"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:177"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:178" class="idref" href="#p:178"><span class="id" title="binder">p</span></a> <a id="hp:179" class="idref" href="#hp:179"><span class="id" title="binder">hp</span></a> <a id="p':180" class="idref" href="#p':180"><span class="id" title="binder">p'</span></a> <a id="v:181" class="idref" href="#v:181"><span class="id" title="binder">v</span></a> <a id="v':182" class="idref" href="#v':182"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':182"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#dearg"><span class="id" title="definition">dearg</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:178"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:181"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a> |}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#dearg"><span class="id" title="definition">dearg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">eqp</span>; <span class="id" title="var">cbn</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">input</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">masks</span> <span class="id" title="var">env</span>] <span class="id" title="var">t</span>]. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_env"><span class="id" title="definition">Optimize.dearg_env</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">masks</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> [<span class="id" title="keyword">wf</span> <span class="id" title="var">exp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond_spec"><span class="id" title="lemma">check_dearging_precond_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eqp</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#wf_glob_debox"><span class="id" title="lemma">wf_glob_debox</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#wf_glob_dearg"><span class="id" title="lemma">wf_glob_dearg</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#trans_env_debox"><span class="id" title="lemma">trans_env_debox</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#wellformed_dearg"><span class="id" title="lemma">wellformed_dearg</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> -<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#trans_env_debox"><span class="id" title="lemma">trans_env_debox</span></a>. <span class="id" title="tactic">split</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#expanded_dearg_env"><span class="id" title="lemma">expanded_dearg_env</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#isEtaExp_expanded"><span class="id" title="lemma">EEtaExpandedFix.isEtaExp_expanded</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#expanded_dearg"><span class="id" title="lemma">expanded_dearg</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_isEtaExp"><span class="id" title="lemma">EEtaExpandedFix.expanded_isEtaExp</span></a>, <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">v</span> [<span class="id" title="var">he</span> [<span class="id" title="var">wfe</span> <span class="id" title="var">exp</span>]]. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_typed_eprogram_masks"><span class="id" title="definition">eval_typed_eprogram_masks</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#dearg"><span class="id" title="definition">dearg</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">he</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">masks</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">cpre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#extract_correct_gen'"><span class="id" title="lemma">extract_correct_gen'</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">masks</span> <span class="id" title="var">cf</span>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#overridden_masks"><span class="id" title="projection">overridden_masks</span></a>) <span class="id" title="var">cf</span>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#do_trim_const_masks"><span class="id" title="projection">do_trim_const_masks</span></a>) <span class="id" title="var">cf</span>.(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#do_trim_ctor_masks"><span class="id" title="projection">do_trim_ctor_masks</span></a>)) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ev'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ev'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">red</span>. <span class="id" title="var">sq</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ev'</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfe</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">wfe</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>: <span class="id" title="var">cpre</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">ExtractionCorrectness.compute_masks</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">_</span>) ⇒ //. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>: <span class="id" title="var">cpre</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">ExtractionCorrectness.compute_masks</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">vc</span> ⇒ //. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> [= -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>: <span class="id" title="var">cpre</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#check_dearging_precond"><span class="id" title="definition">check_dearging_precond</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">closed_env</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">ExtractionCorrectness.compute_masks</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">vc</span> ⇒ //. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">ise</span> ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> [= -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#Dearging"><span class="id" title="section">Dearging</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="PCUICEnv" class="idref" href="#PCUICEnv"><span class="id" title="section">PCUICEnv</span></a>. <span class="comment">(*&nbsp;Locally&nbsp;reuse&nbsp;the&nbsp;short&nbsp;names&nbsp;for&nbsp;PCUIC&nbsp;environment&nbsp;handling&nbsp;*)</span><br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment"><span class="id" title="module">PCUICAst.PCUICEnvironment</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="build_wf_env_from_env_eq" class="idref" href="#build_wf_env_from_env_eq"><span class="id" title="lemma">build_wf_env_from_env_eq</span></a> {<a id="cf:183" class="idref" href="#cf:183"><span class="id" title="binder">cf</span></a> : <a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} (<a id="guard:184" class="idref" href="#guard:184"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>) (<a id="140a8189dc044d625ce3311ee7ac5019" class="idref" href="#140a8189dc044d625ce3311ee7ac5019"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#global_env_ext_map"><span class="id" title="definition">global_env_ext_map</span></a>) (<a id="eba39f9c82a5a29d95d082131d725653" class="idref" href="#eba39f9c82a5a29d95d082131d725653"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">PCUICTyping.wf_ext</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#140a8189dc044d625ce3311ee7ac5019"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="wfe:187" class="idref" href="#wfe:187"><span class="id" title="binder">wfe</span></a> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#140a8189dc044d625ce3311ee7ac5019"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">PCUICTyping.wf_ext_wf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#140a8189dc044d625ce3311ee7ac5019"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eba39f9c82a5a29d95d082131d725653"><span class="id" title="variable">wfΣ</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="b2039cd6be2eb27689ce11d622372484" class="idref" href="#b2039cd6be2eb27689ce11d622372484"><span class="id" title="binder">Σ'</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b2039cd6be2eb27689ce11d622372484"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#9897e19d536bda84609b8ab92c34be9b"><span class="id" title="notation">∼</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfe:187"><span class="id" title="variable">wfe</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#b2039cd6be2eb27689ce11d622372484"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#140a8189dc044d625ce3311ee7ac5019"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extends_global_env" class="idref" href="#extends_global_env"><span class="id" title="definition">extends_global_env</span></a> (<a id="37ec568f87ae2731db728c4dee5dd212" class="idref" href="#37ec568f87ae2731db728c4dee5dd212"><span class="id" title="binder">Σ</span></a> <a id="c18443d99e17c2dc2751db214aab783d" class="idref" href="#c18443d99e17c2dc2751db214aab783d"><span class="id" title="binder">Σ'</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#global_env_ext_map"><span class="id" title="definition">global_env_ext_map</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">[/\</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="kn:191" class="idref" href="#kn:191"><span class="id" title="binder">kn</span></a> <a id="decl:192" class="idref" href="#decl:192"><span class="id" title="binder">decl</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#37ec568f87ae2731db728c4dee5dd212"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:191"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl:192"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#c18443d99e17c2dc2751db214aab783d"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:191"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl:192"><span class="id" title="variable">decl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#37ec568f87ae2731db728c4dee5dd212"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#c18443d99e17c2dc2751db214aab783d"><span class="id" title="variable">Σ'</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#37ec568f87ae2731db728c4dee5dd212"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#c18443d99e17c2dc2751db214aab783d"><span class="id" title="variable">Σ'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#37ec568f87ae2731db728c4dee5dd212"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#c18443d99e17c2dc2751db214aab783d"><span class="id" title="variable">Σ'</span></a>.(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#554fc3f3cf0a27fe0863b7741d119014"><span class="id" title="notation">]</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extends_pcuic_program" class="idref" href="#extends_pcuic_program"><span class="id" title="definition">extends_pcuic_program</span></a> (<a id="p:193" class="idref" href="#p:193"><span class="id" title="binder">p</span></a> <a id="p':194" class="idref" href="#p':194"><span class="id" title="binder">p'</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#pcuic_program"><span class="id" title="definition">pcuic_program</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#extends_global_env"><span class="id" title="definition">extends_global_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:193"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':194"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:193"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':194"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#"><span class="id" title="module">ErasureFunction</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="module">PCUICAst</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="strictly_extends_lookups" class="idref" href="#strictly_extends_lookups"><span class="id" title="lemma">strictly_extends_lookups</span></a> {<a id="cf:195" class="idref" href="#cf:195"><span class="id" title="binder">cf</span></a>:<a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} (<a id="X:196" class="idref" href="#X:196"><span class="id" title="binder">X</span></a> <a id="X':197" class="idref" href="#X':197"><span class="id" title="binder">X'</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env"><span class="id" title="record">wf_env</span></a>) (<a id="6c81dc2354ff9366d001c562d294efbf" class="idref" href="#6c81dc2354ff9366d001c562d294efbf"><span class="id" title="binder">Σ</span></a> <a id="7f531edd7bc1e491af71de323f3a50d2" class="idref" href="#7f531edd7bc1e491af71de323f3a50d2"><span class="id" title="binder">Σ'</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> (<a id="kn:200" class="idref" href="#kn:200"><span class="id" title="binder">kn</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a>) (<a id="decl:201" class="idref" href="#decl:201"><span class="id" title="binder">decl</span></a> <a id="decl':202" class="idref" href="#decl':202"><span class="id" title="binder">decl'</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">global_decl</span></a>), <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#7f531edd7bc1e491af71de323f3a50d2"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:200"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl:201"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#6c81dc2354ff9366d001c562d294efbf"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:200"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl':202"><span class="id" title="variable">decl'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl:201"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl':202"><span class="id" title="variable">decl'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#6c81dc2354ff9366d001c562d294efbf"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#7f531edd7bc1e491af71de323f3a50d2"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.strictly_extends_decls"><span class="id" title="class">strictly_extends_decls</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X:196"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#6c81dc2354ff9366d001c562d294efbf"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.strictly_extends_decls"><span class="id" title="class">strictly_extends_decls</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X':197"><span class="id" title="variable">X'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#7f531edd7bc1e491af71de323f3a50d2"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">PCUICTyping.wf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#6c81dc2354ff9366d001c562d294efbf"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">PCUICTyping.wf</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#7f531edd7bc1e491af71de323f3a50d2"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#equiv_env_inter"><span class="id" title="definition">equiv_env_inter</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X':197"><span class="id" title="variable">X'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#X:196"><span class="id" title="variable">X</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hl</span> <span class="id" title="var">hr</span> [] [] <span class="id" title="keyword">wf</span> <span class="id" title="var">wf'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">kn</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">eq</span>], <span class="id" title="var">s0</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">eq'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq'</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">decl'</span> <span class="id" title="var">hl'</span> <span class="id" title="var">hl''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">hl</span> <span class="id" title="var">kn</span> <span class="id" title="var">d</span> <span class="id" title="var">decl'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">wf_fresh_globals</span></a> <span class="id" title="tactic">in</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">wf_fresh_globals</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wf'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">wf</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wf'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#lookup_global_app_wf"><span class="id" title="lemma">lookup_global_app_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hl'</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#lookup_global_app_wf"><span class="id" title="lemma">lookup_global_app_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hl''</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.primitive_constant"><span class="id" title="definition">primitive_constant</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e0</span> <span class="id" title="var">e2</span> <span class="id" title="var">hr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_In_map_fst" class="idref" href="#lookup_env_In_map_fst"><span class="id" title="lemma">lookup_env_In_map_fst</span></a> <a id="30db74763ad87d5244435f39e6f9e473" class="idref" href="#30db74763ad87d5244435f39e6f9e473"><span class="id" title="binder">Σ</span></a> <a id="kn:204" class="idref" href="#kn:204"><span class="id" title="binder">kn</span></a> <a id="decl:205" class="idref" href="#decl:205"><span class="id" title="binder">decl</span></a> : <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">EGlobalEnv.lookup_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#30db74763ad87d5244435f39e6f9e473"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:204"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#decl:205"><span class="id" title="variable">decl</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#kn:204"><span class="id" title="variable">kn</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#30db74763ad87d5244435f39e6f9e473"><span class="id" title="variable">Σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ</span>; <span class="id" title="var">cbn</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> → [= &lt;-]. <span class="id" title="var">now</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">hl</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#PCUICEnv"><span class="id" title="section">PCUICEnv</span></a>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Obligation</span> <span class="id" title="keyword">Tactic</span> := <span class="id" title="tactic">idtac</span>.<br/>

<br/>
</div>

<div class="doc">
This transformation is the identity on terms but changes the evaluation relation to one
    where fixpoints are not guarded. It requires eta-expanded fixpoints and evaluation
    to use the guarded fixpoint rule as a precondition. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#"><span class="id" title="module">EWcbvEval</span></a> (<span class="id" title="var">WcbvFlags</span>, <span class="id" title="var">with_prop_case</span>, <span class="id" title="var">with_guarded_fix</span>).<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="guarded_to_unguarded_fix" class="idref" href="#guarded_to_unguarded_fix"><span class="id" title="definition">guarded_to_unguarded_fix</span></a> {<a id="fl:206" class="idref" href="#fl:206"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="wcon:207" class="idref" href="#wcon:207"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:208" class="idref" href="#efl:208"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="wguard:209" class="idref" href="#wguard:209"><span class="id" title="binder">wguard</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:206"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> (<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#switch_unguarded_fix"><span class="id" title="definition">EWcbvEval.switch_unguarded_fix</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:206"><span class="id" title="variable">fl</span></a>)) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "switching to unguarded fixpoints";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:211" class="idref" href="#p:211"><span class="id" title="binder">p</span></a> <a id="pre:212" class="idref" href="#pre:212"><span class="id" title="binder">pre</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:211"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:210" class="idref" href="#p:210"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:208"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:210"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:210"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:213" class="idref" href="#p:213"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:208"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:213"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:213"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:214" class="idref" href="#p:214"><span class="id" title="binder">p</span></a> <a id="hp:215" class="idref" href="#hp:215"><span class="id" title="binder">hp</span></a> <a id="p':216" class="idref" href="#p':216"><span class="id" title="binder">p'</span></a> <a id="v:217" class="idref" href="#v:217"><span class="id" title="binder">v</span></a> <a id="v':218" class="idref" href="#v':218"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':218"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:217"><span class="id" title="variable">v</span></a> |}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">wguard</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] <span class="id" title="var">v</span> [<span class="id" title="var">wfp</span> [<span class="id" title="var">etae</span> <span class="id" title="var">etat</span>]]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">ev</span>]. <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">sq</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#eval_opt_to_target"><span class="id" title="lemma">EEtaExpandedFix.eval_opt_to_target</span></a> ⇒ //. <span class="id" title="tactic">auto</span>. 2:<span class="id" title="tactic">apply</span> <span class="id" title="var">wfp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env_isEtaExp_env"><span class="id" title="lemma">EEtaExpandedFix.expanded_global_env_isEtaExp_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_isEtaExp"><span class="id" title="lemma">EEtaExpandedFix.expanded_isEtaExp</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="guarded_to_unguarded_fix_extends" class="idref" href="#guarded_to_unguarded_fix_extends"><span class="id" title="instance">guarded_to_unguarded_fix_extends</span></a> {<a id="fl:219" class="idref" href="#fl:219"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="wcon:220" class="idref" href="#wcon:220"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:221" class="idref" href="#efl:221"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="wguard:222" class="idref" href="#wguard:222"><span class="id" title="binder">wguard</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guarded_to_unguarded_fix"><span class="id" title="definition">guarded_to_unguarded_fix</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:220"><span class="id" title="variable">wcon</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wguard:222"><span class="id" title="variable">wguard</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:225" class="idref" href="#p:225"><span class="id" title="binder">p</span></a> <a id="p':226" class="idref" href="#p':226"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:225"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':226"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:223" class="idref" href="#p:223"><span class="id" title="binder">p</span></a> <a id="p':224" class="idref" href="#p':224"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:223"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':224"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> ?. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="guarded_to_unguarded_fix_extends'" class="idref" href="#guarded_to_unguarded_fix_extends'"><span class="id" title="instance">guarded_to_unguarded_fix_extends'</span></a> {<a id="fl:227" class="idref" href="#fl:227"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="wcon:228" class="idref" href="#wcon:228"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:229" class="idref" href="#efl:229"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="wguard:230" class="idref" href="#wguard:230"><span class="id" title="binder">wguard</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#guarded_to_unguarded_fix"><span class="id" title="definition">guarded_to_unguarded_fix</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:228"><span class="id" title="variable">wcon</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wguard:230"><span class="id" title="variable">wguard</span></a>) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [? ?]. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="rebuild_wf_env" class="idref" href="#rebuild_wf_env"><span class="id" title="definition">rebuild_wf_env</span></a> {<a id="efl:231" class="idref" href="#efl:231"><span class="id" title="binder">efl</span></a>} (<a id="p:232" class="idref" href="#p:232"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a>) (<a id="hwf:233" class="idref" href="#hwf:233"><span class="id" title="binder">hwf</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:231"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:232"><span class="id" title="variable">p</span></a>): <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram_env"><span class="id" title="definition">eprogram_env</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">GlobalContextMap.make</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:232"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_glob_fresh"><span class="id" title="lemma">wf_glob_fresh</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:232"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj1"><span class="id" title="definition">proj1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hwf:233"><span class="id" title="variable">hwf</span></a>))<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:232"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="preserves_expansion" class="idref" href="#preserves_expansion"><span class="id" title="definition">preserves_expansion</span></a> <a id="with_fix:234" class="idref" href="#with_fix:234"><span class="id" title="binder">with_fix</span></a> <a id="p:235" class="idref" href="#p:235"><span class="id" title="binder">p</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:234"><span class="id" title="variable">with_fix</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:235"><span class="id" title="variable">p</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:235"><span class="id" title="variable">p</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="preserves_expansion_env" class="idref" href="#preserves_expansion_env"><span class="id" title="definition">preserves_expansion_env</span></a> <a id="with_fix:236" class="idref" href="#with_fix:236"><span class="id" title="binder">with_fix</span></a> <a id="p:237" class="idref" href="#p:237"><span class="id" title="binder">p</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:236"><span class="id" title="variable">with_fix</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:237"><span class="id" title="variable">p</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:237"><span class="id" title="variable">p</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="rebuild_wf_env_transform" class="idref" href="#rebuild_wf_env_transform"><span class="id" title="definition">rebuild_wf_env_transform</span></a> {<a id="fl:238" class="idref" href="#fl:238"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="efl:239" class="idref" href="#efl:239"><span class="id" title="binder">efl</span></a>} (<a id="with_exp:240" class="idref" href="#with_exp:240"><span class="id" title="binder">with_exp</span></a> <a id="with_fix:241" class="idref" href="#with_fix:241"><span class="id" title="binder">with_fix</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:238"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:238"><span class="id" title="variable">fl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "rebuilding environment lookup table";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:242" class="idref" href="#p:242"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:239"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:242"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_exp:240"><span class="id" title="variable">with_exp</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#preserves_expansion"><span class="id" title="definition">preserves_expansion</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:241"><span class="id" title="variable">with_fix</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:242"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:243" class="idref" href="#p:243"><span class="id" title="binder">p</span></a> <a id="pre:244" class="idref" href="#pre:244"><span class="id" title="binder">pre</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#rebuild_wf_env"><span class="id" title="definition">rebuild_wf_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:243"><span class="id" title="variable">p</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#proj1"><span class="id" title="definition">proj1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#pre:244"><span class="id" title="variable">pre</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:245" class="idref" href="#p:245"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:239"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:245"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_exp:240"><span class="id" title="variable">with_exp</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#preserves_expansion_env"><span class="id" title="definition">preserves_expansion_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:241"><span class="id" title="variable">with_fix</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:245"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:246" class="idref" href="#p:246"><span class="id" title="binder">p</span></a> <a id="hp:247" class="idref" href="#hp:247"><span class="id" title="binder">hp</span></a> <a id="p':248" class="idref" href="#p':248"><span class="id" title="binder">p'</span></a> <a id="v:249" class="idref" href="#v:249"><span class="id" title="binder">v</span></a> <a id="v':250" class="idref" href="#v':250"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:249"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':250"><span class="id" title="variable">v'</span></a> |}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#preserves_expansion"><span class="id" title="definition">preserves_expansion</span></a>, <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#preserves_expansion_env"><span class="id" title="definition">preserves_expansion_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">fl</span> <span class="id" title="var">efl</span> [] [] <span class="id" title="var">input</span> [<span class="id" title="keyword">wf</span> <span class="id" title="var">exp</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">fl</span> <span class="id" title="var">efl</span> [] [] <span class="id" title="var">input</span> <span class="id" title="var">v</span> [] <span class="id" title="var">ev</span> <span class="id" title="var">p'</span>; <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="rebuild_wf_env_extends" class="idref" href="#rebuild_wf_env_extends"><span class="id" title="instance">rebuild_wf_env_extends</span></a> {<a id="fl:251" class="idref" href="#fl:251"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="efl:252" class="idref" href="#efl:252"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} <a id="with_exp:253" class="idref" href="#with_exp:253"><span class="id" title="binder">with_exp</span></a> <a id="with_fix:254" class="idref" href="#with_fix:254"><span class="id" title="binder">with_fix</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#rebuild_wf_env_transform"><span class="id" title="definition">rebuild_wf_env_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_exp:253"><span class="id" title="variable">with_exp</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:254"><span class="id" title="variable">with_fix</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:257" class="idref" href="#p:257"><span class="id" title="binder">p</span></a> <a id="p':258" class="idref" href="#p':258"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:257"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':258"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:255" class="idref" href="#p:255"><span class="id" title="binder">p</span></a> <a id="p':256" class="idref" href="#p':256"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:255"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':256"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">red</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="rebuild_wf_env_extends'" class="idref" href="#rebuild_wf_env_extends'"><span class="id" title="instance">rebuild_wf_env_extends'</span></a> {<a id="fl:259" class="idref" href="#fl:259"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="efl:260" class="idref" href="#efl:260"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} <a id="with_exp:261" class="idref" href="#with_exp:261"><span class="id" title="binder">with_exp</span></a> <a id="with_fix:262" class="idref" href="#with_fix:262"><span class="id" title="binder">with_fix</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#rebuild_wf_env_transform"><span class="id" title="definition">rebuild_wf_env_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_exp:261"><span class="id" title="variable">with_exp</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#with_fix:262"><span class="id" title="variable">with_fix</span></a>) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [? ?]. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="remove_params_optimization" class="idref" href="#remove_params_optimization"><span class="id" title="definition">remove_params_optimization</span></a> {<a id="fl:263" class="idref" href="#fl:263"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="wcon:264" class="idref" href="#wcon:264"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:265" class="idref" href="#efl:265"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:263"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:263"><span class="id" title="variable">fl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "stripping constructor parameters (using a view)";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:267" class="idref" href="#p:267"><span class="id" title="binder">p</span></a> <a id="pre:268" class="idref" href="#pre:268"><span class="id" title="binder">pre</span></a> := <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program"><span class="id" title="definition">ERemoveParams.strip_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:267"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:266" class="idref" href="#p:266"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:265"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:266"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:266"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:269" class="idref" href="#p:269"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#switch_no_params"><span class="id" title="definition">switch_no_params</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:265"><span class="id" title="variable">efl</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:269"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:269"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:270" class="idref" href="#p:270"><span class="id" title="binder">p</span></a> <a id="hp:271" class="idref" href="#hp:271"><span class="id" title="binder">hp</span></a> <a id="p':272" class="idref" href="#p':272"><span class="id" title="binder">p'</span></a> <a id="v:273" class="idref" href="#v:273"><span class="id" title="binder">v</span></a> <a id="v':274" class="idref" href="#v':274"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':274"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">ERemoveParams.strip</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:270"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:273"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> |}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">etap</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">ERemoveParams.strip</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program_wf"><span class="id" title="lemma">ERemoveParams.strip_program_wf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program_expanded"><span class="id" title="lemma">ERemoveParams.strip_program_expanded</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ ? <span class="id" title="var">wcon</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [[<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] <span class="id" title="var">etap</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_eval"><span class="id" title="lemma">ERemoveParams.strip_eval</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ /= //. <span class="id" title="var">now</span> <span class="id" title="var">sq</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">etap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">etap</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_params_extends" class="idref" href="#remove_params_extends"><span class="id" title="instance">remove_params_extends</span></a> {<a id="fl:275" class="idref" href="#fl:275"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>}  {<a id="wcon:276" class="idref" href="#wcon:276"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:277" class="idref" href="#efl:277"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_params_optimization"><span class="id" title="definition">remove_params_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:276"><span class="id" title="variable">wcon</span></a>)) (<span class="id" title="keyword">fun</span> <a id="p:280" class="idref" href="#p:280"><span class="id" title="binder">p</span></a> <a id="p':281" class="idref" href="#p':281"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:280"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':281"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:278" class="idref" href="#p:278"><span class="id" title="binder">p</span></a> <a id="p':279" class="idref" href="#p':279"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:278"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':279"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program"><span class="id" title="definition">strip_program</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_env"><span class="id" title="definition">strip_env</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">strip</span></a>]. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends_env"><span class="id" title="lemma">strip_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_params_extends'" class="idref" href="#remove_params_extends'"><span class="id" title="instance">remove_params_extends'</span></a> {<a id="fl:282" class="idref" href="#fl:282"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>}  {<a id="wcon:283" class="idref" href="#wcon:283"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:284" class="idref" href="#efl:284"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_params_optimization"><span class="id" title="definition">remove_params_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:283"><span class="id" title="variable">wcon</span></a>)) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq</span>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program"><span class="id" title="definition">strip_program</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_env"><span class="id" title="definition">strip_env</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">strip</span></a>]. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends_env"><span class="id" title="lemma">strip_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_env"><span class="id" title="definition">strip_env</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">strip</span></a>]. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends"><span class="id" title="lemma">strip_extends</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="remove_params_fast_optimization" class="idref" href="#remove_params_fast_optimization"><span class="id" title="definition">remove_params_fast_optimization</span></a> {<a id="fl:285" class="idref" href="#fl:285"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>} {<a id="wcon:286" class="idref" href="#wcon:286"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:287" class="idref" href="#efl:287"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:285"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:285"><span class="id" title="variable">fl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "stripping constructor parameters (using accumulators)";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:289" class="idref" href="#p:289"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_env"><span class="id" title="definition">ERemoveParams.Fast.strip_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:289"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip"><span class="id" title="definition">ERemoveParams.Fast.strip</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:289"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:289"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:288" class="idref" href="#p:288"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:287"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:288"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:288"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:290" class="idref" href="#p:290"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#switch_no_params"><span class="id" title="definition">switch_no_params</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:287"><span class="id" title="variable">efl</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:290"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:290"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:291" class="idref" href="#p:291"><span class="id" title="binder">p</span></a> <a id="hp:292" class="idref" href="#hp:292"><span class="id" title="binder">hp</span></a> <a id="p':293" class="idref" href="#p':293"><span class="id" title="binder">p'</span></a> <a id="v:294" class="idref" href="#v:294"><span class="id" title="binder">v</span></a> <a id="v':295" class="idref" href="#v':295"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':295"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">ERemoveParams.strip</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:291"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:294"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> |}.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">etap</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip"><span class="id" title="definition">ERemoveParams.strip</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_fast</span></a> -<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_env_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_env_fast</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program_wf"><span class="id" title="lemma">ERemoveParams.strip_program_wf</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_program_expanded"><span class="id" title="lemma">ERemoveParams.strip_program_expanded</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ ? <span class="id" title="var">wcon</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [[<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] <span class="id" title="var">etap</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_fast</span></a> -<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_env_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_env_fast</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_eval"><span class="id" title="lemma">ERemoveParams.strip_eval</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ /= //.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">sq</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">etap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">etap</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_params_fast_extends" class="idref" href="#remove_params_fast_extends"><span class="id" title="instance">remove_params_fast_extends</span></a> {<a id="fl:296" class="idref" href="#fl:296"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>}  {<a id="wcon:297" class="idref" href="#wcon:297"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:298" class="idref" href="#efl:298"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_params_fast_optimization"><span class="id" title="definition">remove_params_fast_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:297"><span class="id" title="variable">wcon</span></a>)) (<span class="id" title="keyword">fun</span> <a id="p:301" class="idref" href="#p:301"><span class="id" title="binder">p</span></a> <a id="p':302" class="idref" href="#p':302"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:301"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':302"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:299" class="idref" href="#p:299"><span class="id" title="binder">p</span></a> <a id="p':300" class="idref" href="#p':300"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:299"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':300"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -!<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_env_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_env_fast</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends_env"><span class="id" title="lemma">strip_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_params_fast_extends'" class="idref" href="#remove_params_fast_extends'"><span class="id" title="instance">remove_params_fast_extends'</span></a> {<a id="fl:303" class="idref" href="#fl:303"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">EWcbvEval.WcbvFlags</span></a>}  {<a id="wcon:304" class="idref" href="#wcon:304"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;(<a id="efl:305" class="idref" href="#efl:305"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_params_fast_optimization"><span class="id" title="definition">remove_params_fast_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:304"><span class="id" title="variable">wcon</span></a>)) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq</span>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -!<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_env_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_env_fast</span></a> -!<a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#Fast.strip_fast"><span class="id" title="lemma">ERemoveParams.Fast.strip_fast</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> ⇒ /=. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends_env"><span class="id" title="lemma">strip_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#strip_extends"><span class="id" title="lemma">strip_extends</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#"><span class="id" title="module">EOptimizePropDiscr</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#"><span class="id" title="module">EWcbvEval</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="remove_match_on_box_trans" class="idref" href="#remove_match_on_box_trans"><span class="id" title="definition">remove_match_on_box_trans</span></a> {<a id="fl:306" class="idref" href="#fl:306"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:307" class="idref" href="#wcon:307"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:308" class="idref" href="#efl:308"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="hastrel:309" class="idref" href="#hastrel:309"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:310" class="idref" href="#hastbox:310"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:306"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#disable_prop_cases"><span class="id" title="definition">disable_prop_cases</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:306"><span class="id" title="variable">fl</span></a>)) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "optimize_prop_discr";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:312" class="idref" href="#p:312"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program"><span class="id" title="definition">remove_match_on_box_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:312"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:311" class="idref" href="#p:311"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:308"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:311"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:311"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:313" class="idref" href="#p:313"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:308"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:313"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:313"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:314" class="idref" href="#p:314"><span class="id" title="binder">p</span></a> <a id="hp:315" class="idref" href="#hp:315"><span class="id" title="binder">hp</span></a> <a id="p':316" class="idref" href="#p':316"><span class="id" title="binder">p'</span></a> <a id="v:317" class="idref" href="#v:317"><span class="id" title="binder">v</span></a> <a id="v':318" class="idref" href="#v':318"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':318"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:314"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:317"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">etap</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program_wf"><span class="id" title="definition">remove_match_on_box_program_wf</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program_expanded"><span class="id" title="definition">remove_match_on_box_program_expanded</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_correct"><span class="id" title="lemma">EOptimizePropDiscr.remove_match_on_box_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="tactic">red</span>. <span class="id" title="var">sq</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>, <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>, <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_match_on_box_extends" class="idref" href="#remove_match_on_box_extends"><span class="id" title="instance">remove_match_on_box_extends</span></a>  {<a id="fl:319" class="idref" href="#fl:319"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:320" class="idref" href="#wcon:320"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:321" class="idref" href="#efl:321"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="hastrel:322" class="idref" href="#hastrel:322"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:323" class="idref" href="#hastbox:323"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_trans"><span class="id" title="definition">remove_match_on_box_trans</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:320"><span class="id" title="variable">wcon</span></a>) (<span class="id" title="var">hastrel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastrel:322"><span class="id" title="variable">hastrel</span></a>) (<span class="id" title="var">hastbox</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastbox:323"><span class="id" title="variable">hastbox</span></a>)) (<span class="id" title="keyword">fun</span> <a id="p:326" class="idref" href="#p:326"><span class="id" title="binder">p</span></a> <a id="p':327" class="idref" href="#p':327"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:326"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':327"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:324" class="idref" href="#p:324"><span class="id" title="binder">p</span></a> <a id="p':325" class="idref" href="#p':325"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:324"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':325"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program"><span class="id" title="definition">remove_match_on_box_program</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_extends_env"><span class="id" title="lemma">remove_match_on_box_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="remove_match_on_box_extends'" class="idref" href="#remove_match_on_box_extends'"><span class="id" title="instance">remove_match_on_box_extends'</span></a>  {<a id="fl:328" class="idref" href="#fl:328"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:329" class="idref" href="#wcon:329"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="efl:330" class="idref" href="#efl:330"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="hastrel:331" class="idref" href="#hastrel:331"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:332" class="idref" href="#hastbox:332"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#remove_match_on_box_trans"><span class="id" title="definition">remove_match_on_box_trans</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:329"><span class="id" title="variable">wcon</span></a>) (<span class="id" title="var">hastrel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastrel:331"><span class="id" title="variable">hastrel</span></a>) (<span class="id" title="var">hastbox</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastbox:332"><span class="id" title="variable">hastbox</span></a>)) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq</span>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_program"><span class="id" title="definition">remove_match_on_box_program</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_extends_env"><span class="id" title="lemma">remove_match_on_box_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#wellformed_remove_match_on_box_extends"><span class="id" title="lemma">wellformed_remove_match_on_box_extends</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#"><span class="id" title="library">EInlineProjections</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="inline_projections_optimization" class="idref" href="#inline_projections_optimization"><span class="id" title="definition">inline_projections_optimization</span></a> {<a id="fl:333" class="idref" href="#fl:333"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:334" class="idref" href="#wcon:334"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} (<a id="efl:335" class="idref" href="#efl:335"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#switch_no_params"><span class="id" title="definition">switch_no_params</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>)<br/>
&nbsp;&nbsp;{<a id="hastrel:336" class="idref" href="#hastrel:336"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:337" class="idref" href="#hastbox:337"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:333"><span class="id" title="variable">fl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#fl:333"><span class="id" title="variable">fl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "primitive projection inlining";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:339" class="idref" href="#p:339"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_program"><span class="id" title="definition">EInlineProjections.optimize_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:339"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:338" class="idref" href="#p:338"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:335"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:338"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:338"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:340" class="idref" href="#p:340"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#disable_projections_env_flag"><span class="id" title="definition">disable_projections_env_flag</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:335"><span class="id" title="variable">efl</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:340"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:340"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:341" class="idref" href="#p:341"><span class="id" title="binder">p</span></a> <a id="hp:342" class="idref" href="#hp:342"><span class="id" title="binder">hp</span></a> <a id="p':343" class="idref" href="#p':343"><span class="id" title="binder">p'</span></a> <a id="v:344" class="idref" href="#v:344"><span class="id" title="binder">v</span></a> <a id="v':345" class="idref" href="#v':345"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':345"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize"><span class="id" title="definition">EInlineProjections.optimize</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:341"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:344"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">efl</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">etap</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_program_wf"><span class="id" title="definition">optimize_program_wf</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_program_expanded"><span class="id" title="definition">optimize_program_expanded</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">fl</span> <span class="id" title="var">wcon</span> <span class="id" title="var">hastrel</span> <span class="id" title="var">hastbox</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_correct"><span class="id" title="lemma">EInlineProjections.optimize_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="tactic">red</span>. <span class="id" title="var">sq</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wfe</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">wfe</span>. <span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="inline_projections_optimization_extends" class="idref" href="#inline_projections_optimization_extends"><span class="id" title="instance">inline_projections_optimization_extends</span></a> {<a id="fl:346" class="idref" href="#fl:346"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:347" class="idref" href="#wcon:347"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} (<a id="efl:348" class="idref" href="#efl:348"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#switch_no_params"><span class="id" title="definition">switch_no_params</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>)<br/>
&nbsp;&nbsp;{<a id="hastrel:349" class="idref" href="#hastrel:349"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:350" class="idref" href="#hastbox:350"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#inline_projections_optimization"><span class="id" title="definition">inline_projections_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:347"><span class="id" title="variable">wcon</span></a>) (<span class="id" title="var">hastrel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastrel:349"><span class="id" title="variable">hastrel</span></a>) (<span class="id" title="var">hastbox</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastbox:350"><span class="id" title="variable">hastbox</span></a>)) (<span class="id" title="keyword">fun</span> <a id="p:353" class="idref" href="#p:353"><span class="id" title="binder">p</span></a> <a id="p':354" class="idref" href="#p':354"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:353"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':354"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:351" class="idref" href="#p:351"><span class="id" title="binder">p</span></a> <a id="p':352" class="idref" href="#p':352"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:351"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':352"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_program"><span class="id" title="definition">optimize_program</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_extends_env"><span class="id" title="lemma">optimize_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="inline_projections_optimization_extends'" class="idref" href="#inline_projections_optimization_extends'"><span class="id" title="instance">inline_projections_optimization_extends'</span></a> {<a id="fl:355" class="idref" href="#fl:355"><span class="id" title="binder">fl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>} {<a id="wcon:356" class="idref" href="#wcon:356"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">EWcbvEval.with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} (<a id="efl:357" class="idref" href="#efl:357"><span class="id" title="binder">efl</span></a> := <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#switch_no_params"><span class="id" title="definition">switch_no_params</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">all_env_flags</span></a>)<br/>
&nbsp;&nbsp;{<a id="hastrel:358" class="idref" href="#hastrel:358"><span class="id" title="binder">hastrel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="hastbox:359" class="idref" href="#hastbox:359"><span class="id" title="binder">hastbox</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#inline_projections_optimization"><span class="id" title="definition">inline_projections_optimization</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:356"><span class="id" title="variable">wcon</span></a>) (<span class="id" title="var">hastrel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastrel:358"><span class="id" title="variable">hastrel</span></a>) (<span class="id" title="var">hastbox</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#hastbox:359"><span class="id" title="variable">hastbox</span></a>)) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq</span>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /= /<a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_program"><span class="id" title="definition">optimize_program</span></a> /=. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#optimize_extends_env"><span class="id" title="lemma">optimize_extends_env</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EInlineProjections.html#wellformed_optimize_extends"><span class="id" title="lemma">wellformed_optimize_extends</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#"><span class="id" title="library">EConstructorsAsBlocks</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="constructors_as_blocks_transformation" class="idref" href="#constructors_as_blocks_transformation"><span class="id" title="definition">constructors_as_blocks_transformation</span></a> {<a id="efl:360" class="idref" href="#efl:360"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>}<br/>
&nbsp;&nbsp;{<a id="has_app:361" class="idref" href="#has_app:361"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_rel:362" class="idref" href="#has_rel:362"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_box:363" class="idref" href="#has_box:363"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_pars:364" class="idref" href="#has_pars:364"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_cstrblocks:365" class="idref" href="#has_cstrblocks:365"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#target_wcbv_flags"><span class="id" title="definition">target_wcbv_flags</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#block_wcbv_flags"><span class="id" title="definition">block_wcbv_flags</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "transforming to constuctors as blocks";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:367" class="idref" href="#p:367"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_program"><span class="id" title="definition">EConstructorsAsBlocks.transform_blocks_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:367"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:366" class="idref" href="#p:366"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:360"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:366"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:366"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:368" class="idref" href="#p:368"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#switch_cstr_as_blocks"><span class="id" title="definition">switch_cstr_as_blocks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:360"><span class="id" title="variable">efl</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:368"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:369" class="idref" href="#p:369"><span class="id" title="binder">p</span></a> <a id="hp:370" class="idref" href="#hp:370"><span class="id" title="binder">hp</span></a> <a id="p':371" class="idref" href="#p':371"><span class="id" title="binder">p'</span></a> <a id="v:372" class="idref" href="#v:372"><span class="id" title="binder">v</span></a> <a id="v':373" class="idref" href="#v':373"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':373"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks"><span class="id" title="definition">EConstructorsAsBlocks.transform_blocks</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:369"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:372"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">hasrel</span> <span class="id" title="var">hasbox</span> <span class="id" title="var">haspars</span> <span class="id" title="var">hascstrs</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [] [<span class="id" title="var">wftp</span> <span class="id" title="var">wft</span>] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">etap</span> <span class="id" title="var">etat</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_wf_global"><span class="id" title="lemma">transform_wf_global</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_wellformed"><span class="id" title="lemma">transform_wellformed</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">hasrel</span> <span class="id" title="var">hasbox</span> <span class="id" title="var">haspars</span> <span class="id" title="var">hascstrs</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [[<span class="id" title="var">wfe1</span> <span class="id" title="var">wfe2</span>] <span class="id" title="var">wft</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; [ | <span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">EEtaExpanded.expanded_eprogram_env_cstrs</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">wft</span>. <span class="id" title="tactic">move</span> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> // [<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks"><span class="id" title="definition">transform_blocks</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_eval"><span class="id" title="lemma">transform_blocks_eval</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="constructors_as_blocks_extends" class="idref" href="#constructors_as_blocks_extends"><span class="id" title="instance">constructors_as_blocks_extends</span></a> (<a id="efl:374" class="idref" href="#efl:374"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="has_app:375" class="idref" href="#has_app:375"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_rel:376" class="idref" href="#has_rel:376"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_box:377" class="idref" href="#has_box:377"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_pars:378" class="idref" href="#has_pars:378"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_cstrblocks:379" class="idref" href="#has_cstrblocks:379"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#constructors_as_blocks_transformation"><span class="id" title="definition">constructors_as_blocks_transformation</span></a> (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:375"><span class="id" title="variable">has_app</span></a>) (<span class="id" title="var">has_rel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_rel:376"><span class="id" title="variable">has_rel</span></a>) (<span class="id" title="var">has_box</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_box:377"><span class="id" title="variable">has_box</span></a>) (<span class="id" title="var">has_pars</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_pars:378"><span class="id" title="variable">has_pars</span></a>) (<span class="id" title="var">has_cstrblocks</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_cstrblocks:379"><span class="id" title="variable">has_cstrblocks</span></a>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:382" class="idref" href="#p:382"><span class="id" title="binder">p</span></a> <a id="p':383" class="idref" href="#p':383"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:382"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':383"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:380" class="idref" href="#p:380"><span class="id" title="binder">p</span></a> <a id="p':381" class="idref" href="#p':381"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:380"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':381"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_env_extends"><span class="id" title="lemma">transform_blocks_env_extends</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="constructors_as_blocks_extends'" class="idref" href="#constructors_as_blocks_extends'"><span class="id" title="instance">constructors_as_blocks_extends'</span></a> (<a id="efl:384" class="idref" href="#efl:384"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="has_app:385" class="idref" href="#has_app:385"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_rel:386" class="idref" href="#has_rel:386"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_box:387" class="idref" href="#has_box:387"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_pars:388" class="idref" href="#has_pars:388"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_cstrblocks:389" class="idref" href="#has_cstrblocks:389"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#constructors_as_blocks_transformation"><span class="id" title="definition">constructors_as_blocks_transformation</span></a> (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:385"><span class="id" title="variable">has_app</span></a>) (<span class="id" title="var">has_rel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_rel:386"><span class="id" title="variable">has_rel</span></a>) (<span class="id" title="var">has_box</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_box:387"><span class="id" title="variable">has_box</span></a>) (<span class="id" title="var">has_pars</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_pars:388"><span class="id" title="variable">has_pars</span></a>) (<span class="id" title="var">has_cstrblocks</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_cstrblocks:389"><span class="id" title="variable">has_cstrblocks</span></a>))<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq</span>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_env_extends"><span class="id" title="lemma">transform_blocks_env_extends</span></a> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_program"><span class="id" title="definition">transform_blocks_program</span></a> ⇒ /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks_extends"><span class="id" title="lemma">transform_blocks_extends</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#"><span class="id" title="library">ECoInductiveToInductive</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="coinductive_to_inductive_transformation" class="idref" href="#coinductive_to_inductive_transformation"><span class="id" title="definition">coinductive_to_inductive_transformation</span></a> (<a id="efl:390" class="idref" href="#efl:390"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="has_app:391" class="idref" href="#has_app:391"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_box:392" class="idref" href="#has_box:392"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_rel:393" class="idref" href="#has_rel:393"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_pars:394" class="idref" href="#has_pars:394"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}<br/>
&nbsp;&nbsp;{<a id="has_cstrblocks:395" class="idref" href="#has_cstrblocks:395"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#block_wcbv_flags"><span class="id" title="definition">block_wcbv_flags</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#block_wcbv_flags"><span class="id" title="definition">block_wcbv_flags</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "transforming co-inductive to lazy inductive types";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:397" class="idref" href="#p:397"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trans_program"><span class="id" title="definition">ECoInductiveToInductive.trans_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:397"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:396" class="idref" href="#p:396"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:390"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:396"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:398" class="idref" href="#p:398"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:390"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:398"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:399" class="idref" href="#p:399"><span class="id" title="binder">p</span></a> <a id="hp:400" class="idref" href="#hp:400"><span class="id" title="binder">hp</span></a> <a id="p':401" class="idref" href="#p':401"><span class="id" title="binder">p'</span></a> <a id="v:402" class="idref" href="#v:402"><span class="id" title="binder">v</span></a> <a id="v':403" class="idref" href="#v':403"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':403"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trans"><span class="id" title="definition">ECoInductiveToInductive.trans</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:399"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:402"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">hasbox</span> <span class="id" title="var">hasrel</span> <span class="id" title="var">haspars</span> <span class="id" title="var">hascstrs</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] [<span class="id" title="var">wftp</span> <span class="id" title="var">wft</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trans_program_wf"><span class="id" title="definition">ECoInductiveToInductive.trans_program_wf</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">hasbox</span> <span class="id" title="var">hasrel</span> <span class="id" title="var">haspars</span> <span class="id" title="var">hascstrs</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">t</span>] /= <span class="id" title="var">v</span> [<span class="id" title="var">wfe1</span> <span class="id" title="var">wfe2</span>] [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; [ | <span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.EConstructorsAsBlocks.html#transform_blocks"><span class="id" title="definition">transform_blocks</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trans_correct"><span class="id" title="lemma">ECoInductiveToInductive.trans_correct</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">wellformed_closed_env</span></a>, <span class="id" title="var">wfe1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">all</span>:<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="coinductive_to_inductive_transformation_ext" class="idref" href="#coinductive_to_inductive_transformation_ext"><span class="id" title="instance">coinductive_to_inductive_transformation_ext</span></a> (<a id="efl:404" class="idref" href="#efl:404"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="has_app:405" class="idref" href="#has_app:405"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_rel:406" class="idref" href="#has_rel:406"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_box:407" class="idref" href="#has_box:407"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_pars:408" class="idref" href="#has_pars:408"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_cstrblocks:409" class="idref" href="#has_cstrblocks:409"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#coinductive_to_inductive_transformation"><span class="id" title="definition">coinductive_to_inductive_transformation</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:404"><span class="id" title="variable">efl</span></a> (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:405"><span class="id" title="variable">has_app</span></a>) (<span class="id" title="var">has_rel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_rel:406"><span class="id" title="variable">has_rel</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">has_box</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_box:407"><span class="id" title="variable">has_box</span></a>) (<span class="id" title="var">has_pars</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_pars:408"><span class="id" title="variable">has_pars</span></a>) (<span class="id" title="var">has_cstrblocks</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_cstrblocks:409"><span class="id" title="variable">has_cstrblocks</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:412" class="idref" href="#p:412"><span class="id" title="binder">p</span></a> <a id="p':413" class="idref" href="#p':413"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:412"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':413"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:410" class="idref" href="#p:410"><span class="id" title="binder">p</span></a> <a id="p':411" class="idref" href="#p':411"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:410"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':411"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trust_cofix"><span class="id" title="axiom">ECoInductiveToInductive.trust_cofix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="coinductive_to_inductive_transformation_ext'" class="idref" href="#coinductive_to_inductive_transformation_ext'"><span class="id" title="instance">coinductive_to_inductive_transformation_ext'</span></a> (<a id="efl:414" class="idref" href="#efl:414"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="has_app:415" class="idref" href="#has_app:415"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} {<a id="has_rel:416" class="idref" href="#has_rel:416"><span class="id" title="binder">has_rel</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tRel"><span class="id" title="method">has_tRel</span></a>} {<a id="has_box:417" class="idref" href="#has_box:417"><span class="id" title="binder">has_box</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tBox"><span class="id" title="method">has_tBox</span></a>} {<a id="has_pars:418" class="idref" href="#has_pars:418"><span class="id" title="binder">has_pars</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_cstr_params"><span class="id" title="method">has_cstr_params</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_cstrblocks:419" class="idref" href="#has_cstrblocks:419"><span class="id" title="binder">has_cstrblocks</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#coinductive_to_inductive_transformation"><span class="id" title="definition">coinductive_to_inductive_transformation</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:414"><span class="id" title="variable">efl</span></a> (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:415"><span class="id" title="variable">has_app</span></a>) (<span class="id" title="var">has_rel</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_rel:416"><span class="id" title="variable">has_rel</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">has_box</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_box:417"><span class="id" title="variable">has_box</span></a>) (<span class="id" title="var">has_pars</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_pars:418"><span class="id" title="variable">has_pars</span></a>) (<span class="id" title="var">has_cstrblocks</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_cstrblocks:419"><span class="id" title="variable">has_cstrblocks</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ECoInductiveToInductive.html#trust_cofix"><span class="id" title="axiom">ECoInductiveToInductive.trust_cofix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#"><span class="id" title="library">EReorderCstrs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_eprogram_mapping" class="idref" href="#eval_eprogram_mapping"><span class="id" title="definition">eval_eprogram_mapping</span></a> (<a id="wfl:420" class="idref" href="#wfl:420"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>) (<a id="p:421" class="idref" href="#p:421"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a>) <a id="t:422" class="idref" href="#t:422"><span class="id" title="binder">t</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:420"><span class="id" title="variable">wfl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:421"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:422"><span class="id" title="variable">t</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eval_eprogram_env_mapping" class="idref" href="#eval_eprogram_env_mapping"><span class="id" title="definition">eval_eprogram_env_mapping</span></a> (<a id="wfl:423" class="idref" href="#wfl:423"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>) (<a id="p:424" class="idref" href="#p:424"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram_env"><span class="id" title="definition">eprogram_env</span></a>) <a id="t:425" class="idref" href="#t:425"><span class="id" title="binder">t</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:423"><span class="id" title="variable">wfl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:424"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#t:425"><span class="id" title="variable">t</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="to_program" class="idref" href="#to_program"><span class="id" title="definition">to_program</span></a> (<a id="e:426" class="idref" href="#e:426"><span class="id" title="binder">e</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram_env"><span class="id" title="definition">eprogram_env</span></a>) : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#e:426"><span class="id" title="variable">e</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#e:426"><span class="id" title="variable">e</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="reorder_cstrs_transformation" class="idref" href="#reorder_cstrs_transformation"><span class="id" title="definition">reorder_cstrs_transformation</span></a> {<a id="efl:427" class="idref" href="#efl:427"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="wca:428" class="idref" href="#wca:428"><span class="id" title="binder">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} {<a id="has_app:429" class="idref" href="#has_app:429"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>}<br/>
&nbsp;&nbsp;(<a id="wfl:430" class="idref" href="#wfl:430"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>) {<a id="wcon:431" class="idref" href="#wcon:431"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval_eprogram_env_mapping"><span class="id" title="definition">eval_eprogram_env_mapping</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:430"><span class="id" title="variable">wfl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:430"><span class="id" title="variable">wfl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "reorder inductive constructors ";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:433" class="idref" href="#p:433"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program"><span class="id" title="definition">EReorderCstrs.reorder_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:433"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#to_program"><span class="id" title="definition">to_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:433"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:432" class="idref" href="#p:432"><span class="id" title="binder">p</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:427"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:432"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram_env"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:432"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:432"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:432"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:434" class="idref" href="#p:434"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:427"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:434"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">EEtaExpandedFix.expanded_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:434"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:435" class="idref" href="#p:435"><span class="id" title="binder">p</span></a> <a id="hp:436" class="idref" href="#hp:436"><span class="id" title="binder">hp</span></a> <a id="p':437" class="idref" href="#p':437"><span class="id" title="binder">p'</span></a> <a id="v:438" class="idref" href="#v:438"><span class="id" title="binder">v</span></a> <a id="v':439" class="idref" href="#v':439"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':439"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">EReorderCstrs.reorder</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:435"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:438"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">wca</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">wfl</span> <span class="id" title="var">wcb</span> [<span class="id" title="var">m</span> <span class="id" title="var">p</span>] [<span class="id" title="var">wfp</span> <span class="id" title="var">exp</span> <span class="id" title="var">wfm</span>]. <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program_wf"><span class="id" title="definition">reorder_program_wf</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program_expanded_fix"><span class="id" title="definition">reorder_program_expanded_fix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">efl</span> <span class="id" title="var">wca</span> <span class="id" title="var">hasapp</span> <span class="id" title="var">wfl</span> <span class="id" title="var">wcb</span> [<span class="id" title="var">m</span> <span class="id" title="var">p</span>] <span class="id" title="var">v</span> [<span class="id" title="var">wfp</span> <span class="id" title="var">wfm</span>] <span class="id" title="var">evp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">evp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ev</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_correct"><span class="id" title="lemma">EReorderCstrs.optimize_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>; <span class="id" title="var">trea</span>.<br/>
&nbsp;&nbsp;2,3:<span class="id" title="tactic">apply</span> <span class="id" title="var">wfp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">m</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="reorder_cstrs_transformation_ext" class="idref" href="#reorder_cstrs_transformation_ext"><span class="id" title="instance">reorder_cstrs_transformation_ext</span></a> {<a id="efl:440" class="idref" href="#efl:440"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="wca:441" class="idref" href="#wca:441"><span class="id" title="binder">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a id="has_app:442" class="idref" href="#has_app:442"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>) (<a id="wfl:443" class="idref" href="#wfl:443"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="wcon:444" class="idref" href="#wcon:444"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reorder_cstrs_transformation"><span class="id" title="definition">reorder_cstrs_transformation</span></a> (<span class="id" title="var">wca</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wca:441"><span class="id" title="variable">wca</span></a>) (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:442"><span class="id" title="variable">has_app</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:443"><span class="id" title="variable">wfl</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:444"><span class="id" title="variable">wcon</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:447" class="idref" href="#p:447"><span class="id" title="binder">p</span></a> <a id="p':448" class="idref" href="#p':448"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:447"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':448"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:447"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':448"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:445" class="idref" href="#p:445"><span class="id" title="binder">p</span></a> <a id="p':446" class="idref" href="#p':446"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:445"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':446"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">eq</span> <span class="id" title="var">ext</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_extends_env"><span class="id" title="lemma">EReorderCstrs.optimize_extends_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">pr'</span>; <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> []. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="reorder_cstrs_transformation_ext'" class="idref" href="#reorder_cstrs_transformation_ext'"><span class="id" title="instance">reorder_cstrs_transformation_ext'</span></a> {<a id="efl:449" class="idref" href="#efl:449"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="wca:450" class="idref" href="#wca:450"><span class="id" title="binder">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>) (<a id="has_app:451" class="idref" href="#has_app:451"><span class="id" title="binder">has_app</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>) (<a id="wfl:452" class="idref" href="#wfl:452"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>)<br/>
&nbsp;&nbsp;{<a id="wcon:453" class="idref" href="#wcon:453"><span class="id" title="binder">wcon</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#reorder_cstrs_transformation"><span class="id" title="definition">reorder_cstrs_transformation</span></a> (<span class="id" title="var">wca</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wca:450"><span class="id" title="variable">wca</span></a>) (<span class="id" title="var">has_app</span> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#has_app:451"><span class="id" title="variable">has_app</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:452"><span class="id" title="variable">wfl</span></a> (<span class="id" title="var">wcon</span>:=<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wcon:453"><span class="id" title="variable">wcon</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:454" class="idref" href="#p:454"><span class="id" title="binder">p</span></a> <a id="p':455" class="idref" href="#p':455"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:454"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':455"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:454"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':455"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pr'</span> [<span class="id" title="var">eq</span> [<span class="id" title="var">ext</span> <span class="id" title="var">eq'</span>]]. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq</span> -<span class="id" title="var">eq'</span>. <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_extends_env"><span class="id" title="lemma">EReorderCstrs.optimize_extends_env</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">pr'</span>; <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> []. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pr'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EUnboxing.html#"><span class="id" title="library">EUnboxing</span></a>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <a id="trust_unboxing_wf" class="idref" href="#trust_unboxing_wf"><span class="id" title="axiom">trust_unboxing_wf</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="efl:456" class="idref" href="#efl:456"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="input:457" class="idref" href="#input:457"><span class="id" title="binder">input</span></a> : <a class="idref" href="MetaRocq.Common.Transform.html#Transform.program"><span class="id" title="definition">Transform.program</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:456"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#input:457"><span class="id" title="variable">input</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:456"><span class="id" title="variable">efl</span></a> (<a class="idref" href="MetaRocq.Erasure.EUnboxing.html#unbox_program"><span class="id" title="definition">unbox_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#input:457"><span class="id" title="variable">input</span></a>).<br/>
<span class="id" title="keyword">Axiom</span> <a id="trust_unboxing_pres" class="idref" href="#trust_unboxing_pres"><span class="id" title="axiom">trust_unboxing_pres</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="efl:460" class="idref" href="#efl:460"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>) (<a id="wfl:461" class="idref" href="#wfl:461"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>) (<a id="p:462" class="idref" href="#p:462"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Common.Transform.html#Transform.program"><span class="id" title="definition">Transform.program</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>)<br/>
&nbsp;&nbsp;(<a id="v:463" class="idref" href="#v:463"><span class="id" title="binder">v</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:460"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:462"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:461"><span class="id" title="variable">wfl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:462"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:463"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v':464" class="idref" href="#v':464"><span class="id" title="binder">v'</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:461"><span class="id" title="variable">wfl</span></a> (<a class="idref" href="MetaRocq.Erasure.EUnboxing.html#unbox_program"><span class="id" title="definition">unbox_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:462"><span class="id" title="variable">p</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':464"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':464"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EUnboxing.html#unbox"><span class="id" title="definition">unbox</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:462"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:463"><span class="id" title="variable">v</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="unbox_transformation" class="idref" href="#unbox_transformation"><span class="id" title="definition">unbox_transformation</span></a> (<a id="efl:467" class="idref" href="#efl:467"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>) (<a id="wfl:468" class="idref" href="#wfl:468"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>)  :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">EAst.term</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram_env"><span class="id" title="definition">eval_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:468"><span class="id" title="variable">wfl</span></a>) (<a class="idref" href="MetaRocq.Erasure.EProgram.html#eval_eprogram"><span class="id" title="definition">eval_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:468"><span class="id" title="variable">wfl</span></a>) :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := "unbox singleton constructors ";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:470" class="idref" href="#p:470"><span class="id" title="binder">p</span></a> <span class="id" title="var">_</span> := <a class="idref" href="MetaRocq.Erasure.EUnboxing.html#unbox_program"><span class="id" title="definition">EUnboxing.unbox_program</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:470"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> <a id="p:469" class="idref" href="#p:469"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram_env"><span class="id" title="definition">wf_eprogram_env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:467"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:469"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> <a id="p:471" class="idref" href="#p:471"><span class="id" title="binder">p</span></a> := <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:467"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:471"><span class="id" title="variable">p</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:472" class="idref" href="#p:472"><span class="id" title="binder">p</span></a> <a id="hp:473" class="idref" href="#hp:473"><span class="id" title="binder">hp</span></a> <a id="p':474" class="idref" href="#p':474"><span class="id" title="binder">p'</span></a> <a id="v:475" class="idref" href="#v:475"><span class="id" title="binder">v</span></a> <a id="v':476" class="idref" href="#v':476"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':476"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EUnboxing.html#unbox"><span class="id" title="definition">unbox</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:472"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:475"><span class="id" title="variable">v</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">efl</span> <span class="id" title="var">wfl</span> <span class="id" title="var">m</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trust_unboxing_wf"><span class="id" title="axiom">trust_unboxing_wf</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#trust_unboxing_pres"><span class="id" title="axiom">trust_unboxing_pres</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Axiom</span> <a id="trust_unbox_transformation_ext" class="idref" href="#trust_unbox_transformation_ext"><span class="id" title="axiom">trust_unbox_transformation_ext</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="efl:477" class="idref" href="#efl:477"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>) (<a id="wfl:478" class="idref" href="#wfl:478"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#unbox_transformation"><span class="id" title="definition">unbox_transformation</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:477"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:478"><span class="id" title="variable">wfl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="p:481" class="idref" href="#p:481"><span class="id" title="binder">p</span></a> <a id="p':482" class="idref" href="#p':482"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:481"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':482"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) (<span class="id" title="keyword">fun</span> <a id="p:479" class="idref" href="#p:479"><span class="id" title="binder">p</span></a> <a id="p':480" class="idref" href="#p':480"><span class="id" title="binder">p'</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:479"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p':480"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>).<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Axiom</span> <a id="trust_unbox_transformation_ext'" class="idref" href="#trust_unbox_transformation_ext'"><span class="id" title="axiom">trust_unbox_transformation_ext'</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="efl:485" class="idref" href="#efl:485"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>) (<a id="wfl:486" class="idref" href="#wfl:486"><span class="id" title="binder">wfl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#WcbvFlags"><span class="id" title="class">WcbvFlags</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#unbox_transformation"><span class="id" title="definition">unbox_transformation</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#efl:485"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#wfl:486"><span class="id" title="variable">wfl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram_env"><span class="id" title="definition">extends_eprogram_env</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#extends_eprogram"><span class="id" title="definition">extends_eprogram</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="optional_transform" class="idref" href="#optional_transform"><span class="id" title="definition">optional_transform</span></a> {<a id="env:489" class="idref" href="#env:489"><span class="id" title="binder">env</span></a> <a id="env':490" class="idref" href="#env':490"><span class="id" title="binder">env'</span></a> <a id="term:491" class="idref" href="#term:491"><span class="id" title="binder">term</span></a> <a id="term':492" class="idref" href="#term':492"><span class="id" title="binder">term'</span></a> <a id="value:493" class="idref" href="#value:493"><span class="id" title="binder">value</span></a> <a id="value':494" class="idref" href="#value':494"><span class="id" title="binder">value'</span></a> <a id="eval:495" class="idref" href="#eval:495"><span class="id" title="binder">eval</span></a> <a id="eval':496" class="idref" href="#eval':496"><span class="id" title="binder">eval'</span></a>} (<a id="activate:497" class="idref" href="#activate:497"><span class="id" title="binder">activate</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;(<a id="tr:498" class="idref" href="#tr:498"><span class="id" title="binder">tr</span></a> : <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env':490"><span class="id" title="variable">env'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term':492"><span class="id" title="variable">term'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value':494"><span class="id" title="variable">value'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval':496"><span class="id" title="variable">eval'</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#activate:497"><span class="id" title="variable">activate</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env':490"><span class="id" title="variable">env'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term':492"><span class="id" title="variable">term'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value':494"><span class="id" title="variable">value'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval':496"><span class="id" title="variable">eval'</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a id="activate:499" class="idref" href="#activate:499"><span class="id" title="binder"><span id="activate:500" class="id"><span id="activate:501" class="id"><span id="activate:502" class="id">activate</span></span></span></span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">return</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#activate:499"><span class="id" title="variable">activate</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env':490"><span class="id" title="variable">env'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term':492"><span class="id" title="variable">term'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value':494"><span class="id" title="variable">value'</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval':496"><span class="id" title="variable">eval'</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.t"><span class="id" title="record">Transform.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:489"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:491"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#value:493"><span class="id" title="variable">value</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:495"><span class="id" title="variable">eval</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:498"><span class="id" title="variable">tr</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">{|</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := ("skipped " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:498"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:503" class="idref" href="#p:503"><span class="id" title="binder">p</span></a> <a id="pr:504" class="idref" href="#pr:504"><span class="id" title="binder">pr</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:503"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:498"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:498"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:505" class="idref" href="#p:505"><span class="id" title="binder">p</span></a> <a id="hp:506" class="idref" href="#hp:506"><span class="id" title="binder">hp</span></a> <a id="p':507" class="idref" href="#p':507"><span class="id" title="binder">p'</span></a> <a id="v:508" class="idref" href="#v:508"><span class="id" title="binder">v</span></a> <a id="v':509" class="idref" href="#v':509"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':509"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:508"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">|}</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="optional_self_transform" class="idref" href="#optional_self_transform"><span class="id" title="definition">optional_self_transform</span></a> {<a id="env:510" class="idref" href="#env:510"><span class="id" title="binder">env</span></a> <a id="term:511" class="idref" href="#term:511"><span class="id" title="binder">term</span></a> <a id="eval:512" class="idref" href="#eval:512"><span class="id" title="binder">eval</span></a>} (<a id="activate:513" class="idref" href="#activate:513"><span class="id" title="binder">activate</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;(<a id="tr:514" class="idref" href="#tr:514"><span class="id" title="binder">tr</span></a> : <a class="idref" href="MetaRocq.Common.Transform.html#Transform.self_transform"><span class="id" title="definition">Transform.self_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:510"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:511"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.self_transform"><span class="id" title="definition">Transform.self_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:510"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:511"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a id="activate:515" class="idref" href="#activate:515"><span class="id" title="binder"><span id="activate:516" class="id"><span id="activate:517" class="id"><span id="activate:518" class="id">activate</span></span></span></span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">return</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.self_transform"><span class="id" title="definition">Transform.self_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:510"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:511"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:512"><span class="id" title="variable">eval</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:514"><span class="id" title="variable">tr</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">{|</span></a> <a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a> := ("skipped " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:514"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.name"><span class="id" title="projection">name</span></a>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.transform"><span class="id" title="projection">transform</span></a> <a id="p:519" class="idref" href="#p:519"><span class="id" title="binder">p</span></a> <a id="pr:520" class="idref" href="#pr:520"><span class="id" title="binder">pr</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#p:519"><span class="id" title="variable">p</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:514"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.post"><span class="id" title="projection">post</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:514"><span class="id" title="variable">tr</span></a>.(<a class="idref" href="MetaRocq.Common.Transform.html#Transform.pre"><span class="id" title="projection">pre</span></a>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Transform.html#Transform.obseq"><span class="id" title="projection">obseq</span></a> <a id="p:521" class="idref" href="#p:521"><span class="id" title="binder">p</span></a> <a id="hp:522" class="idref" href="#hp:522"><span class="id" title="binder">hp</span></a> <a id="p':523" class="idref" href="#p':523"><span class="id" title="binder">p'</span></a> <a id="v:524" class="idref" href="#v:524"><span class="id" title="binder">v</span></a> <a id="v':525" class="idref" href="#v':525"><span class="id" title="binder">v'</span></a> := <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v':525"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#v:524"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'return'_x_'then'_x_'else'_x"><span class="id" title="notation">|}</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>]<br/>
<span class="id" title="keyword">Instance</span> <a id="optional_self_transformation_ext" class="idref" href="#optional_self_transformation_ext"><span class="id" title="instance">optional_self_transformation_ext</span></a> {<a id="env:526" class="idref" href="#env:526"><span class="id" title="binder">env</span></a> <a id="term:527" class="idref" href="#term:527"><span class="id" title="binder">term</span></a> <a id="eval:528" class="idref" href="#eval:528"><span class="id" title="binder">eval</span></a>} <a id="activate:529" class="idref" href="#activate:529"><span class="id" title="binder">activate</span></a> <a id="tr:530" class="idref" href="#tr:530"><span class="id" title="binder">tr</span></a> <a id="extends:531" class="idref" href="#extends:531"><span class="id" title="binder">extends</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:530"><span class="id" title="variable">tr</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#extends:531"><span class="id" title="variable">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#extends:531"><span class="id" title="variable">extends</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#TransformExt.t"><span class="id" title="class">TransformExt.t</span></a> (@<a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#optional_self_transform"><span class="id" title="definition">optional_self_transform</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#env:526"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#term:527"><span class="id" title="variable">term</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#eval:528"><span class="id" title="variable">eval</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#activate:529"><span class="id" title="variable">activate</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#tr:530"><span class="id" title="variable">tr</span></a>) <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#extends:531"><span class="id" title="variable">extends</span></a> <a class="idref" href="MetaRocq.ErasurePlugin.ETransform.html#extends:531"><span class="id" title="variable">extends</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">activate</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> × ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
