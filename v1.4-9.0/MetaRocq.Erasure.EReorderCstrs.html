<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.Erasure.EReorderCstrs</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">List</span> <span class="id" title="library">String</span> <span class="id" title="library">Arith</span> <span class="id" title="library">Lia</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">ssrbool</span> <span class="id" title="library">Morphisms</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">ListNotations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Equations</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Transparent</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#"><span class="id" title="library">PCUICAstUtils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.MRList.html#"><span class="id" title="library">MRList</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#"><span class="id" title="library">bytestring</span></a> <a class="idref" href="MetaRocq.Utils.utils.html#"><span class="id" title="library">utils</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#"><span class="id" title="library">monad_utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EProgram.html#"><span class="id" title="library">EProgram</span></a> <a class="idref" href="MetaRocq.Erasure.EPrimitive.html#"><span class="id" title="library">EPrimitive</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#"><span class="id" title="library">EAst</span></a> <a class="idref" href="MetaRocq.Erasure.ESpineView.html#"><span class="id" title="library">ESpineView</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#"><span class="id" title="library">EEtaExpanded</span></a> <a class="idref" href="MetaRocq.Erasure.EInduction.html#"><span class="id" title="library">EInduction</span></a> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#"><span class="id" title="library">ERemoveParams</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#"><span class="id" title="library">Erasure</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#"><span class="id" title="library">EGlobalEnv</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#"><span class="id" title="library">EAstUtils</span></a> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#"><span class="id" title="library">ELiftSubst</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#"><span class="id" title="library">EWellformed</span></a> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#"><span class="id" title="library">ECSubst</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#"><span class="id" title="library">EWcbvEval</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.Kernames.html#"><span class="id" title="module">Kernames</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#MRMonadNotation"><span class="id" title="module">MRMonadNotation</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_declared_constructor" class="idref" href="#lookup_declared_constructor"><span class="id" title="lemma">lookup_declared_constructor</span></a> {<a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a> <a id="id:2" class="idref" href="#id:2"><span class="id" title="binder">id</span></a> <a id="mdecl:3" class="idref" href="#mdecl:3"><span class="id" title="binder">mdecl</span></a> <a id="idecl:4" class="idref" href="#idecl:4"><span class="id" title="binder">idecl</span></a> <a id="cdecl:5" class="idref" href="#cdecl:5"><span class="id" title="binder">cdecl</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#id:2"><span class="id" title="variable">id</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#id:2"><span class="id" title="variable">id</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mdecl:3"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:4"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cdecl:5"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constructor"><span class="id" title="definition">declared_constructor</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#id:2"><span class="id" title="variable">id</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mdecl:3"><span class="id" title="variable">mdecl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:4"><span class="id" title="variable">idecl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cdecl:5"><span class="id" title="variable">cdecl</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constructor"><span class="id" title="definition">declared_constructor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_inductive"><span class="id" title="definition">declared_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_minductive"><span class="id" title="definition">declared_minductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> ⇒ //=. <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hn</span> ⇒ //. <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">_</span> <span class="id" title="var">id</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">hn'</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;- &lt;- &lt;-]. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="lookup_inductive_assoc" class="idref" href="#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> {<a id="A:6" class="idref" href="#A:6"><span class="id" title="binder">A</span></a>} (<a id="0f7fdea5e8c25e3e1a79edf27e9de540" class="idref" href="#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:6"><span class="id" title="variable">A</span></a>)) (<a id="kn:8" class="idref" href="#kn:8"><span class="id" title="binder">kn</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">Σ</span>} : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:6"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="variable">Σ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[]</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">d</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">tl</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:8"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <span class="id" title="var">d</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">d</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc:9"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="var">tl</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:8"><span class="id" title="variable">kn</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Tags" class="idref" href="#Tags"><span class="id" title="section">Tags</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a id="find_tag" class="idref" href="#find_tag"><span class="id" title="definition">find_tag</span></a> (<a id="l:11" class="idref" href="#l:11"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="idx:12" class="idref" href="#idx:12"><span class="id" title="binder">idx</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="tag:13" class="idref" href="#tag:13"><span class="id" title="binder">tag</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:11"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[]</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tag'</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">tags</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tag:13"><span class="id" title="variable">tag</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <span class="id" title="var">tag'</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:12"><span class="id" title="variable">idx</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag:14"><span class="id" title="definition">find_tag</span></a> <span class="id" title="var">tags</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:12"><span class="id" title="variable">idx</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tag:13"><span class="id" title="variable">tag</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;e.g.&nbsp;for&nbsp;bool:&nbsp;<span class="inlinecode"></span> <span class="inlinecode">1</span> <span class="inlinecode">0</span> <span class="inlinecode"></span>,&nbsp;i.e&nbsp;true&nbsp;(0&nbsp;in&nbsp;Rocq)&nbsp;is&nbsp;mapped&nbsp;to&nbsp;1&nbsp;and&nbsp;false&nbsp;(1&nbsp;in&nbsp;Rocq)&nbsp;is&nbsp;mapped&nbsp;to&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="new_tag" class="idref" href="#new_tag"><span class="id" title="definition">new_tag</span></a> <a id="tags:16" class="idref" href="#tags:16"><span class="id" title="binder">tags</span></a> <a id="tag:17" class="idref" href="#tag:17"><span class="id" title="binder">tag</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag"><span class="id" title="definition">find_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:16"><span class="id" title="variable">tags</span></a> 0 <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tag:17"><span class="id" title="variable">tag</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="old_tag" class="idref" href="#old_tag"><span class="id" title="definition">old_tag</span></a> (<a id="tags:18" class="idref" href="#tags:18"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="tag:19" class="idref" href="#tag:19"><span class="id" title="binder">tag</span></a> := <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:18"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tag:19"><span class="id" title="variable">tag</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*Lemma&nbsp;old_of_new&nbsp;tags&nbsp;oldidx&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;old_tag&nbsp;tags&nbsp;oldidx&nbsp;&gt;&gt;=&nbsp;new_tag&nbsp;tags&nbsp;=&nbsp;Some&nbsp;oldidx.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/old_tag&nbsp;/new_tag.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;nth_error&nbsp;eqn:hnth&nbsp;=&gt;&nbsp;//=.&nbsp;2:admit.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;revert&nbsp;hnth.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;-{2}<span class="inlinecode"><span class="id" title="var">oldidx</span></span>Nat.add_0_r.&nbsp;generalize&nbsp;0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;tags&nbsp;in&nbsp;oldidx,&nbsp;n&nbsp;|-&nbsp;*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;intros&nbsp;n0.&nbsp;now&nbsp;rewrite&nbsp;nth_error_nil.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;cbn.&nbsp;intros&nbsp;n0&nbsp;hnth.&nbsp;case:&nbsp;eqb_spec.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;-&gt;.&nbsp;destruct&nbsp;oldidx&nbsp;=&gt;&nbsp;//.&nbsp;<span class="comment">(*&nbsp;tags&nbsp;are&nbsp;unique&nbsp;*)</span>&nbsp;admit.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;neq.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;oldidx.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cbn&nbsp;in&nbsp;hnth.&nbsp;now&nbsp;noconf&nbsp;hnth.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cbn&nbsp;in&nbsp;hnth.&nbsp;rewrite&nbsp;(IHtags&nbsp;oldidx)&nbsp;//.&nbsp;f_equal.&nbsp;lia.<br/>
&nbsp;&nbsp;Qed.*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="new_tag_spec" class="idref" href="#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <a id="tags:20" class="idref" href="#tags:20"><span class="id" title="binder">tags</span></a> <a id="newidx:21" class="idref" href="#newidx:21"><span class="id" title="binder">newidx</span></a> <a id="oldidx:22" class="idref" href="#oldidx:22"><span class="id" title="binder">oldidx</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:20"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:21"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:22"><span class="id" title="variable">oldidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:20"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:22"><span class="id" title="variable">oldidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:21"><span class="id" title="variable">newidx</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{2}[<span class="id" title="var">oldidx</span>]<span class="id" title="lemma">Nat.sub_0_r</span>. <span class="id" title="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tags</span> <span class="id" title="tactic">in</span> <span class="id" title="var">oldidx</span> |- ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">n0</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n0</span>. <span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">move</span>⇒ → [= -&gt;]. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.sub_diag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtags</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">h</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span> <span class="id" title="var">H</span>: (<span class="id" title="var">oldidx</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n0</span>) ⇒ [|<span class="id" title="var">n</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">oldidx</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0). <span class="id" title="var">lia</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHtags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> × ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">noconf</span> <span class="id" title="var">IHtags</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_refl"><span class="id" title="lemma">eqb_refl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span>. <span class="id" title="var">noconf</span> <span class="id" title="var">h</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">oldidx</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.sub_succ</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHtags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">oldidx</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHtags</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_list_opt" class="idref" href="#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> {<a id="A:23" class="idref" href="#A:23"><span class="id" title="binder">A</span></a>} <a id="tags:24" class="idref" href="#tags:24"><span class="id" title="binder">tags</span></a> (<a id="brs:25" class="idref" href="#brs:25"><span class="id" title="binder">brs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:23"><span class="id" title="variable">A</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:23"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> (<span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:25"><span class="id" title="variable">brs</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:24"><span class="id" title="variable">tags</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_list" class="idref" href="#reorder_list"><span class="id" title="definition">reorder_list</span></a> {<a id="A:26" class="idref" href="#A:26"><span class="id" title="binder">A</span></a>} <a id="tags:27" class="idref" href="#tags:27"><span class="id" title="binder">tags</span></a> (<a id="l:28" class="idref" href="#l:28"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:26"><span class="id" title="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MROption.html#option_get"><span class="id" title="definition">option_get</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:28"><span class="id" title="variable">l</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:27"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:28"><span class="id" title="variable">l</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a id="one_to_one_map" class="idref" href="#one_to_one_map"><span class="id" title="definition">one_to_one_map</span></a> <a id="n:29" class="idref" href="#n:29"><span class="id" title="binder">n</span></a> <a id="l:30" class="idref" href="#l:30"><span class="id" title="binder">l</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:29"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:30"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">existsb</span> (<span class="id" title="keyword">fun</span> <a id="x:33" class="idref" href="#x:33"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:33"><span class="id" title="variable">x</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:29"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:30"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#one_to_one_map:31"><span class="id" title="definition">one_to_one_map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:29"><span class="id" title="variable">n</span></a> (<span class="id" title="definition">remove</span> <span class="id" title="lemma">Nat.eq_dec</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:29"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:30"><span class="id" title="variable">l</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="wf_tags" class="idref" href="#wf_tags"><span class="id" title="definition">wf_tags</span></a> (<a id="l:34" class="idref" href="#l:34"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forallb</span> (<span class="id" title="keyword">fun</span> <a id="n:35" class="idref" href="#n:35"><span class="id" title="binder">n</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:35"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&lt;?</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:34"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:34"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#one_to_one_map"><span class="id" title="definition">one_to_one_map</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:34"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:34"><span class="id" title="variable">l</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="find_tag_None" class="idref" href="#find_tag_None"><span class="id" title="lemma">find_tag_None</span></a> <a id="tags:36" class="idref" href="#tags:36"><span class="id" title="binder">tags</span></a> <a id="n:37" class="idref" href="#n:37"><span class="id" title="binder">n</span></a> <a id="idx:38" class="idref" href="#idx:38"><span class="id" title="binder">idx</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag"><span class="id" title="definition">find_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:36"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:37"><span class="id" title="variable">n</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:38"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <a id="tag:39" class="idref" href="#tag:39"><span class="id" title="binder">tag</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tag:39"><span class="id" title="variable">tag</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:38"><span class="id" title="variable">idx</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:36"><span class="id" title="variable">tags</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tags</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- *; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a> ⇒ [-&gt;|<span class="id" title="var">neq</span>] // <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtags</span> <span class="id" title="var">_</span> <span class="id" title="var">h</span>). <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="one_to_one_map_spec" class="idref" href="#one_to_one_map_spec"><span class="id" title="lemma">one_to_one_map_spec</span></a> <a id="l:40" class="idref" href="#l:40"><span class="id" title="binder">l</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#one_to_one_map"><span class="id" title="definition">one_to_one_map</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:40"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:40"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="i:41" class="idref" href="#i:41"><span class="id" title="binder">i</span></a>, <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:41"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:40"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:41"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:40"><span class="id" title="variable">l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: (<span class="id" title="lemma">Nat.le_refl</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="tactic">at</span> 2 3 4 <span class="id" title="keyword">as</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l</span> |- *; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">hl</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="var">lia</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">l</span> <span class="id" title="var">hl</span>; <span class="id" title="tactic">case</span> ⇒ //=; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">hl</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<span class="id" title="lemma">existsb_exists</span> ⇒ [[<span class="id" title="var">x</span> [<span class="id" title="var">inx</span> <span class="id" title="var">xeqn</span>]]] <span class="id" title="var">hone</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHn</span> (<span class="id" title="definition">remove</span> <span class="id" title="lemma">Nat.eq_dec</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">xeqn</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hlt</span> := <span class="id" title="lemma">remove_length_lt</span> <span class="id" title="lemma">Nat.eq_dec</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">inx</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">hone</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) ⇒ [-&gt;|<span class="id" title="var">neq</span>]. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ⇒ <span class="id" title="var">hi</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">have</span> := <a class="idref" href="MetaRocq.Utils.MRProd.html#proj1"><span class="id" title="definition">proj1</span></a> (<span class="id" title="var">IHn</span> <span class="id" title="var">_</span>) <span class="id" title="var">H</span> ⇒ /(<span class="id" title="lemma">in_remove</span> <span class="id" title="lemma">Nat.eq_dec</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">suff</span>: <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">n</span> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>. <span class="id" title="tactic">apply</span> &lt;- <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">in_in_remove</span> <span class="id" title="lemma">Nat.eq_dec</span>) ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="find_tag_wf" class="idref" href="#find_tag_wf"><span class="id" title="lemma">find_tag_wf</span></a> <a id="tags:42" class="idref" href="#tags:42"><span class="id" title="binder">tags</span></a> <a id="idx:43" class="idref" href="#idx:43"><span class="id" title="binder">idx</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:42"><span class="id" title="variable">tags</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:42"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:43"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:42"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:43"><span class="id" title="variable">idx</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_All"><span class="id" title="lemma">forallb_All</span></a> <span class="id" title="var">hwf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span> ⇒ /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#one_to_one_map_spec"><span class="id" title="lemma">one_to_one_map_spec</span></a> <span class="id" title="var">hone</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag_None"><span class="id" title="lemma">find_tag_None</span></a> /<span class="id" title="lemma">Forall_forall</span> <span class="id" title="var">hdiff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="lemma">Nat.leb_spec</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">tags</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <span class="id" title="var">idx</span>) ⇒ // <span class="id" title="var">hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> (<span class="id" title="var">hdiff</span> <span class="id" title="var">idx</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">hone</span>, <span class="id" title="var">hlt</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mapopt_spec" class="idref" href="#mapopt_spec"><span class="id" title="lemma">mapopt_spec</span></a> {<a id="A:44" class="idref" href="#A:44"><span class="id" title="binder">A</span></a> <a id="B:45" class="idref" href="#B:45"><span class="id" title="binder">B</span></a>} (<a id="f:46" class="idref" href="#f:46"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:44"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:45"><span class="id" title="variable">B</span></a>) (<a id="l:47" class="idref" href="#l:47"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:44"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="i:48" class="idref" href="#i:48"><span class="id" title="binder">i</span></a> <a id="x:49" class="idref" href="#x:49"><span class="id" title="binder">x</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:47"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:48"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:49"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x':50" class="idref" href="#x':50"><span class="id" title="binder">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:46"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:49"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x':50"><span class="id" title="variable">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="l':51" class="idref" href="#l':51"><span class="id" title="binder">l'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:46"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:47"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':51"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="i:52" class="idref" href="#i:52"><span class="id" title="binder">i</span></a> <a id="x:53" class="idref" href="#x:53"><span class="id" title="binder">x</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:47"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:52"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:53"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x':54" class="idref" href="#x':54"><span class="id" title="binder">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:46"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:53"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x':54"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':51"><span class="id" title="variable">l'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:52"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:46"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:53"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">hf</span>. <span class="id" title="tactic">∃</span> <span class="id" title="notation">[]</span>. <span class="id" title="tactic">split</span> ⇒ // <span class="id" title="var">i</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">hf</span>. <span class="id" title="var">forward</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">hx</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">hf</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> <span class="id" title="var">hx</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l'</span> [<span class="id" title="var">exl'</span> <span class="id" title="var">hl'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">hf</span> 0 <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> <span class="id" title="var">eqx'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">noconf</span> <span class="id" title="var">eqx'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">exl'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">hnth</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">now</span> <span class="id" title="var">noconf</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hl'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mapopt_inv_spec" class="idref" href="#mapopt_inv_spec"><span class="id" title="lemma">mapopt_inv_spec</span></a> {<a id="B:55" class="idref" href="#B:55"><span class="id" title="binder">B</span></a>} (<a id="f:56" class="idref" href="#f:56"><span class="id" title="binder">f</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:55"><span class="id" title="variable">B</span></a>) (<a id="l:57" class="idref" href="#l:57"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="i:58" class="idref" href="#i:58"><span class="id" title="binder">i</span></a> <a id="x:59" class="idref" href="#x:59"><span class="id" title="binder">x</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:57"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:58"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:59"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x':60" class="idref" href="#x':60"><span class="id" title="binder">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:56"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:59"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x':60"><span class="id" title="variable">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="l':61" class="idref" href="#l':61"><span class="id" title="binder">l'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:56"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:57"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':61"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:57"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':61"><span class="id" title="variable">l'</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="i:62" class="idref" href="#i:62"><span class="id" title="binder">i</span></a> <a id="x:63" class="idref" href="#x:63"><span class="id" title="binder">x</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':61"><span class="id" title="variable">l'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:62"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:63"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x':64" class="idref" href="#x':64"><span class="id" title="binder">x'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:57"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:62"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x':64"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:56"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x':64"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:63"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">hf</span>. <span class="id" title="tactic">∃</span> <span class="id" title="notation">[]</span>. <span class="id" title="tactic">split</span> ⇒ //; <span class="id" title="tactic">split</span> ⇒ // <span class="id" title="var">i</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">hf</span>. <span class="id" title="var">forward</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">hx</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">hf</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> <span class="id" title="var">hx</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l'</span> [<span class="id" title="var">exl'</span> <span class="id" title="var">hl'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">hf</span> 0 <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> <span class="id" title="var">eqx'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eqx'</span> <span class="id" title="var">exl'</span>. <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //= //. <span class="id" title="tactic">split</span> ⇒ //. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hl'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">hl</span> <span class="id" title="var">hl'</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">noconf</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">a</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hl'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*Lemma&nbsp;mapopt_spec'&nbsp;{B}&nbsp;(f&nbsp;:&nbsp;nat&nbsp;-&gt;&nbsp;option&nbsp;B)&nbsp;(l&nbsp;:&nbsp;list&nbsp;nat)&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;i&nbsp;x,&nbsp;nth_error&nbsp;l&nbsp;i&nbsp;=&nbsp;Some&nbsp;x&nbsp;-&gt;&nbsp;exists&nbsp;x',&nbsp;f&nbsp;x&nbsp;=&nbsp;Some&nbsp;x')&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;l',&nbsp;mapopt&nbsp;f&nbsp;l&nbsp;=&nbsp;Some&nbsp;l'&nbsp;/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;i&nbsp;x,&nbsp;nth_error&nbsp;l&nbsp;i&nbsp;=&nbsp;Some&nbsp;x&nbsp;-&gt;&nbsp;exists&nbsp;b,&nbsp;f&nbsp;x&nbsp;=&nbsp;Some&nbsp;b&nbsp;/\&nbsp;nth_error&nbsp;l'&nbsp;x&nbsp;=&nbsp;Some&nbsp;b).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;l;&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;intros&nbsp;hf.&nbsp;exists&nbsp;<span class="inlinecode"></span>.&nbsp;split&nbsp;=&gt;&nbsp;//&nbsp;i&nbsp;x.&nbsp;rewrite&nbsp;nth_error_nil&nbsp;//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;intros&nbsp;hf.&nbsp;forward&nbsp;IHl.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;intros&nbsp;i&nbsp;x&nbsp;hx.&nbsp;apply&nbsp;(hf&nbsp;(S&nbsp;i)&nbsp;x&nbsp;hx).&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;IHl&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">l'</span></span> <span class="inlinecode">[<span class="id" title="var">exl'</span></span> <span class="inlinecode"><span class="id" title="var">hl'</span>]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pose&nbsp;proof&nbsp;(hf&nbsp;0&nbsp;a&nbsp;eq_refl)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">x'</span></span> <span class="inlinecode"><span class="id" title="var">eqx'</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(f&nbsp;a)&nbsp;eqn:fa&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noconf&nbsp;eqx'.&nbsp;rewrite&nbsp;exl'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eexists;&nbsp;split&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;i&nbsp;x&nbsp;hnth.&nbsp;destruct&nbsp;i;&nbsp;cbn&nbsp;in&nbsp;*.&nbsp;noconf&nbsp;hnth.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;exists&nbsp;x'.&nbsp;split&nbsp;=&gt;&nbsp;//.&nbsp;destruct&nbsp;a;&nbsp;cbn.&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;hl'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;discriminate.<br/>
&nbsp;&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_opt_spec" class="idref" href="#reorder_list_opt_spec"><span class="id" title="lemma">reorder_list_opt_spec</span></a> {<a id="A:65" class="idref" href="#A:65"><span class="id" title="binder">A</span></a>} (<a id="l:66" class="idref" href="#l:66"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:65"><span class="id" title="variable">A</span></a>) (<a id="tags:67" class="idref" href="#tags:67"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="htags:68" class="idref" href="#htags:68"><span class="id" title="binder">htags</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:67"><span class="id" title="variable">tags</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:66"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:67"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="l':69" class="idref" href="#l':69"><span class="id" title="binder">l'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:67"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:66"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':69"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="i:70" class="idref" href="#i:70"><span class="id" title="binder">i</span></a> <a id="k:71" class="idref" href="#k:71"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:67"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:70"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:71"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x:72" class="idref" href="#x:72"><span class="id" title="binder">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:66"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:71"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:72"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':69"><span class="id" title="variable">l'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:70"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:66"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:71"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">htags</span> ⇒ [] <span class="id" title="var">htags</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">optH</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mapopt_spec"><span class="id" title="lemma">mapopt_spec</span></a> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span>) <span class="id" title="var">tags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">optH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">hnth</span>. <span class="id" title="var">solve_all</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#All_nth_error"><span class="id" title="lemma">All_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.ltb_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">hlen</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth'</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">optH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l'</span> [<span class="id" title="var">heq</span> <span class="id" title="var">hl'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">heq</span>. <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_opt_In" class="idref" href="#reorder_list_opt_In"><span class="id" title="lemma">reorder_list_opt_In</span></a> {<a id="A:73" class="idref" href="#A:73"><span class="id" title="binder">A</span></a>} (<a id="l:74" class="idref" href="#l:74"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:73"><span class="id" title="variable">A</span></a>) (<a id="tags:75" class="idref" href="#tags:75"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="l':76" class="idref" href="#l':76"><span class="id" title="binder">l'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:75"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:74"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':76"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:77" class="idref" href="#x:77"><span class="id" title="binder">x</span></a>, <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:77"><span class="id" title="variable">x</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':76"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:77"><span class="id" title="variable">x</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:74"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tags</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>, <span class="id" title="var">l'</span> |- *; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [= &lt;-] <span class="id" title="var">x</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hmap</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;-] <span class="id" title="var">x</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHtags</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;reorder_list_spec&nbsp;{A}&nbsp;(tags&nbsp;:&nbsp;list&nbsp;nat)&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;n&nbsp;i&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;wf_tags&nbsp;tags&nbsp;-&gt;&nbsp;|l| = |tags|&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nth_error&nbsp;tags&nbsp;i&nbsp;=&nbsp;Some&nbsp;n&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nth_error&nbsp;(reorder_list&nbsp;tags&nbsp;l)&nbsp;i&nbsp;=&nbsp;nth_error&nbsp;l&nbsp;n.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;wft&nbsp;hlt&nbsp;hnth.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/reorder_list.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;have&nbsp;<span class="inlinecode"><span class="id" title="var">l'</span></span> <span class="inlinecode">[-&gt;</span> <span class="inlinecode"><span class="id" title="var">hnth'</span>]</span>&nbsp;:=&nbsp;reorder_list_opt_spec&nbsp;l&nbsp;tags&nbsp;wft&nbsp;hlt.<br/>
&nbsp;&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Definition&nbsp;reorder_list_spec_maps&nbsp;{A}&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;(tags&nbsp;:&nbsp;list&nbsp;nat)&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;forall&nbsp;l',&nbsp;reorder_list_opt&nbsp;tags&nbsp;l&nbsp;=&nbsp;Some&nbsp;l'&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(forall&nbsp;i&nbsp;k,&nbsp;maps_to&nbsp;tags&nbsp;i&nbsp;k&nbsp;-&gt;&nbsp;nth_error&nbsp;l'&nbsp;k&nbsp;=&nbsp;nth_error&nbsp;l&nbsp;i).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;l'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;l;&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;destruct&nbsp;l';&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;<span class="inlinecode">=</span>&nbsp;i&nbsp;k.&nbsp;now&nbsp;rewrite&nbsp;!nth_error_nil.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/reorder_list_opt&nbsp;/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;tags&nbsp;=&gt;&nbsp;//=.&nbsp;now&nbsp;rewrite&nbsp;nth_error_nil.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;/reorder_list_opt.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="inj_tags" class="idref" href="#inj_tags"><span class="id" title="definition">inj_tags</span></a> (<a id="tags:78" class="idref" href="#tags:78"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="i:79" class="idref" href="#i:79"><span class="id" title="binder">i</span></a> <a id="i':80" class="idref" href="#i':80"><span class="id" title="binder">i'</span></a> <a id="k:81" class="idref" href="#k:81"><span class="id" title="binder">k</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:78"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:79"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:81"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:78"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i':80"><span class="id" title="variable">i'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:81"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:79"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i':80"><span class="id" title="variable">i'</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_opt_spec'" class="idref" href="#reorder_list_opt_spec'"><span class="id" title="lemma">reorder_list_opt_spec'</span></a> {<a id="A:82" class="idref" href="#A:82"><span class="id" title="binder">A</span></a>} (<a id="l:83" class="idref" href="#l:83"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:82"><span class="id" title="variable">A</span></a>) (<a id="tags:84" class="idref" href="#tags:84"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="htags:85" class="idref" href="#htags:85"><span class="id" title="binder">htags</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:84"><span class="id" title="variable">tags</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:83"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:84"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;inj_tags&nbsp;tags&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="l':86" class="idref" href="#l':86"><span class="id" title="binder">l'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:84"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:83"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':86"><span class="id" title="variable">l'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="oldidx:87" class="idref" href="#oldidx:87"><span class="id" title="binder">oldidx</span></a> <a id="a:88" class="idref" href="#a:88"><span class="id" title="binder">a</span></a>, <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l':86"><span class="id" title="variable">l'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:87"><span class="id" title="variable">oldidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:88"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="newidx:89" class="idref" href="#newidx:89"><span class="id" title="binder">newidx</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:84"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:87"><span class="id" title="variable">oldidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:89"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:83"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:89"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:88"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">htags</span> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">htags</span> <span class="id" title="var">hone</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">optH</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mapopt_inv_spec"><span class="id" title="lemma">mapopt_inv_spec</span></a> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span>) <span class="id" title="var">tags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">optH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> <span class="id" title="var">hnth</span>. <span class="id" title="var">solve_all</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#All_nth_error"><span class="id" title="lemma">All_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.ltb_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">hlen</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">htags</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth'</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">optH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l'</span> [<span class="id" title="var">heq</span> <span class="id" title="var">hl'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">heq</span>. <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hl'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">hlen'</span> <span class="id" title="var">hl'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">newidx</span> <span class="id" title="var">a</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">hl'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hnth</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hl'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> [<span class="id" title="var">eqx'</span> <span class="id" title="var">hl'</span>]]. <span class="id" title="tactic">∃</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_spec'" class="idref" href="#reorder_list_spec'"><span class="id" title="lemma">reorder_list_spec'</span></a> {<a id="A:90" class="idref" href="#A:90"><span class="id" title="binder">A</span></a>} (<a id="tags:91" class="idref" href="#tags:91"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:92" class="idref" href="#l:92"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:90"><span class="id" title="variable">A</span></a>) <a id="n:93" class="idref" href="#n:93"><span class="id" title="binder">n</span></a> <a id="i:94" class="idref" href="#i:94"><span class="id" title="binder">i</span></a> <a id="x:95" class="idref" href="#x:95"><span class="id" title="binder">x</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:91"><span class="id" title="variable">tags</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:92"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:91"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:91"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:94"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:93"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;tags<span class="inlinecode">0</span>&nbsp;=&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:92"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:93"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:95"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;l<span class="inlinecode">1</span>&nbsp;=&nbsp;info&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:91"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:92"><span class="id" title="variable">l</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:94"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:95"><span class="id" title="variable">x</span></a>. <span class="comment">(*&nbsp;l'<span class="inlinecode">0</span>&nbsp;=&nbsp;info*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wft</span> <span class="id" title="var">hlt</span> <span class="id" title="var">hnth</span> <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">l'</span> [-&gt; <span class="id" title="var">hnth''</span>]] := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt_spec"><span class="id" title="lemma">reorder_list_opt_spec</span></a> <span class="id" title="var">l</span> <span class="id" title="var">tags</span> <span class="id" title="var">wft</span> <span class="id" title="var">hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">hnth''</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hnth</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">hnth''</span> <span class="id" title="keyword">as</span> [? []]. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_spec_inv" class="idref" href="#reorder_list_spec_inv"><span class="id" title="lemma">reorder_list_spec_inv</span></a> {<a id="A:96" class="idref" href="#A:96"><span class="id" title="binder">A</span></a>} (<a id="tags:97" class="idref" href="#tags:97"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:98" class="idref" href="#l:98"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:96"><span class="id" title="variable">A</span></a>) <a id="n:99" class="idref" href="#n:99"><span class="id" title="binder">n</span></a> <a id="x:100" class="idref" href="#x:100"><span class="id" title="binder">x</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:97"><span class="id" title="variable">tags</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:98"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:97"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:97"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:98"><span class="id" title="variable">l</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:99"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:100"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;n&nbsp;is&nbsp;a&nbsp;new&nbsp;index,&nbsp;i&nbsp;an&nbsp;old&nbsp;one&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="i:101" class="idref" href="#i:101"><span class="id" title="binder">i</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:97"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:99"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:101"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:98"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:101"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:100"><span class="id" title="variable">x</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wft</span> <span class="id" title="var">hlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">l'</span> [<span class="id" title="var">eq</span> <span class="id" title="var">hnth''</span>]] := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt_spec'"><span class="id" title="lemma">reorder_list_opt_spec'</span></a> <span class="id" title="var">l</span> <span class="id" title="var">tags</span> <span class="id" title="var">wft</span> <span class="id" title="var">hlt</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> /= ⇒ <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">hnth''</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hnth</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">oldidx</span> []]. <span class="id" title="tactic">∃</span> <span class="id" title="var">oldidx</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_old_tag" class="idref" href="#reorder_list_old_tag"><span class="id" title="lemma">reorder_list_old_tag</span></a> {<a id="A:102" class="idref" href="#A:102"><span class="id" title="binder">A</span></a>} (<a id="tags:103" class="idref" href="#tags:103"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:104" class="idref" href="#l:104"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:102"><span class="id" title="variable">A</span></a>) <a id="oldidx:105" class="idref" href="#oldidx:105"><span class="id" title="binder">oldidx</span></a> <a id="newidx:106" class="idref" href="#newidx:106"><span class="id" title="binder">newidx</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:103"><span class="id" title="variable">tags</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:104"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:103"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:103"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:106"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:105"><span class="id" title="variable">oldidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:103"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:104"><span class="id" title="variable">l</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:106"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:104"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oldidx:105"><span class="id" title="variable">oldidx</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wft</span> <span class="id" title="var">hlen</span> <span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_spec'"><span class="id" title="lemma">reorder_list_spec'</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">wft</span> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">wft</span> <span class="id" title="var">hone</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_all</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#All_nth_error"><span class="id" title="lemma">All_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wft</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.ltb_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wft</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">hlen</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wft</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_None</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;reorder_list_old_tag'&nbsp;{A}&nbsp;(tags&nbsp;:&nbsp;list&nbsp;nat)&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;oldidx&nbsp;newidx&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;wf_tags&nbsp;tags&nbsp;-&gt;&nbsp;|l| = |tags|&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;old_tag&nbsp;tags&nbsp;oldidx&nbsp;=&nbsp;Some&nbsp;newidx&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nth_error&nbsp;(reorder_list&nbsp;tags&nbsp;l)&nbsp;oldidx&nbsp;=&nbsp;nth_error&nbsp;l&nbsp;newidx.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/old_tag.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;wft&nbsp;hlen&nbsp;ht.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(nth_error&nbsp;l)&nbsp;eqn:hl&nbsp;=&gt;&nbsp;//=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;(reorder_list_spec'&nbsp;tags&nbsp;l)&nbsp;in&nbsp;ht;&nbsp;tea.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;move/andP:&nbsp;wft&nbsp;=&gt;&nbsp;<span class="inlinecode"></span>&nbsp;wft&nbsp;hone.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;unfold&nbsp;wf_tags&nbsp;in&nbsp;wft.&nbsp;solve_all.&nbsp;eapply&nbsp;All_nth_error&nbsp;in&nbsp;wft;&nbsp;tea.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Nat.ltb_lt&nbsp;in&nbsp;wft.&nbsp;rewrite&nbsp;-hlen&nbsp;in&nbsp;wft.&nbsp;apply&nbsp;nth_error_None&nbsp;in&nbsp;hl.&nbsp;lia.<br/>
&nbsp;&nbsp;Qed.<br/>
*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;reorder_list_old_tag_inv&nbsp;{A}&nbsp;(tags&nbsp;:&nbsp;list&nbsp;nat)&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;oldidx&nbsp;newidx&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;wf_tags&nbsp;tags&nbsp;-&gt;&nbsp;|l| = |tags|&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;old_tag&nbsp;tags&nbsp;oldidx&nbsp;=&nbsp;Some&nbsp;newidx&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nth_error&nbsp;(reorder_list&nbsp;tags&nbsp;l)&nbsp;newidx&nbsp;=&nbsp;nth_error&nbsp;l&nbsp;oldidx.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/old_tag.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;wft&nbsp;hlen&nbsp;ht.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;(nth_error&nbsp;l)&nbsp;eqn:hl&nbsp;=&gt;&nbsp;//=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;(reorder_list_spec&nbsp;tags&nbsp;l)&nbsp;in&nbsp;ht;&nbsp;tea.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;unfold&nbsp;wf_tags&nbsp;in&nbsp;wft.&nbsp;solve_all.&nbsp;eapply&nbsp;All_nth_error&nbsp;in&nbsp;wft;&nbsp;tea.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;Nat.ltb_lt&nbsp;in&nbsp;wft.&nbsp;rewrite&nbsp;-hlen&nbsp;in&nbsp;wft.&nbsp;apply&nbsp;nth_error_None&nbsp;in&nbsp;hl.&nbsp;lia.<br/>
&nbsp;&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#Tags"><span class="id" title="section">Tags</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Reorder" class="idref" href="#Reorder"><span class="id" title="section">Reorder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="25a5985d0c932418b34840a4a18d3678" class="idref" href="#25a5985d0c932418b34840a4a18d3678"><span class="id" title="variable">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_declarations"><span class="id" title="definition">global_declarations</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="Reorder.mapping" class="idref" href="#Reorder.mapping"><span class="id" title="variable">mapping</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lookup_constructor_mapping" class="idref" href="#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> <a id="i:109" class="idref" href="#i:109"><span class="id" title="binder">i</span></a> <a id="c:110" class="idref" href="#c:110"><span class="id" title="binder">c</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.monad_utils.html#7aaec2e17c424ff4abb3a37b5fc343be"><span class="id" title="notation">'</span></a><a id="pat:113" class="idref" href="#pat:113"><span class="id" title="binder">(</span></a><a id="tyna:112" class="idref" href="#tyna:112"><span class="id" title="binder"><span id="pat:113" class="id">tyna</span></span></a><a id="pat:113" class="idref" href="#pat:113"><span class="id" title="binder">,</span></a> <a id="tags:111" class="idref" href="#tags:111"><span class="id" title="binder"><span id="pat:113" class="id">tags</span></span></a><a id="pat:113" class="idref" href="#pat:113"><span class="id" title="binder">)</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#7aaec2e17c424ff4abb3a37b5fc343be"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#Reorder.mapping"><span class="id" title="variable">mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:109"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#7aaec2e17c424ff4abb3a37b5fc343be"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:111"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:110"><span class="id" title="variable">c</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="lookup_constructor_ordinal" class="idref" href="#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <a id="i:114" class="idref" href="#i:114"><span class="id" title="binder">i</span></a> <a id="c:115" class="idref" href="#c:115"><span class="id" title="binder">c</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:114"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:115"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:115"><span class="id" title="variable">c</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">c'</span> ⇒ <span class="id" title="var">c'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_branches" class="idref" href="#reorder_branches"><span class="id" title="definition">reorder_branches</span></a> (<a id="i:116" class="idref" href="#i:116"><span class="id" title="binder">i</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#inductive"><span class="id" title="record">inductive</span></a>) (<a id="brs:117" class="idref" href="#brs:117"><span class="id" title="binder">brs</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Common.BasicAst.html#name"><span class="id" title="inductive">BasicAst.name</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>)) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Common.BasicAst.html#name"><span class="id" title="inductive">BasicAst.name</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#Reorder.mapping"><span class="id" title="variable">mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:116"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:117"><span class="id" title="variable">brs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">tyna</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">tags</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <span class="id" title="var">tags</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:117"><span class="id" title="variable">brs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span> <a id="reorder" class="idref" href="#reorder"><span class="id" title="definition">reorder</span></a> (<a id="t:118" class="idref" href="#t:118"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tVar"><span class="id" title="constructor">tVar</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#na:120"><span class="id" title="variable">na</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tVar"><span class="id" title="constructor">tVar</span></a> <span class="id" title="var">na</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tLambda"><span class="id" title="constructor">tLambda</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nm:122"><span class="id" title="variable">nm</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#bod:121"><span class="id" title="variable">bod</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tLambda"><span class="id" title="constructor">tLambda</span></a> <span class="id" title="var">nm</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">bod</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tLetIn"><span class="id" title="constructor">tLetIn</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nm:125"><span class="id" title="variable">nm</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#dfn:124"><span class="id" title="variable">dfn</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#bod:123"><span class="id" title="variable">bod</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tLetIn"><span class="id" title="constructor">tLetIn</span></a> <span class="id" title="var">nm</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">dfn</span>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">bod</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tApp"><span class="id" title="constructor">tApp</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fn:127"><span class="id" title="variable">fn</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#arg:126"><span class="id" title="variable">arg</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tApp"><span class="id" title="constructor">tApp</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">fn</span>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">arg</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nm:128"><span class="id" title="variable">nm</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <span class="id" title="var">nm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:130"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:131"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:129"><span class="id" title="variable">args</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">i</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <span class="id" title="var">i</span> <span class="id" title="var">m</span>) (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">args</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:133"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mch:134"><span class="id" title="variable">mch</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:132"><span class="id" title="variable">brs</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tCase"><span class="id" title="constructor">tCase</span></a> <span class="id" title="var">i</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">mch</span>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a> <span class="id" title="var">i</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a>) <span class="id" title="var">brs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:136"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:135"><span class="id" title="variable">idx</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a>) <span class="id" title="var">mfix</span>) <span class="id" title="var">idx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:138"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:137"><span class="id" title="variable">idx</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a>) <span class="id" title="var">mfix</span>) <span class="id" title="var">idx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:140"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#bod:139"><span class="id" title="variable">bod</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#tProj"><span class="id" title="constructor">tProj</span></a> <span class="id" title="var">p</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">bod</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tPrim"><span class="id" title="constructor">tPrim</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:141"><span class="id" title="variable">p</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tPrim"><span class="id" title="constructor">tPrim</span></a> (<a class="idref" href="MetaRocq.Erasure.EPrimitive.html#map_prim"><span class="id" title="definition">map_prim</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tLazy"><span class="id" title="constructor">tLazy</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:142"><span class="id" title="variable">t</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tLazy"><span class="id" title="constructor">tLazy</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tForce"><span class="id" title="constructor">tForce</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:143"><span class="id" title="variable">t</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tForce"><span class="id" title="constructor">tForce</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tRel"><span class="id" title="constructor">tRel</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:144"><span class="id" title="variable">n</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tRel"><span class="id" title="constructor">tRel</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#tEvar"><span class="id" title="constructor">tEvar</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ev:146"><span class="id" title="variable">ev</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:145"><span class="id" title="variable">args</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#tEvar"><span class="id" title="constructor">tEvar</span></a> <span class="id" title="var">ev</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder:119"><span class="id" title="definition">reorder</span></a> <span class="id" title="var">args</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_constant_decl" class="idref" href="#reorder_constant_decl"><span class="id" title="definition">reorder_constant_decl</span></a> <a id="cb:147" class="idref" href="#cb:147"><span class="id" title="binder">cb</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cb:147"><span class="id" title="variable">cb</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">cst_body</span></a>) |}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_one_ind" class="idref" href="#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a id="kn:148" class="idref" href="#kn:148"><span class="id" title="binder">kn</span></a> <a id="i:149" class="idref" href="#i:149"><span class="id" title="binder">i</span></a> (<a id="oib:150" class="idref" href="#oib:150"><span class="id" title="binder">oib</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#one_inductive_body"><span class="id" title="record">one_inductive_body</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#one_inductive_body"><span class="id" title="record">one_inductive_body</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#Reorder.mapping"><span class="id" title="variable">mapping</span></a> {| <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:148"><span class="id" title="variable">kn</span></a>; <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:149"><span class="id" title="variable">i</span></a> |} <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">tyna</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">tags</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_name"><span class="id" title="projection">ind_name</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_name"><span class="id" title="projection">ind_name</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_propositional"><span class="id" title="projection">ind_propositional</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_propositional"><span class="id" title="projection">ind_propositional</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_kelim"><span class="id" title="projection">ind_kelim</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_kelim"><span class="id" title="projection">ind_kelim</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <span class="id" title="var">tags</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:150"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a>) |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_inductive_decl" class="idref" href="#reorder_inductive_decl"><span class="id" title="definition">reorder_inductive_decl</span></a> <a id="kn:151" class="idref" href="#kn:151"><span class="id" title="binder">kn</span></a> <a id="idecl:152" class="idref" href="#idecl:152"><span class="id" title="binder">idecl</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_finite"><span class="id" title="projection">ind_finite</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:152"><span class="id" title="variable">idecl</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_finite"><span class="id" title="projection">ind_finite</span></a>); <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_npars"><span class="id" title="projection">ind_npars</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:152"><span class="id" title="variable">idecl</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_npars"><span class="id" title="projection">ind_npars</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_bodies"><span class="id" title="projection">ind_bodies</span></a> := <a class="idref" href="MetaRocq.Utils.MRList.html#mapi"><span class="id" title="definition">mapi</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:151"><span class="id" title="variable">kn</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:152"><span class="id" title="variable">idecl</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_bodies"><span class="id" title="projection">ind_bodies</span></a>) |}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_decl" class="idref" href="#reorder_decl"><span class="id" title="definition">reorder_decl</span></a> <a id="d:153" class="idref" href="#d:153"><span class="id" title="binder">d</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="d':154" class="idref" href="#d':154"><span class="id" title="binder">d'</span></a> := <span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:153"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#ConstantDecl"><span class="id" title="constructor">ConstantDecl</span></a> <span class="id" title="var">cb</span> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#ConstantDecl"><span class="id" title="constructor">ConstantDecl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_constant_decl"><span class="id" title="definition">reorder_constant_decl</span></a> <span class="id" title="var">cb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#InductiveDecl"><span class="id" title="constructor">InductiveDecl</span></a> <span class="id" title="var">idecl</span> ⇒ <a class="idref" href="MetaRocq.Erasure.EAst.html#InductiveDecl"><span class="id" title="constructor">InductiveDecl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_inductive_decl"><span class="id" title="definition">reorder_inductive_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:153"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="var">idecl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:153"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d':154"><span class="id" title="variable">d'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="reorder_env" class="idref" href="#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a id="7cd69b597d103d21c92b4ad07132a610" class="idref" href="#7cd69b597d103d21c92b4ad07132a610"><span class="id" title="binder">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_decl"><span class="id" title="definition">reorder_decl</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#7cd69b597d103d21c92b4ad07132a610"><span class="id" title="variable">Σ</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#Reorder"><span class="id" title="section">Reorder</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="reorder_program" class="idref" href="#reorder_program"><span class="id" title="definition">reorder_program</span></a> <a id="mapping:156" class="idref" href="#mapping:156"><span class="id" title="binder">mapping</span></a> (<a id="p:157" class="idref" href="#p:157"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#program"><span class="id" title="definition">program</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#program"><span class="id" title="definition">program</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mapping:156"><span class="id" title="variable">mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:157"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mapping:156"><span class="id" title="variable">mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:157"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wf_tags_list" class="idref" href="#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> (<a id="tags:158" class="idref" href="#tags:158"><span class="id" title="binder">tags</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="n:159" class="idref" href="#n:159"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:158"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:159"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:158"><span class="id" title="variable">tags</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="nth_error_reorder" class="idref" href="#nth_error_reorder"><span class="id" title="lemma">nth_error_reorder</span></a> {<a id="A:160" class="idref" href="#A:160"><span class="id" title="binder">A</span></a>} {<a id="l:161" class="idref" href="#l:161"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:160"><span class="id" title="variable">A</span></a>} {<a id="tags:162" class="idref" href="#tags:162"><span class="id" title="binder">tags</span></a> <a id="n:163" class="idref" href="#n:163"><span class="id" title="binder">n</span></a> <a id="newidx:164" class="idref" href="#newidx:164"><span class="id" title="binder">newidx</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:162"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:161"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:162"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:164"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:163"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:162"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:161"><span class="id" title="variable">l</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:164"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:161"><span class="id" title="variable">l</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:163"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [] <span class="id" title="var">h</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">wft</span> <span class="id" title="var">hnw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_old_tag"><span class="id" title="lemma">reorder_list_old_tag</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">newidx</span> <span class="id" title="var">wft</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wf_reordering" class="idref" href="#wf_reordering"><span class="id" title="definition">wf_reordering</span></a> <a id="ncstrs:165" class="idref" href="#ncstrs:165"><span class="id" title="binder">ncstrs</span></a> <a id="cstrs:166" class="idref" href="#cstrs:166"><span class="id" title="binder">cstrs</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><span class="id" title="abbreviation">List.length</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cstrs:166"><span class="id" title="variable">cstrs</span></a> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#12489c9c79e91749bd1f337dd0c899e9"><span class="id" title="notation">==</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ncstrs:165"><span class="id" title="variable">ncstrs</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#one_to_one_map"><span class="id" title="definition">one_to_one_map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ncstrs:165"><span class="id" title="variable">ncstrs</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cstrs:166"><span class="id" title="variable">cstrs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wf_inductive_mapping" class="idref" href="#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a> (<a id="def0ae1d6f53f9edf7fdc46f0ff85f41" class="idref" href="#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_declarations"><span class="id" title="definition">global_declarations</span></a>) (<a id="m:168" class="idref" href="#m:168"><span class="id" title="binder">m</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductive_mapping"><span class="id" title="definition">inductive_mapping</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ind</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">cstrs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">))</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:168"><span class="id" title="variable">m</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">EGlobalEnv.lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="variable">Σ</span></a> <span class="id" title="var">ind</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">mib</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">oib</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <span class="id" title="var">cstrs</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">oib</span>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>)<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wf_inductives_mapping" class="idref" href="#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a id="de0bdd995243600a0219716b7c05224c" class="idref" href="#de0bdd995243600a0219716b7c05224c"><span class="id" title="binder">Σ</span></a> (<a id="m:171" class="idref" href="#m:171"><span class="id" title="binder">m</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">forallb</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#de0bdd995243600a0219716b7c05224c"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:171"><span class="id" title="variable">m</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="reorder_proofs" class="idref" href="#reorder_proofs"><span class="id" title="section">reorder_proofs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="f2914edb6f70707d88d2c52f9b04b23a" class="idref" href="#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_declarations"><span class="id" title="definition">global_declarations</span></a>) (<a id="reorder_proofs.m" class="idref" href="#reorder_proofs.m"><span class="id" title="variable">m</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="reorder_proofs.wfm" class="idref" href="#reorder_proofs.wfm"><span class="id" title="variable">wfm</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="optimize" class="idref" href="#optimize"><span class="id" title="abbreviation">optimize</span></a> := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_mkApps" class="idref" href="#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <a id="f:175" class="idref" href="#f:175"><span class="id" title="binder">f</span></a> <a id="l:176" class="idref" href="#l:176"><span class="id" title="binder">l</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:175"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:176"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:175"><span class="id" title="variable">f</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:176"><span class="id" title="variable">l</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Utils.MRList.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> /= <span class="id" title="var">IHl</span> <span class="id" title="lemma">map_app</span> /= <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_optimize_repeat_box" class="idref" href="#map_optimize_repeat_box"><span class="id" title="lemma">map_optimize_repeat_box</span></a> <a id="n:177" class="idref" href="#n:177"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:177"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#tBox"><span class="id" title="constructor">tBox</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:177"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#map_repeat"><span class="id" title="lemma">map_repeat</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;move&nbsp;to&nbsp;globalenv&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="isLambda_optimize" class="idref" href="#isLambda_optimize"><span class="id" title="lemma">isLambda_optimize</span></a> <a id="t:178" class="idref" href="#t:178"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#isLambda"><span class="id" title="definition">isLambda</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:178"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#isLambda"><span class="id" title="definition">isLambda</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:178"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ⇒ //. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="isBox_optimize" class="idref" href="#isBox_optimize"><span class="id" title="lemma">isBox_optimize</span></a> <a id="t:179" class="idref" href="#t:179"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isBox"><span class="id" title="definition">isBox</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:179"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isBox"><span class="id" title="definition">isBox</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:179"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ⇒ //. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_env_reorder" class="idref" href="#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a> <a id="kn:180" class="idref" href="#kn:180"><span class="id" title="binder">kn</span></a> : <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:180"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> <a id="decl:181" class="idref" href="#decl:181"><span class="id" title="binder">decl</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_decl"><span class="id" title="definition">reorder_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:180"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#decl:181"><span class="id" title="variable">decl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)) (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:180"><span class="id" title="variable">kn</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">wfm</span>. <span class="id" title="tactic">induction</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a> ⇒ [-&gt;|<span class="id" title="var">hneq</span>] //=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_constant_reorder" class="idref" href="#lookup_constant_reorder"><span class="id" title="lemma">lookup_constant_reorder</span></a> <a id="c:182" class="idref" href="#c:182"><span class="id" title="binder">c</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_constant_decl"><span class="id" title="definition">reorder_constant_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a>) (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constant"><span class="id" title="definition">lookup_constant</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:182"><span class="id" title="variable">c</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constant"><span class="id" title="definition">lookup_constant</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:182"><span class="id" title="variable">c</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constant"><span class="id" title="definition">lookup_constant</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_inductive_reorder" class="idref" href="#lookup_inductive_reorder"><span class="id" title="lemma">lookup_inductive_reorder</span></a> <a id="i:183" class="idref" href="#i:183"><span class="id" title="binder">i</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:183"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:186" class="idref" href="#pat:186"><span class="id" title="binder">(</span></a><a id="mib:185" class="idref" href="#mib:185"><span class="id" title="binder"><span id="pat:186" class="id">mib</span></span></a><a id="pat:186" class="idref" href="#pat:186"><span class="id" title="binder">,</span></a> <a id="oib:184" class="idref" href="#oib:184"><span class="id" title="binder"><span id="pat:186" class="id">oib</span></span></a><a id="pat:186" class="idref" href="#pat:186"><span class="id" title="binder">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_inductive_decl"><span class="id" title="definition">reorder_inductive_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:183"><span class="id" title="variable">i</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:185"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:183"><span class="id" title="variable">i</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:183"><span class="id" title="variable">i</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:184"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:183"><span class="id" title="variable">i</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a>, <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_inductive_assoc_spec" class="idref" href="#lookup_inductive_assoc_spec"><span class="id" title="lemma">lookup_inductive_assoc_spec</span></a> {<a id="ind:187" class="idref" href="#ind:187"><span class="id" title="binder">ind</span></a> <a id="p:188" class="idref" href="#p:188"><span class="id" title="binder">p</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:187"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:188"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:187"><span class="id" title="variable">ind</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:188"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a>] ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Common.Kernames.html#eq_inductive"><span class="id" title="abbreviation">eq_inductive</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">heq</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">wfa</span> <span class="id" title="var">wfi</span>. <span class="id" title="tactic">intros</span> [= &lt;-].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">heq</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">ind</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">wfa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">wfa</span> <span class="id" title="var">wfi</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">hl</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_inductive_assoc_wf_tags" class="idref" href="#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> {<a id="ind:189" class="idref" href="#ind:189"><span class="id" title="binder">ind</span></a> <a id="mib:190" class="idref" href="#mib:190"><span class="id" title="binder">mib</span></a> <a id="oib:191" class="idref" href="#oib:191"><span class="id" title="binder">oib</span></a> <a id="p:192" class="idref" href="#p:192"><span class="id" title="binder">p</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:189"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:190"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:191"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:189"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:192"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:192"><span class="id" title="variable">p</span></a>) <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:191"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>)<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_spec"><span class="id" title="lemma">lookup_inductive_assoc_spec</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.wfm"><span class="id" title="variable">wfm</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ind_ctors_reorder" class="idref" href="#ind_ctors_reorder"><span class="id" title="lemma">ind_ctors_reorder</span></a> {<a id="ind:193" class="idref" href="#ind:193"><span class="id" title="binder">ind</span></a> <a id="mib:194" class="idref" href="#mib:194"><span class="id" title="binder">mib</span></a> <a id="oib:195" class="idref" href="#oib:195"><span class="id" title="binder">oib</span></a> <a id="p:196" class="idref" href="#p:196"><span class="id" title="binder">p</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:193"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:194"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:195"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:193"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:196"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:193"><span class="id" title="variable">ind</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:193"><span class="id" title="variable">ind</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:195"><span class="id" title="variable">oib</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:196"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:195"><span class="id" title="variable">oib</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hli</span> <span class="id" title="var">hia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ind</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hia</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ind_ctors_no_reorder" class="idref" href="#ind_ctors_no_reorder"><span class="id" title="lemma">ind_ctors_no_reorder</span></a> {<a id="ind:197" class="idref" href="#ind:197"><span class="id" title="binder">ind</span></a> <a id="mib:198" class="idref" href="#mib:198"><span class="id" title="binder">mib</span></a> <a id="oib:199" class="idref" href="#oib:199"><span class="id" title="binder">oib</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:197"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:198"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:199"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:197"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:197"><span class="id" title="variable">ind</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:197"><span class="id" title="variable">ind</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:199"><span class="id" title="variable">oib</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:199"><span class="id" title="variable">oib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hli</span> <span class="id" title="var">hia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">ind</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="nth_reorder_list_ctors" class="idref" href="#nth_reorder_list_ctors"><span class="id" title="lemma">nth_reorder_list_ctors</span></a> {<a id="i:200" class="idref" href="#i:200"><span class="id" title="binder">i</span></a> <a id="mib:201" class="idref" href="#mib:201"><span class="id" title="binder">mib</span></a> <a id="oib:202" class="idref" href="#oib:202"><span class="id" title="binder">oib</span></a> <a id="na:203" class="idref" href="#na:203"><span class="id" title="binder">na</span></a> <a id="tags:204" class="idref" href="#tags:204"><span class="id" title="binder">tags</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:200"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:201"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:202"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:200"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#na:203"><span class="id" title="variable">na</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:204"><span class="id" title="variable">tags</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="newidx:205" class="idref" href="#newidx:205"><span class="id" title="binder">newidx</span></a> <a id="n:206" class="idref" href="#n:206"><span class="id" title="binder">n</span></a>, <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#old_tag"><span class="id" title="definition">old_tag</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:204"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:205"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:206"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:204"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:202"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>)) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#newidx:205"><span class="id" title="variable">newidx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:202"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:206"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">hli</span> <span class="id" title="var">hia</span> <span class="id" title="var">idx</span> <span class="id" title="var">hnew</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nth_error_reorder"><span class="id" title="lemma">nth_error_reorder</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> (<span class="id" title="var">p</span>:=<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">na</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">tags</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_opt_length" class="idref" href="#map_opt_length"><span class="id" title="lemma">map_opt_length</span></a> {<a id="A:207" class="idref" href="#A:207"><span class="id" title="binder">A</span></a> <a id="B:208" class="idref" href="#B:208"><span class="id" title="binder">B</span></a>} (<a id="f:209" class="idref" href="#f:209"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:207"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:208"><span class="id" title="variable">B</span></a>) <a id="l:210" class="idref" href="#l:210"><span class="id" title="binder">l</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:209"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:210"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">l'</span> ⇒ <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">l'</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:210"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) ⇒ //=. <span class="id" title="var">now</span> <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_length" class="idref" href="#reorder_list_length"><span class="id" title="lemma">reorder_list_length</span></a> {<a id="A:211" class="idref" href="#A:211"><span class="id" title="binder">A</span></a>} <a id="tags:212" class="idref" href="#tags:212"><span class="id" title="binder">tags</span></a> (<a id="l:213" class="idref" href="#l:213"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:211"><span class="id" title="variable">A</span></a>): <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:212"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:213"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:212"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:213"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:213"><span class="id" title="variable">l</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="var">hl</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span> <span class="id" title="var">hr</span>: <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> ⇒ [<span class="id" title="var">l'</span>|] //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">hr</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#map_opt_length"><span class="id" title="lemma">map_opt_length</span></a> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span>) <span class="id" title="var">tags</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> ⇒ //. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_inductive_assoc_None_reorder_one_ind" class="idref" href="#lookup_inductive_assoc_None_reorder_one_ind"><span class="id" title="lemma">lookup_inductive_assoc_None_reorder_one_ind</span></a> <a id="i:214" class="idref" href="#i:214"><span class="id" title="binder">i</span></a> <a id="oib:215" class="idref" href="#oib:215"><span class="id" title="binder">oib</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:214"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:214"><span class="id" title="variable">i</span></a>) (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:214"><span class="id" title="variable">i</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:215"><span class="id" title="variable">oib</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:215"><span class="id" title="variable">oib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">move</span> ⇒ → //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="comment">(*<br/>
&nbsp;&nbsp;Lemma&nbsp;lookup_inductive_assoc_None_reorder_inductive_decl&nbsp;i&nbsp;mib&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;lookup_inductive_assoc&nbsp;m&nbsp;i&nbsp;=&nbsp;None&nbsp;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;reorder_inductive_decl&nbsp;m&nbsp;(inductive_mind&nbsp;i)&nbsp;mib&nbsp;=&nbsp;mib.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;/reorder_inductive_decl.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;hl.&nbsp;destruct&nbsp;mib;&nbsp;f_equal.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cbn;&nbsp;induction&nbsp;ind_bodies&nbsp;=&gt;&nbsp;//=.&nbsp;f_equal;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;(lookup_inductive_assoc_None_reorder_one_ind&nbsp;{|&nbsp;inductive_mind&nbsp;:=&nbsp;inductive_mind&nbsp;i;&nbsp;inductive_ind&nbsp;:=&nbsp;0&nbsp;|}).&nbsp;//.<br/>
<br/>
&nbsp;&nbsp;Qed.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Arguments</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> {<span class="id" title="var">A</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_constructor_reorder" class="idref" href="#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> <a id="i:216" class="idref" href="#i:216"><span class="id" title="binder">i</span></a> <a id="n:217" class="idref" href="#n:217"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:221" class="idref" href="#pat:221"><span class="id" title="binder">(</span></a><a id="mib:220" class="idref" href="#mib:220"><span class="id" title="binder"><span id="pat:221" class="id">mib</span></span></a><a id="pat:221" class="idref" href="#pat:221"><span class="id" title="binder">,</span></a> <a id="oib:219" class="idref" href="#oib:219"><span class="id" title="binder"><span id="pat:221" class="id">oib</span></span></a><a id="pat:221" class="idref" href="#pat:221"><span class="id" title="binder">,</span></a> <a id="c:218" class="idref" href="#c:218"><span class="id" title="binder"><span id="pat:221" class="id">c</span></span></a><a id="pat:221" class="idref" href="#pat:221"><span class="id" title="binder">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_inductive_decl"><span class="id" title="definition">reorder_inductive_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:220"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a>) (<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:219"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:218"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:217"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:216"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:217"><span class="id" title="variable">n</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_reorder"><span class="id" title="lemma">lookup_inductive_reorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hind</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [(<span class="id" title="var">na</span>, <span class="id" title="var">tags</span>)|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[]  := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">hind</span> <span class="id" title="var">hl</span> ⇒ //= /<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> ⇒ <span class="id" title="var">hlen</span> <span class="id" title="var">wft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind_ctors_reorder"><span class="id" title="lemma">ind_ctors_reorder</span></a> <span class="id" title="var">hind</span> <span class="id" title="var">hl</span>). <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl</span> /= <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">newidx</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nth_reorder_list_ctors"><span class="id" title="lemma">nth_reorder_list_ctors</span></a> <span class="id" title="var">hind</span> <span class="id" title="var">hl</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a>: <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span> ⇒ <span class="id" title="var">hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag_wf"><span class="id" title="lemma">find_tag_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span> ⇒ //. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">nth_error_None</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_length"><span class="id" title="lemma">reorder_list_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">hnth'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> <span class="id" title="var">hl</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">newidx</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span> ⇒ <span class="id" title="var">hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag_wf"><span class="id" title="lemma">find_tag_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span> ⇒ //. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> <span class="id" title="var">hl</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <span class="id" title="var">hl</span> //=. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nth_error_None</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[]  := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">hind</span> <span class="id" title="var">hl</span> ⇒ //= /(<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> (<span class="id" title="var">A</span>:=<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)) ⇒ <span class="id" title="var">hlen</span> <span class="id" title="var">wft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">na</span> <span class="id" title="var">tags</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">newidx</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">wft</span> ⇒ [] <span class="id" title="var">ht'</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_All"><span class="id" title="lemma">forallb_All</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht'</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#All_nth_error"><span class="id" title="lemma">All_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ht'</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.ltb_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ht'</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_length"><span class="id" title="lemma">reorder_list_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hlen</span>; <span class="id" title="var">lia</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_None_reorder_one_ind"><span class="id" title="lemma">lookup_inductive_assoc_None_reorder_one_ind</span></a> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnth'</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="ind_projs_reorder" class="idref" href="#ind_projs_reorder"><span class="id" title="lemma">ind_projs_reorder</span></a> <a id="mind:222" class="idref" href="#mind:222"><span class="id" title="binder">mind</span></a> <a id="ind:223" class="idref" href="#ind:223"><span class="id" title="binder">ind</span></a> <a id="oib:224" class="idref" href="#oib:224"><span class="id" title="binder">oib</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mind:222"><span class="id" title="variable">mind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:223"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:224"><span class="id" title="variable">oib</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:224"><span class="id" title="variable">oib</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|]=&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="reorder_proofs.efl" class="idref" href="#reorder_proofs.efl"><span class="id" title="variable">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="reorder_proofs.wca" class="idref" href="#reorder_proofs.wca"><span class="id" title="variable">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wf_glob_ind_projs" class="idref" href="#wf_glob_ind_projs"><span class="id" title="lemma">wf_glob_ind_projs</span></a> {<a id="p:227" class="idref" href="#p:227"><span class="id" title="binder">p</span></a> <a id="pinfo:228" class="idref" href="#pinfo:228"><span class="id" title="binder">pinfo</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:227"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pinfo:228"><span class="id" title="variable">pinfo</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|(</span></a><a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pinfo:228"><span class="id" title="variable">pinfo</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1.1</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">)|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 1.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#lookup_env_wellformed"><span class="id" title="lemma">lookup_env_wellformed</span></a> <span class="id" title="keyword">wf</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">mib</span>] ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hind</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hctors</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">nth_error</span> (<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> <span class="id" title="var">o</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">hprojs</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfmind</span> [= &lt;-]. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">wfmind</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_minductive"><span class="id" title="definition">wf_minductive</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>⇒ [] <span class="id" title="var">_</span> /<a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_All"><span class="id" title="lemma">forallb_All</span></a> <span class="id" title="var">ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#All_nth_error"><span class="id" title="lemma">All_nth_error</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ha</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">ha</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_inductive"><span class="id" title="definition">wf_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_projections"><span class="id" title="definition">wf_projections</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hprojs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hctors</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_projection_ordinal" class="idref" href="#lookup_projection_ordinal"><span class="id" title="lemma">lookup_projection_ordinal</span></a> <a id="p:229" class="idref" href="#p:229"><span class="id" title="binder">p</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#isSome"><span class="id" title="definition">isSome</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:229"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#proj_ind"><span class="id" title="projection">proj_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:229"><span class="id" title="variable">p</span></a>) 0 <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span> <span class="id" title="var">hl</span>: <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> ⇒ [<span class="id" title="var">pro</span>|] //= <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wfpro</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_glob_ind_projs"><span class="id" title="lemma">wf_glob_ind_projs</span></a> <span class="id" title="keyword">wf</span> <span class="id" title="var">hl</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>] <span class="id" title="var">cb</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hlc</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">nthp</span> ⇒ //=. <span class="id" title="tactic">intros</span> [= &lt;-]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfpro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hla</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnt</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_spec"><span class="id" title="lemma">lookup_inductive_assoc_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hla</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor_lookup_inductive"><span class="id" title="lemma">lookup_constructor_lookup_inductive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hlc</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hlc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">hla</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">wfpro</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> ⇒ [] [] <span class="id" title="var">taglen</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_All"><span class="id" title="lemma">forallb_All</span></a> <span class="id" title="var">ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> <span class="id" title="keyword">as</span> [|] ⇒ //. <span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> <span class="id" title="keyword">as</span> [|] ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> ⇒ //. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hnt</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="lookup_projection_reorder" class="idref" href="#lookup_projection_reorder"><span class="id" title="lemma">lookup_projection_reorder</span></a> <a id="p:230" class="idref" href="#p:230"><span class="id" title="binder">p</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#isSome"><span class="id" title="definition">isSome</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:235" class="idref" href="#pat:235"><span class="id" title="binder">(((</span></a><a id="mib:234" class="idref" href="#mib:234"><span class="id" title="binder"><span id="pat:235" class="id">mib</span></span></a><a id="pat:235" class="idref" href="#pat:235"><span class="id" title="binder">,</span></a> <a id="oib:233" class="idref" href="#oib:233"><span class="id" title="binder"><span id="pat:235" class="id">oib</span></span></a><a id="pat:235" class="idref" href="#pat:235"><span class="id" title="binder">),</span></a> <a id="c:232" class="idref" href="#c:232"><span class="id" title="binder"><span id="pat:235" class="id">c</span></span></a><a id="pat:235" class="idref" href="#pat:235"><span class="id" title="binder">),</span></a> <a id="pb:231" class="idref" href="#pb:231"><span class="id" title="binder"><span id="pat:235" class="id">pb</span></span></a><a id="pat:235" class="idref" href="#pat:235"><span class="id" title="binder">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_inductive_decl"><span class="id" title="definition">reorder_inductive_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#proj_ind"><span class="id" title="projection">proj_ind</span></a>).(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mib:234"><span class="id" title="variable">mib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#proj_ind"><span class="id" title="projection">proj_ind</span></a>).(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a>.(<a class="idref" href="MetaRocq.Common.Kernames.html#proj_ind"><span class="id" title="projection">proj_ind</span></a>).(<a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:233"><span class="id" title="variable">oib</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:232"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pb:231"><span class="id" title="variable">pb</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:230"><span class="id" title="variable">p</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">iss</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -{1}(<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_projection_ordinal"><span class="id" title="lemma">lookup_projection_ordinal</span></a> <span class="id" title="var">_</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">iss</span>) -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hlc</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>] <span class="id" title="var">cb</span>] ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind_projs_reorder"><span class="id" title="lemma">ind_projs_reorder</span></a> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">nthp</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="All_reorder_list" class="idref" href="#All_reorder_list"><span class="id" title="lemma">All_reorder_list</span></a> {<a id="A:236" class="idref" href="#A:236"><span class="id" title="binder">A</span></a> <a id="tags:237" class="idref" href="#tags:237"><span class="id" title="binder">tags</span></a>} {<a id="P:238" class="idref" href="#P:238"><span class="id" title="binder">P</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:236"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} {<a id="l:239" class="idref" href="#l:239"><span class="id" title="binder">l</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.All_Forall.html#All"><span class="id" title="inductive">All</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#P:238"><span class="id" title="variable">P</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:239"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.All_Forall.html#All"><span class="id" title="inductive">All</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#P:238"><span class="id" title="variable">P</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:237"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:239"><span class="id" title="variable">l</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <span class="id" title="keyword">as</span> [<span class="id" title="var">l'</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hre</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hin</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt_In"><span class="id" title="lemma">reorder_list_opt_In</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hre</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(<a class="idref" href="MetaRocq.Utils.All_Forall.html#All_Forall"><span class="id" title="lemma">All_Forall</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(<span class="id" title="lemma">Forall_forall</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ⇒ <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#Forall_All"><span class="id" title="lemma">Forall_All</span></a>, <span class="id" title="lemma">Forall_forall</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wf_ind_mapping_wf_brs" class="idref" href="#wf_ind_mapping_wf_brs"><span class="id" title="lemma">wf_ind_mapping_wf_brs</span></a> {<a id="ind:240" class="idref" href="#ind:240"><span class="id" title="binder">ind</span></a> <a id="n:241" class="idref" href="#n:241"><span class="id" title="binder">n</span></a> <a id="nas:242" class="idref" href="#nas:242"><span class="id" title="binder">nas</span></a> <a id="tags:243" class="idref" href="#tags:243"><span class="id" title="binder">tags</span></a>} : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:240"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:241"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:240"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nas:242"><span class="id" title="variable">nas</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:243"><span class="id" title="variable">tags</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:243"><span class="id" title="variable">tags</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:241"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hli</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ /<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="var">hlen</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">hli</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> /= ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="var">hlt</span> <span class="id" title="var">_</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rtoProp</span> ::=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#andb_and"><span class="id" title="lemma">andb_and</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">_</span>)] ⇒ <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#andb_and"><span class="id" title="lemma">andb_and</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>: <span class="id" title="var">H</span> ⇒ <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <span class="id" title="var">_</span>)] ⇒ <span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wf_optimize" class="idref" href="#wf_optimize"><span class="id" title="lemma">wf_optimize</span></a> <a id="t:244" class="idref" href="#t:244"><span class="id" title="binder">t</span></a> <a id="k:245" class="idref" href="#k:245"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:245"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:244"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:245"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:244"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">EInduction.term_forall_list_ind</span></a>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → ?<a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a>, ?<a class="idref" href="MetaRocq.Utils.MRProd.html#compose_on_snd"><span class="id" title="lemma">compose_on_snd</span></a>, ?<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#compose_map_def"><span class="id" title="lemma">compose_map_def</span></a>, ?<span class="id" title="lemma">length_map</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_fix_gen"><span class="id" title="definition">wf_fix_gen</span></a>, <a class="idref" href="MetaRocq.Erasure.EAst.html#test_def"><span class="id" title="definition">test_def</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closed</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a>; <span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closed</span></a>; <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">bool</span>; <span class="id" title="var">solve_all</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">bool</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constant_reorder"><span class="id" title="lemma">lookup_constant_reorder</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constant"><span class="id" title="definition">lookup_constant</span></a> ⇒ //=; <span class="id" title="var">bool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> <span class="id" title="var">c</span>) ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.wca"><span class="id" title="variable">wca</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ×. <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">H</span> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] → <span class="id" title="var">iss</span> <span class="id" title="var">isnil</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">lenreo</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_ind_mapping_wf_brs"><span class="id" title="lemma">wf_ind_mapping_wf_brs</span></a> <span class="id" title="var">H0</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_length"><span class="id" title="lemma">reorder_list_length</span></a>. <span class="id" title="var">len</span>. <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mind</span> <span class="id" title="var">ind</span>] <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_reorder"><span class="id" title="lemma">lookup_inductive_reorder</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|]=&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <span class="id" title="var">hl</span> /=. <span class="id" title="tactic">move</span>/<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> ⇒ <span class="id" title="var">hl'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_length"><span class="id" title="lemma">reorder_list_length</span></a> //. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.eqb_eq</span>. <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mind</span> <span class="id" title="var">ind</span>] <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_reorder"><span class="id" title="lemma">lookup_inductive_reorder</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|]=&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> <span class="id" title="var">hl</span> /=. <span class="id" title="tactic">move</span>/<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> ⇒ <span class="id" title="var">hl'</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.eqb_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">nas</span> <span class="id" title="var">tags</span>]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#All_reorder_list"><span class="id" title="lemma">All_reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_projection_reorder"><span class="id" title="lemma">lookup_projection_reorder</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EAst.html#dbody"><span class="id" title="projection">dbody</span></a> <span class="id" title="var">x</span>) ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="mapopt_ext" class="idref" href="#mapopt_ext"><span class="id" title="instance">mapopt_ext</span></a> {<a id="A:246" class="idref" href="#A:246"><span class="id" title="binder">A</span></a> <a id="B:247" class="idref" href="#B:247"><span class="id" title="binder">B</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Classes.Morphisms.html#Proper"><span class="id" title="class">Proper</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Classes.Morphisms.html#pointwise_relation"><span class="id" title="definition">pointwise_relation</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:246"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Classes.Morphisms.html#8dc5652698a6e16f72dd37bd17d3b973"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a>) (@<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:246"><span class="id" title="variable">A</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:247"><span class="id" title="variable">B</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">eqfg</span> <span class="id" title="var">l</span> ? &lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">eqfg</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">g</span> <span class="id" title="var">a</span>) ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mapopt_option_map" class="idref" href="#mapopt_option_map"><span class="id" title="lemma">mapopt_option_map</span></a> {<a id="A:248" class="idref" href="#A:248"><span class="id" title="binder">A</span></a> <a id="B:249" class="idref" href="#B:249"><span class="id" title="binder">B</span></a> <a id="C:250" class="idref" href="#C:250"><span class="id" title="binder">C</span></a>} (<a id="f:251" class="idref" href="#f:251"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:248"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:249"><span class="id" title="variable">B</span></a>) (<a id="g:252" class="idref" href="#g:252"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:249"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#C:250"><span class="id" title="variable">C</span></a>) <a id="l:253" class="idref" href="#l:253"><span class="id" title="binder">l</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> (<span class="id" title="keyword">fun</span> <a id="x:254" class="idref" href="#x:254"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#g:252"><span class="id" title="variable">g</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:251"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:254"><span class="id" title="variable">x</span></a>)) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:253"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#g:252"><span class="id" title="variable">g</span></a>) (<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:251"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:253"><span class="id" title="variable">l</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHl</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Utils.monad_utils.html#mapopt"><span class="id" title="definition">mapopt</span></a> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_list_opt_map" class="idref" href="#reorder_list_opt_map"><span class="id" title="lemma">reorder_list_opt_map</span></a> {<a id="A:255" class="idref" href="#A:255"><span class="id" title="binder">A</span></a> <a id="B:256" class="idref" href="#B:256"><span class="id" title="binder">B</span></a>} <a id="tags:257" class="idref" href="#tags:257"><span class="id" title="binder">tags</span></a> (<a id="f:258" class="idref" href="#f:258"><span class="id" title="binder">f</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:255"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#B:256"><span class="id" title="variable">B</span></a>) (<a id="l:259" class="idref" href="#l:259"><span class="id" title="binder">l</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#A:255"><span class="id" title="variable">A</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:257"><span class="id" title="variable">tags</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:258"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:259"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:258"><span class="id" title="variable">f</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:257"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:259"><span class="id" title="variable">l</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">req</span> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Classes.Morphisms.html#pointwise_relation"><span class="id" title="definition">pointwise_relation</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq"><span class="id" title="inductive">eq</span></a> (<span class="id" title="definition">nth_error</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <span class="id" title="var">f</span> <span class="id" title="var">l</span>)) (<span class="id" title="keyword">fun</span> <a id="x:260" class="idref" href="#x:260"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> <span class="id" title="var">f</span> (<span class="id" title="definition">nth_error</span> <span class="id" title="var">l</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:260"><span class="id" title="variable">x</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">setoid_rewrite</span> <span class="id" title="var">req</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mapopt_option_map"><span class="id" title="lemma">mapopt_option_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="reorder_branches_map" class="idref" href="#reorder_branches_map"><span class="id" title="lemma">reorder_branches_map</span></a> <a id="i:261" class="idref" href="#i:261"><span class="id" title="binder">i</span></a> <a id="f:262" class="idref" href="#f:262"><span class="id" title="binder">f</span></a> <a id="brs:263" class="idref" href="#brs:263"><span class="id" title="binder">brs</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:261"><span class="id" title="variable">i</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:262"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:263"><span class="id" title="variable">brs</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:262"><span class="id" title="variable">f</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.m"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:261"><span class="id" title="variable">i</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:263"><span class="id" title="variable">brs</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list"><span class="id" title="definition">reorder_list</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt_map"><span class="id" title="lemma">reorder_list_opt_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_list_opt"><span class="id" title="definition">reorder_list_opt</span></a> <span class="id" title="var">tags</span> <span class="id" title="var">brs</span>) ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_csubst" class="idref" href="#optimize_csubst"><span class="id" title="lemma">optimize_csubst</span></a> {<a id="a:264" class="idref" href="#a:264"><span class="id" title="binder">a</span></a> <a id="k:265" class="idref" href="#k:265"><span class="id" title="binder">k</span></a> <a id="b:266" class="idref" href="#b:266"><span class="id" title="binder">b</span></a>} <a id="n:267" class="idref" href="#n:267"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:265"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:267"><span class="id" title="variable">n</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#b:266"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">ECSubst.csubst</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:264"><span class="id" title="variable">a</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:265"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#b:266"><span class="id" title="variable">b</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#csubst"><span class="id" title="definition">ECSubst.csubst</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:264"><span class="id" title="variable">a</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:265"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#b:266"><span class="id" title="variable">b</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- × <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Erasure.EInduction.html#term_forall_list_ind"><span class="id" title="lemma">EInduction.term_forall_list_ind</span></a>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wft</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> → ?<a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a>, ?<a class="idref" href="MetaRocq.Utils.MRProd.html#compose_on_snd"><span class="id" title="lemma">compose_on_snd</span></a>, ?<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#compose_map_def"><span class="id" title="lemma">compose_map_def</span></a>, ?<span class="id" title="lemma">length_map</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_fix_gen"><span class="id" title="definition">wf_fix</span></a>, <a class="idref" href="MetaRocq.Erasure.EAst.html#test_def"><span class="id" title="definition">test_def</span></a> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closed</span></a> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#subst"><span class="id" title="definition">subst</span></a>; <span class="id" title="tactic">simpl</span> <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closed</span></a>; <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="var">rtoProp</span>; <span class="id" title="var">solve_all</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">k</span> <span class="id" title="notation">?=</span> <span class="id" title="var">n0</span>)%<span class="id" title="var">nat</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">rtoProp</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs.wca"><span class="id" title="variable">wca</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>; <span class="id" title="var">inv</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">wft</span> ⇒ [] <span class="id" title="var">hasc</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hi</span> <span class="id" title="var">hb</span> <span class="id" title="var">hl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHb</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">toAll</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -!<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches_map"><span class="id" title="lemma">reorder_branches_map</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_all</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">optimize</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">a0</span> //. <span class="id" title="tactic">red</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">b0</span>. <span class="id" title="var">lia_f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">wft</span> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasf</span> <span class="id" title="var">hp</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hb</span> <span class="id" title="var">hwfm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> ⇒ //=. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">a0</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">red</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">b0</span>. <span class="id" title="var">lia_f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">wft</span> ⇒ [] <span class="id" title="var">hasco</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hp</span> <span class="id" title="var">hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> ⇒ //=. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">a0</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">red</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">b</span>. <span class="id" title="var">lia_f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_substl" class="idref" href="#optimize_substl"><span class="id" title="lemma">optimize_substl</span></a> <a id="s:268" class="idref" href="#s:268"><span class="id" title="binder">s</span></a> <a id="t:269" class="idref" href="#t:269"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forallb</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> 0) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:268"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:268"><span class="id" title="variable">s</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:269"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:268"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:269"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:268"><span class="id" title="variable">s</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:269"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span> |- *; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] <span class="id" title="var">cla</span> <span class="id" title="var">cls</span> <span class="id" title="var">wft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHs</span> //. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_csubst"><span class="id" title="lemma">wellformed_csubst</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_csubst"><span class="id" title="lemma">optimize_csubst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">s</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>)) //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_iota_red" class="idref" href="#optimize_iota_red"><span class="id" title="lemma">optimize_iota_red</span></a> <a id="pars:270" class="idref" href="#pars:270"><span class="id" title="binder">pars</span></a> <a id="args:271" class="idref" href="#args:271"><span class="id" title="binder">args</span></a> <a id="br:272" class="idref" href="#br:272"><span class="id" title="binder">br</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">forallb</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> 0) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:271"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:270"><span class="id" title="variable">pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:271"><span class="id" title="variable">args</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:272"><span class="id" title="variable">br</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">EGlobalEnv.iota_red</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:270"><span class="id" title="variable">pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:271"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:272"><span class="id" title="variable">br</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">EGlobalEnv.iota_red</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:270"><span class="id" title="variable">pars</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:271"><span class="id" title="variable">args</span></a>) (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:272"><span class="id" title="variable">br</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">wfa</span> <span class="id" title="var">wfbr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">EGlobalEnv.iota_red</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_substl"><span class="id" title="lemma">optimize_substl</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#forallb_rev"><span class="id" title="lemma">forallb_rev</span></a> <a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_skipn"><span class="id" title="lemma">forallb_skipn</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">List.length_rev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_rev</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_skipn"><span class="id" title="lemma">map_skipn</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_fix_subst" class="idref" href="#optimize_fix_subst"><span class="id" title="lemma">optimize_fix_subst</span></a> <a id="mfix:273" class="idref" href="#mfix:273"><span class="id" title="binder">mfix</span></a> : <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">EGlobalEnv.fix_subst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:273"><span class="id" title="variable">mfix</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">EGlobalEnv.fix_subst</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:273"><span class="id" title="variable">mfix</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fix_subst"><span class="id" title="definition">EGlobalEnv.fix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">length_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mfix</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_cofix_subst" class="idref" href="#optimize_cofix_subst"><span class="id" title="lemma">optimize_cofix_subst</span></a> <a id="mfix:274" class="idref" href="#mfix:274"><span class="id" title="binder">mfix</span></a> : <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">EGlobalEnv.cofix_subst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:274"><span class="id" title="variable">mfix</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">EGlobalEnv.cofix_subst</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:274"><span class="id" title="variable">mfix</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cofix_subst"><span class="id" title="definition">EGlobalEnv.cofix_subst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">length_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">mfix</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_cunfold_fix" class="idref" href="#optimize_cunfold_fix"><span class="id" title="lemma">optimize_cunfold_fix</span></a> <a id="mfix:275" class="idref" href="#mfix:275"><span class="id" title="binder">mfix</span></a> <a id="idx:276" class="idref" href="#idx:276"><span class="id" title="binder">idx</span></a> <a id="n:277" class="idref" href="#n:277"><span class="id" title="binder">n</span></a> <a id="f:278" class="idref" href="#f:278"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> 0 (<a class="idref" href="MetaRocq.Erasure.EAst.html#tFix"><span class="id" title="constructor">tFix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:275"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:276"><span class="id" title="variable">idx</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:275"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:276"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:277"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:278"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:275"><span class="id" title="variable">mfix</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:276"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:277"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:278"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_fix"><span class="id" title="definition">cunfold_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>. <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">hfix</span> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasfix</span> <span class="id" title="var">hlam</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hidx</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;- &lt;-] ⇒ /=. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_substl"><span class="id" title="lemma">optimize_substl</span></a> //. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_fix_subst"><span class="id" title="lemma">wellformed_fix_subst</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fix_subst_length"><span class="id" title="lemma">fix_subst_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>; <span class="id" title="var">tea</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.add_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_fix_subst"><span class="id" title="lemma">optimize_fix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="optimize_cunfold_cofix" class="idref" href="#optimize_cunfold_cofix"><span class="id" title="lemma">optimize_cunfold_cofix</span></a> <a id="mfix:279" class="idref" href="#mfix:279"><span class="id" title="binder">mfix</span></a> <a id="idx:280" class="idref" href="#idx:280"><span class="id" title="binder">idx</span></a> <a id="n:281" class="idref" href="#n:281"><span class="id" title="binder">n</span></a> <a id="f:282" class="idref" href="#f:282"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f2914edb6f70707d88d2c52f9b04b23a"><span class="id" title="variable">Σ</span></a> 0 (<a class="idref" href="MetaRocq.Erasure.EAst.html#tCoFix"><span class="id" title="constructor">tCoFix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:279"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:280"><span class="id" title="variable">idx</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:279"><span class="id" title="variable">mfix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:280"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:281"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:282"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#map_def"><span class="id" title="definition">map_def</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mfix:279"><span class="id" title="variable">mfix</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idx:280"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#n:281"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize"><span class="id" title="abbreviation">optimize</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:282"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">wfm</span> <span class="id" title="var">wca</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cunfold_cofix"><span class="id" title="definition">cunfold_cofix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>. <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">hfix</span> ⇒ [] <span class="id" title="var">hasfix</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hidx</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= &lt;- &lt;-] ⇒ /=. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_substl"><span class="id" title="lemma">optimize_substl</span></a> //. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_cofix_subst"><span class="id" title="lemma">wellformed_cofix_subst</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#cofix_subst_length"><span class="id" title="lemma">cofix_subst_length</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>; <span class="id" title="var">tea</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.add_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hfix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cofix_subst"><span class="id" title="lemma">optimize_cofix_subst</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_proofs"><span class="id" title="section">reorder_proofs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#"><span class="id" title="module">EGlobalEnv</span></a> <a class="idref" href="MetaRocq.Erasure.EExtends.html#"><span class="id" title="module">EExtends</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="extends_lookup_projection" class="idref" href="#extends_lookup_projection"><span class="id" title="lemma">extends_lookup_projection</span></a> {<a id="efl:283" class="idref" href="#efl:283"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="e39378fca6a63b9b46c8b96c180b5ee0" class="idref" href="#e39378fca6a63b9b46c8b96c180b5ee0"><span class="id" title="binder">Σ</span></a> <a id="19ebda19d4053372dae56586679c40d5" class="idref" href="#19ebda19d4053372dae56586679c40d5"><span class="id" title="binder">Σ'</span></a> <a id="p:286" class="idref" href="#p:286"><span class="id" title="binder">p</span></a>} : <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#e39378fca6a63b9b46c8b96c180b5ee0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#19ebda19d4053372dae56586679c40d5"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#19ebda19d4053372dae56586679c40d5"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#isSome"><span class="id" title="definition">isSome</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#e39378fca6a63b9b46c8b96c180b5ee0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:286"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#e39378fca6a63b9b46c8b96c180b5ee0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:286"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#19ebda19d4053372dae56586679c40d5"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:286"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ext</span> <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span>] <span class="id" title="var">cdecl</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#extends_lookup_constructor"><span class="id" title="lemma">extends_lookup_constructor</span></a> <span class="id" title="keyword">wf</span> <span class="id" title="var">ext</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hl</span>) //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*<br/>
Lemma&nbsp;wellformed_optimize_extends&nbsp;{wfl:&nbsp;EEnvFlags}&nbsp;{Σ}&nbsp;t&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;n,&nbsp;EWellformed.wellformed&nbsp;Σ&nbsp;n&nbsp;t&nbsp;-&gt;<br/>
&nbsp;&nbsp;forall&nbsp;{Σ'},&nbsp;extends&nbsp;Σ&nbsp;Σ'&nbsp;-&gt;&nbsp;wf_glob&nbsp;Σ'&nbsp;-&gt;<br/>
&nbsp;&nbsp;optimize&nbsp;Σ&nbsp;t&nbsp;=&nbsp;optimize&nbsp;Σ'&nbsp;t.<br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;t&nbsp;using&nbsp;EInduction.term_forall_list_ind;&nbsp;cbn&nbsp;-<span class="inlinecode"><span class="id" title="var">lookup_constant</span></span> <span class="inlinecode"><span class="id" title="var">lookup_inductive</span></span>
    <span class="inlinecode"><span class="id" title="var">GlobalContextMap.lookup_projection</span></span>;&nbsp;intros&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;all:unfold&nbsp;wf_fix_gen&nbsp;in&nbsp;*;&nbsp;rtoProp;&nbsp;intuition&nbsp;auto.<br/>
&nbsp;&nbsp;5:{&nbsp;destruct&nbsp;cstr_as_blocks;&nbsp;rtoProp.&nbsp;f_equal;&nbsp;eauto;&nbsp;solve_all.&nbsp;destruct&nbsp;args;&nbsp;cbn&nbsp;in&nbsp;*;&nbsp;eauto.&nbsp;}<br/>
&nbsp;&nbsp;all:f_equal;&nbsp;eauto;&nbsp;solve_all.<br/>
&nbsp;&nbsp;-&nbsp;rewrite&nbsp;!GlobalContextMap.lookup_projection_spec.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;-(extends_lookup_projection&nbsp;H0&nbsp;H1&nbsp;H3).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;lookup_projection&nbsp;as&nbsp;<span class="inlinecode">[[[]]]|</span>.&nbsp;f_equal;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;cbn&nbsp;in&nbsp;H3.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;wellformed_reorder_decl_extends&nbsp;{wfl:&nbsp;EEnvFlags}&nbsp;{Σ}&nbsp;t&nbsp;:<br/>
&nbsp;&nbsp;wf_global_decl&nbsp;Σ&nbsp;t&nbsp;-&gt;<br/>
&nbsp;&nbsp;forall&nbsp;{Σ'&nbsp;:&nbsp;GlobalContextMap.t},&nbsp;extends&nbsp;Σ&nbsp;Σ'&nbsp;-&gt;&nbsp;wf_glob&nbsp;Σ'&nbsp;-&gt;<br/>
&nbsp;&nbsp;reorder_decl&nbsp;Σ&nbsp;t&nbsp;=&nbsp;reorder_decl&nbsp;Σ'&nbsp;t.<br/>
Proof.<br/>
&nbsp;&nbsp;destruct&nbsp;t&nbsp;=&gt;&nbsp;/=&nbsp;//.<br/>
&nbsp;&nbsp;intros&nbsp;wf&nbsp;Σ'&nbsp;ext&nbsp;wf'.&nbsp;f_equal.&nbsp;unfold&nbsp;optimize_constant_decl.&nbsp;f_equal.<br/>
&nbsp;&nbsp;destruct&nbsp;(cst_body&nbsp;c)&nbsp;=&gt;&nbsp;/=&nbsp;//.&nbsp;f_equal.<br/>
&nbsp;&nbsp;now&nbsp;eapply&nbsp;wellformed_optimize_extends.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;lookup_env_reorder_env_Some&nbsp;{efl&nbsp;:&nbsp;EEnvFlags}&nbsp;{Σ}&nbsp;kn&nbsp;d&nbsp;:<br/>
&nbsp;&nbsp;wf_glob&nbsp;Σ&nbsp;-&gt;<br/>
&nbsp;&nbsp;GlobalContextMap.lookup_env&nbsp;Σ&nbsp;kn&nbsp;=&nbsp;Some&nbsp;d&nbsp;-&gt;<br/>
&nbsp;&nbsp;∑&nbsp;Σ'&nbsp;:&nbsp;GlobalContextMap.t,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">extends_prefix</span></span> <span class="inlinecode"><span class="id" title="var">Σ'</span></span> <span class="inlinecode"><span class="id" title="var">Σ</span>,</span> <span class="inlinecode"><span class="id" title="var">wf_global_decl</span></span> <span class="inlinecode"><span class="id" title="var">Σ'</span></span> <span class="inlinecode"><span class="id" title="var">d</span></span> <span class="inlinecode">&amp;</span>
      <span class="inlinecode"><span class="id" title="var">lookup_env</span></span> <span class="inlinecode">(<span class="id" title="var">reorder_env</span></span> <span class="inlinecode"><span class="id" title="var">Σ</span>)</span> <span class="inlinecode"><span class="id" title="var">kn</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Some</span></span> <span class="inlinecode">(<span class="id" title="var">reorder_decl</span></span> <span class="inlinecode"><span class="id" title="var">Σ'</span></span> <span class="inlinecode"><span class="id" title="var">d</span>)</span>.<br/>
Proof.<br/>
&nbsp;&nbsp;rewrite&nbsp;GlobalContextMap.lookup_env_spec.<br/>
&nbsp;&nbsp;destruct&nbsp;Σ&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Σ</span></span> <span class="inlinecode"><span class="id" title="var">map</span></span> <span class="inlinecode"><span class="id" title="var">repr</span></span> <span class="inlinecode"><span class="id" title="keyword">wf</span></span>.<br/>
&nbsp;&nbsp;induction&nbsp;Σ&nbsp;in&nbsp;map,&nbsp;repr,&nbsp;wf&nbsp;|-&nbsp;*;&nbsp;simpl;&nbsp;auto&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;intros&nbsp;wfg.<br/>
&nbsp;&nbsp;case:&nbsp;eqb_specT&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;-&nbsp;intros&nbsp;-&gt;.&nbsp;cbn.&nbsp;intros&nbsp;<span class="inlinecode">=</span> <span class="inlinecode">&lt;-</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;(GlobalContextMap.make&nbsp;Σ&nbsp;(fresh_globals_cons_inv&nbsp;wf)).&nbsp;split.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;eexists&nbsp;<span class="inlinecode"><span class="id" title="var">_</span></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cbn.&nbsp;now&nbsp;depelim&nbsp;wfg.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;f_equal.&nbsp;symmetry.&nbsp;eapply&nbsp;wellformed_reorder_decl_extends.&nbsp;cbn.&nbsp;now&nbsp;depelim&nbsp;wfg.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;extends_prefix_extends.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cbn.&nbsp;now&nbsp;exists&nbsp;<span class="inlinecode"><span class="id" title="var">a</span></span>.&nbsp;now&nbsp;cbn.&nbsp;now&nbsp;cbn.<br/>
&nbsp;&nbsp;-&nbsp;intros&nbsp;_.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;(Σ'&nbsp;:=&nbsp;GlobalContextMap.make&nbsp;Σ&nbsp;(fresh_globals_cons_inv&nbsp;wf)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;specialize&nbsp;(IHΣ&nbsp;(GlobalContextMap.map&nbsp;Σ')&nbsp;(GlobalContextMap.repr&nbsp;Σ')&nbsp;(GlobalContextMap.wf&nbsp;Σ')).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cbn&nbsp;in&nbsp;IHΣ.&nbsp;forward&nbsp;IHΣ.&nbsp;now&nbsp;depelim&nbsp;wfg.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;hl.&nbsp;specialize&nbsp;(IHΣ&nbsp;hl)&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Σ''</span></span> <span class="inlinecode">[<span class="id" title="var">ext</span></span> <span class="inlinecode"><span class="id" title="var">wfgd</span></span> <span class="inlinecode"><span class="id" title="var">hl'</span>]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;Σ''.&nbsp;split&nbsp;=&gt;&nbsp;//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;destruct&nbsp;ext&nbsp;as&nbsp;<span class="inlinecode">?</span> <span class="inlinecode">→</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;exists&nbsp;(a&nbsp;::&nbsp;x).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;rewrite&nbsp;-hl'.&nbsp;f_equal.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;-wfg.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;map_ext_in&nbsp;=&gt;&nbsp;kn&nbsp;hin.&nbsp;unfold&nbsp;on_snd.&nbsp;f_equal.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetry.&nbsp;eapply&nbsp;wellformed_reorder_decl_extends&nbsp;=&gt;&nbsp;//.&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;lookup_env_In&nbsp;in&nbsp;hin.&nbsp;2:now&nbsp;depelim&nbsp;wfg.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depelim&nbsp;wfg.&nbsp;eapply&nbsp;lookup_env_wellformed;&nbsp;tea.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;extends_prefix_extends.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbn.&nbsp;now&nbsp;exists&nbsp;<span class="inlinecode"><span class="id" title="var">a</span></span>.&nbsp;now&nbsp;cbn.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;lookup_env_map_snd&nbsp;Σ&nbsp;f&nbsp;kn&nbsp;:&nbsp;lookup_env&nbsp;(List.map&nbsp;(on_snd&nbsp;f)&nbsp;Σ)&nbsp;kn&nbsp;=&nbsp;option_map&nbsp;f&nbsp;(lookup_env&nbsp;Σ&nbsp;kn).<br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;Σ;&nbsp;cbn;&nbsp;auto.<br/>
&nbsp;&nbsp;case:&nbsp;eqb_spec&nbsp;=&gt;&nbsp;//.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;lookup_env_reorder_env_None&nbsp;{efl&nbsp;:&nbsp;EEnvFlags}&nbsp;{Σ}&nbsp;kn&nbsp;:<br/>
&nbsp;&nbsp;GlobalContextMap.lookup_env&nbsp;Σ&nbsp;kn&nbsp;=&nbsp;None&nbsp;-&gt;<br/>
&nbsp;&nbsp;lookup_env&nbsp;(reorder_env&nbsp;Σ)&nbsp;kn&nbsp;=&nbsp;None.<br/>
Proof.<br/>
&nbsp;&nbsp;rewrite&nbsp;GlobalContextMap.lookup_env_spec.<br/>
&nbsp;&nbsp;destruct&nbsp;Σ&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Σ</span></span> <span class="inlinecode"><span class="id" title="var">map</span></span> <span class="inlinecode"><span class="id" title="var">repr</span></span> <span class="inlinecode"><span class="id" title="keyword">wf</span></span>.<br/>
&nbsp;&nbsp;cbn.&nbsp;intros&nbsp;hl.&nbsp;rewrite&nbsp;lookup_env_map_snd&nbsp;hl&nbsp;//.<br/>
Qed.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="reorder_mapping" class="idref" href="#reorder_mapping"><span class="id" title="section">reorder_mapping</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="reorder_mapping.efl" class="idref" href="#reorder_mapping.efl"><span class="id" title="variable">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="reorder_mapping.wca" class="idref" href="#reorder_mapping.wca"><span class="id" title="variable">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="reorder_mapping.mapping" class="idref" href="#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#inductives_mapping"><span class="id" title="definition">inductives_mapping</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="1359f4aef81d7098a81416b552bf9230" class="idref" href="#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.EAst.html#global_context"><span class="id" title="abbreviation">global_context</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<a id="reorder_mapping.wfm" class="idref" href="#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="reorder" class="idref" href="#reorder"><span class="id" title="abbreviation">reorder</span></a> := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="reorder_decl" class="idref" href="#reorder_decl"><span class="id" title="abbreviation">reorder_decl</span></a> := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_decl"><span class="id" title="definition">reorder_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a id="reorder_env" class="idref" href="#reorder_env"><span class="id" title="abbreviation">reorder_env</span></a> := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_propositional_optimize" class="idref" href="#is_propositional_optimize"><span class="id" title="lemma">is_propositional_optimize</span></a> <a id="ind:292" class="idref" href="#ind:292"><span class="id" title="binder">ind</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:292"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="abbreviation">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:292"><span class="id" title="variable">ind</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> ⇒ <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span>|]|] ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_mapi"><span class="id" title="lemma">nth_error_mapi</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> ⇒ //=. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|]=&gt; //=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_inductive_pars_optimize" class="idref" href="#lookup_inductive_pars_optimize"><span class="id" title="lemma">lookup_inductive_pars_optimize</span></a> <a id="ind:293" class="idref" href="#ind:293"><span class="id" title="binder">ind</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive_pars"><span class="id" title="definition">EGlobalEnv.lookup_inductive_pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:293"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive_pars"><span class="id" title="definition">EGlobalEnv.lookup_inductive_pars</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="abbreviation">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:293"><span class="id" title="variable">ind</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive_pars"><span class="id" title="definition">lookup_inductive_pars</span></a> ⇒ <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span>|]|] ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="is_propositional_cstr_optimize" class="idref" href="#is_propositional_cstr_optimize"><span class="id" title="lemma">is_propositional_cstr_optimize</span></a> <a id="ind:294" class="idref" href="#ind:294"><span class="id" title="binder">ind</span></a> <a id="c:295" class="idref" href="#c:295"><span class="id" title="binder">c</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:294"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:295"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="abbreviation">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:294"><span class="id" title="variable">ind</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.mapping"><span class="id" title="variable">mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:294"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:295"><span class="id" title="variable">c</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> ⇒ <span class="id" title="keyword">wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>] <span class="id" title="var">cb</span>]|] ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|]=&gt; //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="closed_iota_red" class="idref" href="#closed_iota_red"><span class="id" title="lemma">closed_iota_red</span></a> <a id="pars:296" class="idref" href="#pars:296"><span class="id" title="binder">pars</span></a> <a id="c:297" class="idref" href="#c:297"><span class="id" title="binder">c</span></a> <a id="args:298" class="idref" href="#args:298"><span class="id" title="binder">args</span></a> <a id="brs:299" class="idref" href="#brs:299"><span class="id" title="binder">brs</span></a> <a id="br:300" class="idref" href="#br:300"><span class="id" title="binder">br</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">forallb</span> (<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> 0) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:298"><span class="id" title="variable">args</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#brs:299"><span class="id" title="variable">brs</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:297"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:300"><span class="id" title="variable">br</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:296"><span class="id" title="variable">pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:298"><span class="id" title="variable">args</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:300"><span class="id" title="variable">br</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">closedn</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:300"><span class="id" title="variable">br</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:300"><span class="id" title="variable">br</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:296"><span class="id" title="variable">pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:298"><span class="id" title="variable">args</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#br:300"><span class="id" title="variable">br</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clargs</span> <span class="id" title="var">hnth</span> <span class="id" title="var">hskip</span> <span class="id" title="var">clbr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#iota_red"><span class="id" title="definition">iota_red</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#closed_substl"><span class="id" title="lemma">ECSubst.closed_substl</span></a> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#forallb_rev"><span class="id" title="lemma">forallb_rev</span></a> <a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_skipn"><span class="id" title="lemma">forallb_skipn</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">List.length_rev</span> <span class="id" title="var">hskip</span> <span class="id" title="lemma">Nat.add_0_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="isFix_mkApps" class="idref" href="#isFix_mkApps"><span class="id" title="lemma">isFix_mkApps</span></a> <a id="t:301" class="idref" href="#t:301"><span class="id" title="binder">t</span></a> <a id="l:302" class="idref" href="#l:302"><span class="id" title="binder">l</span></a> : <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isFix"><span class="id" title="definition">isFix</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:301"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:302"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isFix"><span class="id" title="definition">isFix</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:301"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#l:302"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span> <span class="id" title="notation">[]</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> | <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Utils.MRList.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">andb_true_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> /=. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ⇒ /= //; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">andb_false_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="constructor_isprop_pars_decl_inductive" class="idref" href="#constructor_isprop_pars_decl_inductive"><span class="id" title="lemma">constructor_isprop_pars_decl_inductive</span></a> {<a id="ind:304" class="idref" href="#ind:304"><span class="id" title="binder">ind</span></a> <a id="c:305" class="idref" href="#c:305"><span class="id" title="binder">c</span></a>} {<a id="prop:306" class="idref" href="#prop:306"><span class="id" title="binder">prop</span></a> <a id="pars:307" class="idref" href="#pars:307"><span class="id" title="binder">pars</span></a> <a id="cdecl:308" class="idref" href="#cdecl:308"><span class="id" title="binder">cdecl</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:304"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:305"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#prop:306"><span class="id" title="variable">prop</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:307"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cdecl:308"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>  <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:304"><span class="id" title="variable">ind</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#prop:306"><span class="id" title="variable">prop</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#pars:307"><span class="id" title="variable">pars</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#inductive_isprop_and_pars"><span class="id" title="definition">inductive_isprop_and_pars</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span>]|]=&gt; /= //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> ⇒ //. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="constructor_isprop_pars_decl_constructor" class="idref" href="#constructor_isprop_pars_decl_constructor"><span class="id" title="lemma">constructor_isprop_pars_decl_constructor</span></a> {<a id="ind:309" class="idref" href="#ind:309"><span class="id" title="binder">ind</span></a> <a id="c:310" class="idref" href="#c:310"><span class="id" title="binder">c</span></a>} {<a id="mdecl:311" class="idref" href="#mdecl:311"><span class="id" title="binder">mdecl</span></a> <a id="idecl:312" class="idref" href="#idecl:312"><span class="id" title="binder">idecl</span></a> <a id="cdecl:313" class="idref" href="#cdecl:313"><span class="id" title="binder">cdecl</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:309"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:310"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mdecl:311"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:312"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cdecl:313"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#ind:309"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#c:310"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EAst.html#ind_propositional"><span class="id" title="projection">ind_propositional</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#idecl:312"><span class="id" title="variable">idecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_npars"><span class="id" title="projection">ind_npars</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#mdecl:311"><span class="id" title="variable">mdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#cdecl:313"><span class="id" title="variable">cdecl</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a>. <span class="id" title="tactic">intros</span> → ⇒ /= //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_mkApps" class="idref" href="#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> {<a id="hasapp:314" class="idref" href="#hasapp:314"><span class="id" title="binder">hasapp</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a>} <a id="k:315" class="idref" href="#k:315"><span class="id" title="binder">k</span></a> <a id="f:316" class="idref" href="#f:316"><span class="id" title="binder">f</span></a> <a id="args:317" class="idref" href="#args:317"><span class="id" title="binder">args</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:315"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:316"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="definition">forallb</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:315"><span class="id" title="variable">k</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:317"><span class="id" title="variable">args</span></a>) (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:315"><span class="id" title="variable">k</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#mkApps"><span class="id" title="definition">mkApps</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f:316"><span class="id" title="variable">f</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#args:317"><span class="id" title="variable">args</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_mkApps"><span class="id" title="lemma">wellformed_mkApps</span></a> //. <span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="substl_closed" class="idref" href="#substl_closed"><span class="id" title="lemma">substl_closed</span></a> <a id="s:318" class="idref" href="#s:318"><span class="id" title="binder">s</span></a> <a id="t:319" class="idref" href="#t:319"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:319"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:318"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:319"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:319"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span> |- *; <span class="id" title="var">cbn</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">clt</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ECSubst.html#csubst_closed"><span class="id" title="lemma">csubst_closed</span></a> //. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHs</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="substl_rel" class="idref" href="#substl_rel"><span class="id" title="lemma">substl_rel</span></a> <a id="s:320" class="idref" href="#s:320"><span class="id" title="binder">s</span></a> <a id="k:321" class="idref" href="#k:321"><span class="id" title="binder">k</span></a> <a id="a:322" class="idref" href="#a:322"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">closed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:322"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">nth_error</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:320"><span class="id" title="variable">s</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:321"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:322"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#s:320"><span class="id" title="variable">s</span></a> (<a class="idref" href="MetaRocq.Erasure.EAst.html#tRel"><span class="id" title="constructor">tRel</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#k:321"><span class="id" title="variable">k</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a:322"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_nil"><span class="id" title="lemma">nth_error_nil</span></a> //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> [= -&gt;]. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#substl_closed"><span class="id" title="lemma">substl_closed</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> <span class="id" title="var">hnth</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHs</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;EEnvFlags&nbsp;is&nbsp;reorder_env_flags&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_correct" class="idref" href="#optimize_correct"><span class="id" title="lemma">optimize_correct</span></a> {<a id="fl:323" class="idref" href="#fl:323"><span class="id" title="binder">fl</span></a>} <a id="t:324" class="idref" href="#t:324"><span class="id" title="binder">t</span></a> <a id="v:325" class="idref" href="#v:325"><span class="id" title="binder">v</span></a> {<a id="withc:326" class="idref" href="#withc:326"><span class="id" title="binder">withc</span></a> : <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_constructor_as_block"><span class="id" title="method">with_constructor_as_block</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#has_tApp"><span class="id" title="method">has_tApp</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fl:323"><span class="id" title="variable">fl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:324"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#v:325"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed"><span class="id" title="definition">wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a> 0 <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:324"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fl:323"><span class="id" title="variable">fl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="abbreviation">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="abbreviation">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:324"><span class="id" title="variable">t</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="abbreviation">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#v:325"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hastapp</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ev</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">cla</span> <span class="id" title="var">clt</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">ev1</span> ⇒ /= /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasl</span> <span class="id" title="var">ev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_csubst"><span class="id" title="lemma">optimize_csubst</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> 1) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_csubst"><span class="id" title="lemma">wellformed_csubst</span></a> ⇒ //.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">haslet</span> <span class="id" title="var">clb0</span> <span class="id" title="var">clb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_csubst"><span class="id" title="lemma">wellformed_csubst</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> -(<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_csubst"><span class="id" title="lemma">optimize_csubst</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> 1) //.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] <span class="id" title="var">hascase</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hl</span> <span class="id" title="var">wfd</span> <span class="id" title="var">wfbrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">wfc'</span> <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wfbrs</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.add_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfbrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_iota_red"><span class="id" title="lemma">wellformed_iota_red</span></a>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_iota_red"><span class="id" title="lemma">optimize_iota_red</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">IHev2</span> ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#is_propositional_cstr_optimize"><span class="id" title="lemma">is_propositional_cstr_optimize</span></a> //. <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches_map"><span class="id" title="lemma">reorder_branches_map</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_ordinal"><span class="id" title="definition">lookup_constructor_ordinal</span></a> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_mapping"><span class="id" title="definition">lookup_constructor_mapping</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hla</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">li</span> ⇒ //. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.eqb_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wftags</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">li</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wfmap</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_spec"><span class="id" title="lemma">lookup_inductive_assoc_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wfbrl</span> : <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">brs</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <span class="id" title="var">oib</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wftbrs</span> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <span class="id" title="var">tags</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="var">brs</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">move</span>: <span class="id" title="var">wftags</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> -<span class="id" title="var">wfbrl</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag"><span class="id" title="definition">new_tag</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnewt</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#new_tag_spec"><span class="id" title="lemma">new_tag_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hnewt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#nth_error_reorder"><span class="id" title="lemma">nth_error_reorder</span></a> <span class="id" title="var">wftbrs</span> <span class="id" title="var">hnewt</span>) <span class="id" title="var">e2</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">move</span>: <span class="id" title="var">wftbrs</span> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">htbrs</span> <span class="id" title="var">wftag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#find_tag_wf"><span class="id" title="lemma">find_tag_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wftag</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_Some_length"><span class="id" title="lemma">nth_error_Some_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">htbrs</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e2</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">len</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] <span class="id" title="var">hascase</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hl</span> <span class="id" title="var">wfd</span> <span class="id" title="var">wfbrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">hl</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_brs"><span class="id" title="definition">wf_brs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">li</span> ⇒ //. <span class="id" title="tactic">move</span>/<span class="id" title="lemma">Nat.eqb_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">len</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfbrs</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">brs</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfbrs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Nat.add_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfbrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">wfbrs</span> ⇒ [] <span class="id" title="var">wfbrs</span> <span class="id" title="var">_</span>. <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">hlen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_substl"><span class="id" title="lemma">wellformed_substl</span></a>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#forallb_repeat"><span class="id" title="lemma">forallb_repeat</span></a> //. <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_iota_sing"><span class="id" title="constructor">eval_iota_sing</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#is_propositional_optimize"><span class="id" title="lemma">is_propositional_optimize</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hla</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wftags</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">li</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wfmap</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_spec"><span class="id" title="lemma">lookup_inductive_assoc_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wftbrs</span> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <span class="id" title="var">tags</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><span class="id" title="notation">[</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">f4</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">move</span>: <span class="id" title="var">wftags</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> //=. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hlen</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">wftbrs</span> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<span class="id" title="lemma">Nat.eqb_eq</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> ⇒ //=. <span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> ⇒ //= <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a> ⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">ht</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">ht</span> ⇒ //= /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<span class="id" title="lemma">Nat.ltb_lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n0</span> ⇒ //. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n0</span> ⇒ //. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ECSubst.html#substl"><span class="id" title="definition">substl</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_substl"><span class="id" title="lemma">optimize_substl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#1359f4aef81d7098a81416b552bf9230"><span class="id" title="variable">Σ</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">IHev2</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#forallb_repeat"><span class="id" title="lemma">forallb_repeat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ERemoveParams.html#map_repeat"><span class="id" title="lemma">map_repeat</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev2</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">wff</span> <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_fix"><span class="id" title="constructor">eval_fix</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">length_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cunfold_fix"><span class="id" title="lemma">optimize_cunfold_fix</span></a>; <span class="id" title="var">tea</span>); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_mkApps"><span class="id" title="lemma">wellformed_mkApps</span></a> // <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>; <span class="id" title="var">tas</span> ⇒ //. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ev2</span> /= !<span class="id" title="lemma">andb_true_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hastapp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_cunfold_fix"><span class="id" title="lemma">wellformed_cunfold_fix</span></a>; <span class="id" title="var">tea</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">clfix</span> <span class="id" title="var">clargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>; <span class="id" title="var">tas</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span> |- ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_fix_value"><span class="id" title="constructor">eval_fix_value</span></a>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cunfold_fix"><span class="id" title="lemma">optimize_cunfold_fix</span></a>; <span class="id" title="tactic">eauto</span>); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">length_map</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev2</span>; <span class="id" title="var">tas</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_fix'"><span class="id" title="constructor">eval_fix'</span></a>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cunfold_fix"><span class="id" title="lemma">optimize_cunfold_fix</span></a>; <span class="id" title="tactic">eauto</span>); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev2</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>; <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hastapp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_cunfold_fix"><span class="id" title="lemma">wellformed_cunfold_fix</span></a>; <span class="id" title="var">tea</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] <span class="id" title="var">hascase</span> /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hl</span> <span class="id" title="var">cd</span> <span class="id" title="var">clbrs</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">cd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">wfcof</span> <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_mkApps"><span class="id" title="lemma">wellformed_mkApps</span></a> // /= <span class="id" title="var">wfargs</span> <span class="id" title="var">clbrs</span> !<span class="id" title="lemma">andb_true_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hascase</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_cunfold_cofix"><span class="id" title="lemma">wellformed_cunfold_cofix</span></a>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>, <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_cofix_case"><span class="id" title="constructor">eval_cofix_case</span></a>. <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cunfold_cofix"><span class="id" title="lemma">optimize_cunfold_cofix</span></a>; <span class="id" title="var">tea</span>); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHev2</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasproj</span> <span class="id" title="var">hl</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <span class="id" title="keyword">as</span> [[[[<span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span>] <span class="id" title="var">cdecl</span>] <span class="id" title="var">pdecl</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">wfcof</span> <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> /= <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_mkApps"><span class="id" title="lemma">wellformed_mkApps</span></a> // <span class="id" title="var">wfargs</span> <span class="id" title="lemma">andb_true_r</span> <span class="id" title="var">hasproj</span> <span class="id" title="lemma">andb_true_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_cunfold_cofix"><span class="id" title="lemma">wellformed_cunfold_cofix</span></a>; <span class="id" title="var">tea</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_cofix_proj"><span class="id" title="constructor">eval_cofix_proj</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_cunfold_cofix"><span class="id" title="lemma">optimize_cunfold_cofix</span></a>; <span class="id" title="var">tea</span>); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev2</span> ⇒ //.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">isdecl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constant"><span class="id" title="definition">lookup_constant</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">isdecl</span> /= ⇒ <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">cst_body</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constant"><span class="id" title="definition">declared_constant</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a> <span class="id" title="var">isdecl</span> //=. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#lookup_env_wellformed"><span class="id" title="lemma">lookup_env_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wfΣ</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">wfΣ</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_global_decl"><span class="id" title="definition">wf_global_decl</span></a> /=.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasproj</span> <span class="id" title="var">iss</span> <span class="id" title="var">cld</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/(@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_mkApps"><span class="id" title="lemma">wf_mkApps</span></a> <span class="id" title="var">hastapp</span>): <span class="id" title="var">ev1</span> ⇒ [] <span class="id" title="var">wfc</span> <span class="id" title="var">wfargs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection"><span class="id" title="definition">lookup_projection</span></a> <span class="id" title="keyword">as</span> [[[[<span class="id" title="var">mdecl</span> <span class="id" title="var">idecl</span>] <span class="id" title="var">cdecl'</span>] <span class="id" title="var">pdecl</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hl'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_projection_lookup_constructor"><span class="id" title="lemma">lookup_projection_lookup_constructor</span></a> <span class="id" title="var">hl'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#constructor_isprop_pars_decl_constructor"><span class="id" title="lemma">constructor_isprop_pars_decl_constructor</span></a> <span class="id" title="var">H</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>. <span class="id" title="var">noconf</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev1</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">IHev2</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#nth_error_forallb"><span class="id" title="lemma">nth_error_forallb</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wfargs</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">lp</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_projection_reorder"><span class="id" title="lemma">lookup_projection_reorder</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">p</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">lp</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl'</span> /= <span class="id" title="tactic">in</span> <span class="id" title="var">lp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">lpo</span> := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_projection_ordinal"><span class="id" title="lemma">lookup_projection_ordinal</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping.wfm"><span class="id" title="variable">wfm</span></a> <span class="id" title="var">p</span> <span class="id" title="var">wfΣ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forward</span> <span class="id" title="var">lpo</span> <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lpo</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_proj"><span class="id" title="constructor">eval_proj</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">lpo</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#is_propositional_cstr_optimize"><span class="id" title="lemma">is_propositional_cstr_optimize</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#constructor_isprop_pars_decl"><span class="id" title="definition">constructor_isprop_pars_decl</span></a> // <span class="id" title="var">H</span> //= // <span class="id" title="var">H0</span> <span class="id" title="var">H1</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">len</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> <span class="id" title="var">e3</span> //.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasproj</span> <span class="id" title="var">hl</span> <span class="id" title="var">hd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_proj_prop"><span class="id" title="constructor">eval_proj_prop</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#is_propositional_optimize"><span class="id" title="lemma">is_propositional_optimize</span></a> //.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_construct"><span class="id" title="constructor">eval_construct</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> //. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e0</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHev1</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev2</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">congruence</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> ⇒ [] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">hasapp</span> <span class="id" title="var">clf</span> <span class="id" title="var">cla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev1</span> <span class="id" title="var">clf</span>). <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHev2</span> <span class="id" title="var">cla</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_app_cong"><span class="id" title="constructor">eval_app_cong</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_to_value"><span class="id" title="lemma">eval_to_value</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ev1</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">depelim</span> <span class="id" title="var">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ⇒ //; <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> /= !<span class="id" title="lemma">orb_false_r</span> <span class="id" title="lemma">orb_true_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#with_guarded_fix"><span class="id" title="method">with_guarded_fix</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>: <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#negb_or"><span class="id" title="lemma">negb_or</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isFixApp_mkApps"><span class="id" title="lemma">isFixApp_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isLazyApp_mkApps"><span class="id" title="lemma">isLazyApp_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Utils.MRList.html#rev_case"><span class="id" title="lemma">rev_case</span></a> ⇒ // /=. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_app</span> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> /= //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">andb_true_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>;  <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span> ⇒ /= //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>: <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#negb_or"><span class="id" title="lemma">negb_or</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isConstructApp_mkApps"><span class="id" title="lemma">isConstructApp_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isPrimApp_mkApps"><span class="id" title="lemma">isPrimApp_mkApps</span></a> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#isLazyApp_mkApps"><span class="id" title="lemma">isLazyApp_mkApps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Utils.MRList.html#rev_case"><span class="id" title="lemma">rev_case</span></a> ⇒ // /=. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_app</span> !<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#mkApps_app"><span class="id" title="lemma">mkApps_app</span></a> /= //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span> ⇒ /= //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EPrimitive.html#All2_over_undep"><span class="id" title="lemma">All2_over_undep</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EPrimitive.html#All2_Set_All2"><span class="id" title="lemma">All2_Set_All2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EPrimitive.html#All2_All2_Set"><span class="id" title="lemma">All2_All2_Set</span></a>. <span class="id" title="var">primProp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">a0</span> <span class="id" title="var">a'</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">primProp</span>; <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>⇒ /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">haslazy</span> <span class="id" title="keyword">wf</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHev2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval_wellformed"><span class="id" title="lemma">eval_wellformed</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ev1</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">ev1</span> ⇒ []; <span class="id" title="var">tea</span> ⇒ //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#atom"><span class="id" title="definition">atom</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a>] <span class="id" title="tactic">in</span> <span class="id" title="var">i</span> |- ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span>. 2:<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a>]. <span class="id" title="var">rtoProp</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_constructor"><span class="id" title="definition">lookup_constructor</span></a> ⇒ //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_mapping"><span class="id" title="section">reorder_mapping</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_inductive_mapping_inv" class="idref" href="#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a> {<a id="efl:327" class="idref" href="#efl:327"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} <a id="d:328" class="idref" href="#d:328"><span class="id" title="binder">d</span></a> <a id="43175fea6c1b0fa7d9af888630299e40" class="idref" href="#43175fea6c1b0fa7d9af888630299e40"><span class="id" title="binder">Σ</span></a> <a id="m:330" class="idref" href="#m:330"><span class="id" title="binder">m</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:328"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#43175fea6c1b0fa7d9af888630299e40"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:328"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#43175fea6c1b0fa7d9af888630299e40"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:330"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:328"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#InductiveDecl"><span class="id" title="constructor">InductiveDecl</span></a> <span class="id" title="var">mib</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <a id="i:331" class="idref" href="#i:331"><span class="id" title="binder">i</span></a> <a id="oib:332" class="idref" href="#oib:332"><span class="id" title="binder">oib</span></a>, <span class="id" title="definition">nth_error</span> <span class="id" title="var">mib</span>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_bodies"><span class="id" title="projection">ind_bodies</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:331"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:332"><span class="id" title="variable">oib</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:330"><span class="id" title="variable">m</span></a> {| <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#d:328"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>; <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:331"><span class="id" title="variable">i</span></a> |} <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">na</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">tags</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <span class="id" title="var">tags</span> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:332"><span class="id" title="variable">oib</span></a>.(<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a>)<a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.EAst.html#ConstantDecl"><span class="id" title="constructor">ConstantDecl</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#43175fea6c1b0fa7d9af888630299e40"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:330"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">wfm</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">revgoals</span>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping"><span class="id" title="definition">wf_inductive_mapping</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ind</span> [<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">mib</span> <span class="id" title="var">oib</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">li</span> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">wfΣ</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">li</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a>.<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> &lt;-.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d0</span> ⇒ //. <span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">hnth</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [= → -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span>:= <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env_Some_fresh"><span class="id" title="lemma">lookup_env_Some_fresh</span></a> <span class="id" title="var">hle</span>. <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> ⇒ //=. <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> ⇒ //. <span class="id" title="var">now</span> <span class="id" title="tactic">intros</span> [= → -&gt;].<br/>
&nbsp;&nbsp;× <span class="id" title="var">depelim</span> <span class="id" title="var">wfΣ</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">li</span>. <span class="id" title="var">cbn</span>; <span class="id" title="tactic">case</span>: <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> &lt;-. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d0</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hle</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span>:= <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env_Some_fresh"><span class="id" title="lemma">lookup_env_Some_fresh</span></a> <span class="id" title="var">hle</span>. <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hle</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span>:= <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env_Some_fresh"><span class="id" title="lemma">lookup_env_Some_fresh</span></a> <span class="id" title="var">hle</span>. <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span>. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> ⇒ //=. <span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="definition">nth_error</span> ⇒ //.<br/>
&nbsp;&nbsp;× <span class="id" title="var">depelim</span> <span class="id" title="var">wfΣ</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d0</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">oib</span> <span class="id" title="var">hnth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hla</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hla'</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc_wf_tags"><span class="id" title="lemma">lookup_inductive_assoc_wf_tags</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">wfm</span> <span class="id" title="var">_</span> <span class="id" title="var">hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">hla'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_inductive"><span class="id" title="definition">lookup_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_minductive"><span class="id" title="definition">lookup_minductive</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_refl"><span class="id" title="lemma">eqb_refl</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hnth</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#"><span class="id" title="library">EEtaExpanded</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_expanded" class="idref" href="#optimize_expanded"><span class="id" title="lemma">optimize_expanded</span></a> {<a id="7fd199207e6709143aa4215530ad32c7" class="idref" href="#7fd199207e6709143aa4215530ad32c7"><span class="id" title="binder">Σ</span></a> <a id="m:334" class="idref" href="#m:334"><span class="id" title="binder">m</span></a>} <a id="t:335" class="idref" href="#t:335"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#7fd199207e6709143aa4215530ad32c7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:334"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded"><span class="id" title="inductive">expanded</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#7fd199207e6709143aa4215530ad32c7"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:335"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded"><span class="id" title="inductive">expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:334"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#7fd199207e6709143aa4215530ad32c7"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:334"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:335"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1 <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_ind"><span class="id" title="lemma">expanded_ind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span>[<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">solve_all</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_mkApps_expanded"><span class="id" title="lemma">expanded_mkApps_expanded</span></a> ⇒ //. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> ⇒ //; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#All_reorder_list"><span class="id" title="lemma">All_reorder_list</span></a>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_tFix"><span class="id" title="constructor">expanded_tFix</span></a>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#isLambda_optimize"><span class="id" title="lemma">isLambda_optimize</span></a> //.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constructor_lookup"><span class="id" title="lemma">declared_constructor_lookup</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hl</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">wfm</span> <span class="id" title="var">ind</span> <span class="id" title="var">idx</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> /= <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_tConstruct_app"><span class="id" title="constructor">expanded_tConstruct_app</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_declared_constructor"><span class="id" title="lemma">lookup_declared_constructor</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">len</span>. <span class="id" title="var">now</span> <span class="id" title="var">solve_all</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_expanded_decl" class="idref" href="#optimize_expanded_decl"><span class="id" title="lemma">optimize_expanded_decl</span></a> {<a id="85ea6b86346d1ebf33501d8cfcb67403" class="idref" href="#85ea6b86346d1ebf33501d8cfcb67403"><span class="id" title="binder">Σ</span></a> <a id="m:337" class="idref" href="#m:337"><span class="id" title="binder">m</span></a> <a id="kn:338" class="idref" href="#kn:338"><span class="id" title="binder">kn</span></a> <a id="t:339" class="idref" href="#t:339"><span class="id" title="binder">t</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#85ea6b86346d1ebf33501d8cfcb67403"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:337"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_decl"><span class="id" title="definition">expanded_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#85ea6b86346d1ebf33501d8cfcb67403"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:339"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_decl"><span class="id" title="definition">expanded_decl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:337"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#85ea6b86346d1ebf33501d8cfcb67403"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_decl"><span class="id" title="definition">reorder_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:337"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:338"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:339"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [[[]]|] ⇒ /= //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_constant_decl"><span class="id" title="definition">expanded_constant_decl</span></a> ⇒ /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded"><span class="id" title="lemma">optimize_expanded</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="reorder_env_expanded" class="idref" href="#reorder_env_expanded"><span class="id" title="lemma">reorder_env_expanded</span></a> {<a id="efl:340" class="idref" href="#efl:340"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="34496b28ad441530bfbf2cda65fcfc0c" class="idref" href="#34496b28ad441530bfbf2cda65fcfc0c"><span class="id" title="binder">Σ</span></a> <a id="m:342" class="idref" href="#m:342"><span class="id" title="binder">m</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#34496b28ad441530bfbf2cda65fcfc0c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:342"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#34496b28ad441530bfbf2cda65fcfc0c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#34496b28ad441530bfbf2cda65fcfc0c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:342"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#34496b28ad441530bfbf2cda65fcfc0c"><span class="id" title="variable">Σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a>; <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">wfg</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">exp</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHexp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHexp</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">wfg</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded_decl"><span class="id" title="lemma">optimize_expanded_decl</span></a>). <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#"><span class="id" title="library">EEtaExpandedFix</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_expanded_fix" class="idref" href="#optimize_expanded_fix"><span class="id" title="lemma">optimize_expanded_fix</span></a> {<a id="9fc8caaf18e0ccd741d3dd01a221533b" class="idref" href="#9fc8caaf18e0ccd741d3dd01a221533b"><span class="id" title="binder">Σ</span></a> <a id="a9ed3f62f59098fa7a7be0d7917e1e15" class="idref" href="#a9ed3f62f59098fa7a7be0d7917e1e15"><span class="id" title="binder">Γ</span></a> <a id="m:345" class="idref" href="#m:345"><span class="id" title="binder">m</span></a>} <a id="t:346" class="idref" href="#t:346"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#9fc8caaf18e0ccd741d3dd01a221533b"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:345"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded"><span class="id" title="inductive">expanded</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#9fc8caaf18e0ccd741d3dd01a221533b"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a9ed3f62f59098fa7a7be0d7917e1e15"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:346"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded"><span class="id" title="inductive">expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:345"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#9fc8caaf18e0ccd741d3dd01a221533b"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#a9ed3f62f59098fa7a7be0d7917e1e15"><span class="id" title="variable">Γ</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder"><span class="id" title="definition">reorder</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:345"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:346"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1 <span class="id" title="keyword">using</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_ind"><span class="id" title="lemma">expanded_ind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span>[<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">solve_all</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_mkApps"><span class="id" title="lemma">optimize_mkApps</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_tRel_app"><span class="id" title="constructor">expanded_tRel_app</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="var">len</span>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">f3</span> ⇒ //.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_branches"><span class="id" title="definition">reorder_branches</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> ⇒ //; <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#All_reorder_list"><span class="id" title="lemma">All_reorder_list</span></a>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_tFix"><span class="id" title="constructor">expanded_tFix</span></a>. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#isLambda_optimize"><span class="id" title="lemma">isLambda_optimize</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#rev_map_spec"><span class="id" title="lemma">rev_map_spec</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a> /= -<a class="idref" href="MetaRocq.Utils.MRList.html#rev_map_spec"><span class="id" title="lemma">rev_map_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">solve_all</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">args</span> ⇒ //. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#nth_error_map"><span class="id" title="lemma">nth_error_map</span></a> /= <span class="id" title="var">H4</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#declared_constructor_lookup"><span class="id" title="lemma">declared_constructor_lookup</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hl</span> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_constructor_reorder"><span class="id" title="lemma">lookup_constructor_reorder</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">wfm</span> <span class="id" title="var">ind</span> <span class="id" title="var">idx</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> /= <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_tConstruct_app"><span class="id" title="constructor">expanded_tConstruct_app</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_declared_constructor"><span class="id" title="lemma">lookup_declared_constructor</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">len</span>. <span class="id" title="var">now</span> <span class="id" title="var">solve_all</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_expanded_decl_fix" class="idref" href="#optimize_expanded_decl_fix"><span class="id" title="lemma">optimize_expanded_decl_fix</span></a> {<a id="2e28355fdde7e660f99f61018835591a" class="idref" href="#2e28355fdde7e660f99f61018835591a"><span class="id" title="binder">Σ</span></a> <a id="m:348" class="idref" href="#m:348"><span class="id" title="binder">m</span></a> <a id="kn:349" class="idref" href="#kn:349"><span class="id" title="binder">kn</span></a> <a id="t:350" class="idref" href="#t:350"><span class="id" title="binder">t</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#2e28355fdde7e660f99f61018835591a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:348"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_decl"><span class="id" title="definition">expanded_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#2e28355fdde7e660f99f61018835591a"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:350"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_decl"><span class="id" title="definition">expanded_decl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:348"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#2e28355fdde7e660f99f61018835591a"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_decl"><span class="id" title="definition">reorder_decl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:348"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#kn:349"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#t:350"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">).2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [[[]]|] ⇒ /= //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_constant_decl"><span class="id" title="definition">expanded_constant_decl</span></a> ⇒ /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded_fix"><span class="id" title="lemma">optimize_expanded_fix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="reorder_env_expanded_fix" class="idref" href="#reorder_env_expanded_fix"><span class="id" title="lemma">reorder_env_expanded_fix</span></a> {<a id="efl:351" class="idref" href="#efl:351"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="f60693929e42d81170fc71b740e558ec" class="idref" href="#f60693929e42d81170fc71b740e558ec"><span class="id" title="binder">Σ</span></a> <a id="m:353" class="idref" href="#m:353"><span class="id" title="binder">m</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f60693929e42d81170fc71b740e558ec"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:353"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f60693929e42d81170fc71b740e558ec"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f60693929e42d81170fc71b740e558ec"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:353"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#f60693929e42d81170fc71b740e558ec"><span class="id" title="variable">Σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a>; <span class="id" title="tactic">move</span>⇒ <span class="id" title="var">wfg</span> <span class="id" title="var">exp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">exp</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHexp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHexp</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">wfg</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded_decl_fix"><span class="id" title="lemma">optimize_expanded_decl_fix</span></a>). <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">decl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_extends_env" class="idref" href="#optimize_extends_env"><span class="id" title="lemma">optimize_extends_env</span></a> {<a id="efl:354" class="idref" href="#efl:354"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="08f84ee8c824a939a63bef56fb20bdd1" class="idref" href="#08f84ee8c824a939a63bef56fb20bdd1"><span class="id" title="binder">Σ</span></a> <a id="fa8f182bbda0521e02f921dc7f82192b" class="idref" href="#fa8f182bbda0521e02f921dc7f82192b"><span class="id" title="binder">Σ'</span></a>} <a id="m:357" class="idref" href="#m:357"><span class="id" title="binder">m</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fa8f182bbda0521e02f921dc7f82192b"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:357"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#08f84ee8c824a939a63bef56fb20bdd1"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fa8f182bbda0521e02f921dc7f82192b"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#08f84ee8c824a939a63bef56fb20bdd1"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fa8f182bbda0521e02f921dc7f82192b"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:357"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#08f84ee8c824a939a63bef56fb20bdd1"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:357"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#fa8f182bbda0521e02f921dc7f82192b"><span class="id" title="variable">Σ'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hast</span> <span class="id" title="var">ext</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">wf'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">extends</span></a> ⇒ <span class="id" title="var">kn</span> <span class="id" title="var">decl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_env_reorder"><span class="id" title="lemma">lookup_env_reorder</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">ext</span> <span class="id" title="var">kn</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env"><span class="id" title="definition">lookup_env</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">hle</span> ⇒ //. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">ext</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ext</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="reorder_env_wf" class="idref" href="#reorder_env_wf"><span class="id" title="lemma">reorder_env_wf</span></a> {<a id="efl:358" class="idref" href="#efl:358"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="09c42d1bf2e162a8a120de445883fafa" class="idref" href="#09c42d1bf2e162a8a120de445883fafa"><span class="id" title="binder">Σ</span></a> <a id="m:360" class="idref" href="#m:360"><span class="id" title="binder">m</span></a>}<br/>
&nbsp;&nbsp;{<a id="wcb:361" class="idref" href="#wcb:361"><span class="id" title="binder">wcb</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#09c42d1bf2e162a8a120de445883fafa"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:360"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#09c42d1bf2e162a8a120de445883fafa"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env"><span class="id" title="definition">reorder_env</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:360"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#09c42d1bf2e162a8a120de445883fafa"><span class="id" title="variable">Σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfg</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">wfΣ</span>; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">wfdΣ</span> : (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">wf_glob</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">kn</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">Σ</span>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">wfd</span> <span class="id" title="var">wfinv</span>] := (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductive_mapping_inv"><span class="id" title="lemma">wf_inductive_mapping_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">wfdΣ</span> <span class="id" title="var">wfg</span>). <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">wfd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_global_decl"><span class="id" title="definition">wf_global_decl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> <span class="id" title="var">c</span>) ⇒ //=. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_optimize"><span class="id" title="lemma">wf_optimize</span></a>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_minductive"><span class="id" title="definition">wf_minductive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_minductive"><span class="id" title="definition">wf_minductive</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>: <span class="id" title="var">H</span> ⇒ [] → <span class="id" title="var">H</span> /=. <span class="id" title="var">solve_all</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">hfa</span> := (<a class="idref" href="MetaRocq.Utils.All_Forall.html#forall_nth_error_Alli"><span class="id" title="lemma">forall_nth_error_Alli</span></a> (<span class="id" title="keyword">fun</span> <a id="i:362" class="idref" href="#i:362"><span class="id" title="binder">i</span></a> <a id="oib:363" class="idref" href="#oib:363"><span class="id" title="binder">oib</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#is_true"><span class="id" title="definition">is_true</span></a> (<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="var">m</span> {| <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_mind"><span class="id" title="projection">inductive_mind</span></a> := <span class="id" title="var">kn</span>; <a class="idref" href="MetaRocq.Common.Kernames.html#inductive_ind"><span class="id" title="projection">inductive_ind</span></a> := <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#i:362"><span class="id" title="variable">i</span></a> |} <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">p</span> ⇒ <span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <a id="tags:364" class="idref" href="#tags:364"><span class="id" title="binder">tags</span></a>) := <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#tags:364"><span class="id" title="variable">tags</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">#|</span></a><a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#oib:363"><span class="id" title="variable">oib</span></a><a class="idref" href="MetaRocq.Utils.MRList.html#50abc9bd1bb81dce67ffb7e42f8ed4c9"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>)) 0 (<a class="idref" href="MetaRocq.Erasure.EAst.html#ind_bodies"><span class="id" title="projection">ind_bodies</span></a> <span class="id" title="var">m0</span>) <span class="id" title="var">wfd</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">wfd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#Alli_All_mix"><span class="id" title="lemma">Alli_All_mix</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hfa</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Utils.All_Forall.html#Alli_All"><span class="id" title="lemma">Alli_All</span></a> (<span class="id" title="var">P</span>:=<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="x:365" class="idref" href="#x:365"><span class="id" title="binder"><span id="x:366" class="id">x</span></span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_inductive"><span class="id" title="definition">wf_inductive</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#x:365"><span class="id" title="variable">x</span></a>) (<span class="id" title="var">n</span>:=0)); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="MetaRocq.Utils.All_Forall.html#Alli_mapi"><span class="id" title="lemma">Alli_mapi</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#Alli_impl"><span class="id" title="lemma">Alli_impl</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> [<span class="id" title="var">hla</span> <span class="id" title="keyword">wf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_one_ind"><span class="id" title="definition">reorder_one_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#lookup_inductive_assoc"><span class="id" title="definition">lookup_inductive_assoc</span></a> <span class="id" title="keyword">as</span> [[<span class="id" title="var">na</span> <span class="id" title="var">tags</span>]|] <span class="id" title="var">eqn</span>:<span class="id" title="var">hla'</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="keyword">wf</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_inductive"><span class="id" title="definition">wf_inductive</span></a> /<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_projections"><span class="id" title="definition">wf_projections</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_projs"><span class="id" title="projection">ind_projs</span></a> ⇒ //. <span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#ind_ctors"><span class="id" title="projection">ind_ctors</span></a> ⇒ //. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l0</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">hla</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags_list"><span class="id" title="definition">wf_tags_list</span></a>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tags</span> ⇒ //=. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_tags"><span class="id" title="definition">wf_tags</span></a>. <span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>⇒ [] <span class="id" title="var">hf</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hf</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">andb_true_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hf</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">Nat.leb_le</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> → : <span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#fresh_global_In"><span class="id" title="lemma">ErasureFunction.fresh_global_In</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a> /=. <span class="id" title="tactic">intros</span> <span class="id" title="var">hin'</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#fresh_global_In"><span class="id" title="lemma">ErasureFunction.fresh_global_In</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EProgram.html#"><span class="id" title="library">EProgram</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="reorder_program_wf" class="idref" href="#reorder_program_wf"><span class="id" title="definition">reorder_program_wf</span></a> {<a id="efl:367" class="idref" href="#efl:367"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} {<a id="wca:368" class="idref" href="#wca:368"><span class="id" title="binder">wca</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#cstr_as_blocks"><span class="id" title="method">cstr_as_blocks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>} (<a id="p:369" class="idref" href="#p:369"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a>) <a id="m:370" class="idref" href="#m:370"><span class="id" title="binder">m</span></a> (<a id="wfm:371" class="idref" href="#wfm:371"><span class="id" title="binder">wfm</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:369"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:370"><span class="id" title="variable">m</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#efl:367"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:369"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#efl:367"><span class="id" title="variable">efl</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program"><span class="id" title="definition">reorder_program</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:370"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:369"><span class="id" title="variable">p</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env_wf"><span class="id" title="lemma">reorder_env_wf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (@<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_optimize"><span class="id" title="lemma">wf_optimize</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">wfm</span> <span class="id" title="var">efl</span> <span class="id" title="var">wca</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="reorder_program_expanded" class="idref" href="#reorder_program_expanded"><span class="id" title="definition">reorder_program_expanded</span></a> {<a id="efl:372" class="idref" href="#efl:372"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="p:373" class="idref" href="#p:373"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a>) <a id="m:374" class="idref" href="#m:374"><span class="id" title="binder">m</span></a> (<a id="wfm:375" class="idref" href="#wfm:375"><span class="id" title="binder">wfm</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:373"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:374"><span class="id" title="variable">m</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#efl:372"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:373"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">expanded_eprogram_cstrs</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:373"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_cstrs"><span class="id" title="definition">expanded_eprogram_cstrs</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program"><span class="id" title="definition">reorder_program</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:374"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:373"><span class="id" title="variable">p</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_eprogram_env_cstrs"><span class="id" title="definition">expanded_eprogram_env_cstrs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ [<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] /<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[] <span class="id" title="var">etae</span> <span class="id" title="var">etat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_global_env_isEtaExp_env"><span class="id" title="lemma">EEtaExpanded.expanded_global_env_isEtaExp_env</span></a>, <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env_expanded"><span class="id" title="lemma">reorder_env_expanded</span></a> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#isEtaExp_env_expanded_global_env"><span class="id" title="lemma">isEtaExp_env_expanded_global_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#expanded_isEtaExp"><span class="id" title="lemma">EEtaExpanded.expanded_isEtaExp</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded"><span class="id" title="lemma">optimize_expanded</span></a>, <a class="idref" href="MetaRocq.Erasure.EEtaExpanded.html#isEtaExp_expanded"><span class="id" title="lemma">EEtaExpanded.isEtaExp_expanded</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="reorder_program_expanded_fix" class="idref" href="#reorder_program_expanded_fix"><span class="id" title="definition">reorder_program_expanded_fix</span></a> {<a id="efl:376" class="idref" href="#efl:376"><span class="id" title="binder">efl</span></a> : <a class="idref" href="MetaRocq.Erasure.EWellformed.html#EEnvFlags"><span class="id" title="class">EEnvFlags</span></a>} (<a id="p:377" class="idref" href="#p:377"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Erasure.EProgram.html#eprogram"><span class="id" title="definition">eprogram</span></a>) <a id="m:378" class="idref" href="#m:378"><span class="id" title="binder">m</span></a> (<a id="wfm:379" class="idref" href="#wfm:379"><span class="id" title="binder">wfm</span></a> : <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#wf_inductives_mapping"><span class="id" title="definition">wf_inductives_mapping</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:377"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:378"><span class="id" title="variable">m</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EProgram.html#wf_eprogram"><span class="id" title="definition">wf_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#efl:376"><span class="id" title="variable">efl</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:377"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">expanded_eprogram</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:377"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">expanded_eprogram</span></a> (<a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_program"><span class="id" title="definition">reorder_program</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#m:378"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#p:377"><span class="id" title="variable">p</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_eprogram"><span class="id" title="definition">expanded_eprogram</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ [<span class="id" title="var">wfe</span> <span class="id" title="var">wft</span>] [] <span class="id" title="var">etae</span> <span class="id" title="var">etat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#reorder_env_expanded_fix"><span class="id" title="lemma">reorder_env_expanded_fix</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EReorderCstrs.html#optimize_expanded_fix"><span class="id" title="lemma">optimize_expanded_fix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
