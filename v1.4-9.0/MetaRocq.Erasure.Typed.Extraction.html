<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.Erasure.Typed.Extraction</h1>

<div class="code">
</div>

<div class="doc">
This file provides the main function for invoking our extraction. 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">String</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#"><span class="id" title="library">Erasure</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#"><span class="id" title="library">Optimize</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#"><span class="id" title="library">OptimizePropDiscr</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#"><span class="id" title="library">Transform</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Utils.html#"><span class="id" title="library">Utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Certifying.html#"><span class="id" title="library">Certifying</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.Kernames.html#"><span class="id" title="library">Kernames</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.config.html#"><span class="id" title="library">config</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Template</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Template.TemplateMonad.html#"><span class="id" title="library">TemplateMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="library">PCUICAst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#"><span class="id" title="library">PCUICTyping</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.TemplatePCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#"><span class="id" title="library">TemplateToPCUIC</span></a>.<br/>

<br/>
#[<span class="id" title="var">export</span>]<br/>
<span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">extraction_checker_flags</span></a>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="PEnv" class="idref" href="#PEnv"><span class="id" title="module">PEnv</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#P.PCUICEnvironment"><span class="id" title="module">P.PCUICEnvironment</span></a>.<br/>

<br/>
</div>

<div class="doc">
We consider a type to be empty, if it is not mutual and has no constructors 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="is_empty_type_decl" class="idref" href="#is_empty_type_decl"><span class="id" title="definition">is_empty_type_decl</span></a> (<a id="d:1" class="idref" href="#d:1"><span class="id" title="binder">d</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_decl"><span class="id" title="inductive">ExAst.global_decl</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#d:1"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ConstantDecl"><span class="id" title="constructor">ExAst.ConstantDecl</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#InductiveDecl"><span class="id" title="constructor">ExAst.InductiveDecl</span></a> <span class="id" title="var">mib</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mib</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_bodies"><span class="id" title="projection">ExAst.ind_bodies</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">oib</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">oib</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_ctors"><span class="id" title="projection">ExAst.ind_ctors</span></a>) <span class="id" title="keyword">with</span> <span class="id" title="notation">[]</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> | <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> </div>

<div class="doc">
NOTE: this should not happen, the list of bodies should not be empty for a well-formed inductive 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#TypeAliasDecl"><span class="id" title="constructor">ExAst.TypeAliasDecl</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="extract_pcuic_params" class="idref" href="#extract_pcuic_params"><span class="id" title="record">extract_pcuic_params</span></a> :=<br/>
&nbsp;&nbsp;{ </div>

<div class="doc">
Whether to remove discrimination (matches and projections) on things in Prop.
        Necessary to run the transforms. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<a id="optimize_prop_discr" class="idref" href="#optimize_prop_discr"><span class="id" title="projection">optimize_prop_discr</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
The transforms to apply after extraction. Only run when optimize_prop_discr is true. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<a id="extract_transforms" class="idref" href="#extract_transforms"><span class="id" title="projection">extract_transforms</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#ExtractTransform"><span class="id" title="definition">ExtractTransform</span></a>; }.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fresh_global_erase_global_decl_rec" class="idref" href="#fresh_global_erase_global_decl_rec"><span class="id" title="lemma">fresh_global_erase_global_decl_rec</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X_type:6" class="idref" href="#X_type:6"><span class="id" title="binder">X_type</span></a> <a id="X:7" class="idref" href="#X:7"><span class="id" title="binder">X</span></a> (<a id="7b3991a5493f1f7b4108f95c16260fdc" class="idref" href="#7b3991a5493f1f7b4108f95c16260fdc"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_declarations"><span class="id" title="definition">global_declarations</span></a>) (<a id="universes0:9" class="idref" href="#universes0:9"><span class="id" title="binder">universes0</span></a> : <a class="idref" href="MetaRocq.Common.Universes.html#ContextSet.t"><span class="id" title="definition">ContextSet.t</span></a>) (<a id="retroknowledge0:10" class="idref" href="#retroknowledge0:10"><span class="id" title="binder">retroknowledge0</span></a> : <a class="idref" href="MetaRocq.Common.Environment.html#Retroknowledge.t"><span class="id" title="record">Retroknowledge.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="f7e662676d3eec1b58c4558e9c39c06c" class="idref" href="#f7e662676d3eec1b58c4558e9c39c06c"><span class="id" title="binder">wfΣ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="seeds:12" class="idref" href="#seeds:12"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>) (<a id="ignore:13" class="idref" href="#ignore:13"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="kn:14" class="idref" href="#kn:14"><span class="id" title="binder">kn</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_global"><span class="id" title="definition">EnvMap.EnvMap.fresh_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#kn:14"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#7b3991a5493f1f7b4108f95c16260fdc"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_global"><span class="id" title="definition">ExAst.fresh_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#kn:14"><span class="id" title="variable">kn</span></a> (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#X_type:6"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#X:7"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#7b3991a5493f1f7b4108f95c16260fdc"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#universes0:9"><span class="id" title="variable">universes0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#retroknowledge0:10"><span class="id" title="variable">retroknowledge0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#f7e662676d3eec1b58c4558e9c39c06c"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:12"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:13"><span class="id" title="variable">ignore</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ0</span> <span class="id" title="var">universes0</span> <span class="id" title="var">retroknowledge0</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignore</span> <span class="id" title="var">kn</span> <span class="id" title="tactic">fresh</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ0</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="tactic">fresh</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="tactic">fresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hmem</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">constructor</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHΣ0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHΣ0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fresh_globals_erase_global_decl_rec" class="idref" href="#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X_type:15" class="idref" href="#X_type:15"><span class="id" title="binder">X_type</span></a> <a id="X:16" class="idref" href="#X:16"><span class="id" title="binder">X</span></a> (<a id="17f79c9b403698cdd47860561138788d" class="idref" href="#17f79c9b403698cdd47860561138788d"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_declarations"><span class="id" title="definition">global_declarations</span></a>) (<a id="universes0:18" class="idref" href="#universes0:18"><span class="id" title="binder">universes0</span></a> : <a class="idref" href="MetaRocq.Common.Universes.html#ContextSet.t"><span class="id" title="definition">ContextSet.t</span></a>) (<a id="retroknowledge0:19" class="idref" href="#retroknowledge0:19"><span class="id" title="binder">retroknowledge0</span></a> : <a class="idref" href="MetaRocq.Common.Environment.html#Retroknowledge.t"><span class="id" title="record">Retroknowledge.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="1a98d2bdd6c43f34596f07e9c59e4026" class="idref" href="#1a98d2bdd6c43f34596f07e9c59e4026"><span class="id" title="binder">wfΣ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="seeds:21" class="idref" href="#seeds:21"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>) (<a id="ignore:22" class="idref" href="#ignore:22"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_globals"><span class="id" title="inductive">EnvMap.EnvMap.fresh_globals</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#17f79c9b403698cdd47860561138788d"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_globals"><span class="id" title="inductive">ExAst.fresh_globals</span></a> (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#X_type:15"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#X:16"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#17f79c9b403698cdd47860561138788d"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#universes0:18"><span class="id" title="variable">universes0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#retroknowledge0:19"><span class="id" title="variable">retroknowledge0</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#1a98d2bdd6c43f34596f07e9c59e4026"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:21"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:22"><span class="id" title="variable">ignore</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">Σ0</span> <span class="id" title="var">universes0</span> <span class="id" title="var">retroknowledge0</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignore</span> <span class="id" title="tactic">fresh</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Σ0</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">seeds</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="tactic">fresh</span>;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHΣ0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_global_erase_global_decl_rec"><span class="id" title="lemma">fresh_global_erase_global_decl_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">easy</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="extract_pcuic_env" class="idref" href="#extract_pcuic_env"><span class="id" title="definition">extract_pcuic_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="params:23" class="idref" href="#params:23"><span class="id" title="binder">params</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_pcuic_params"><span class="id" title="record">extract_pcuic_params</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="0ff5eed445d72e1c5ccedcdae1755936" class="idref" href="#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="d57803fc8bec82f3c6d053f67a63ffc7" class="idref" href="#d57803fc8bec82f3c6d053f67a63ffc7"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="seeds:26" class="idref" href="#seeds:26"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ignore:27" class="idref" href="#ignore:27"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="eb789037a8f6adae4a3a57f4d9f80b3c" class="idref" href="#eb789037a8f6adae4a3a57f4d9f80b3c"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Utils.html#timed"><span class="id" title="definition">timed</span></a> "Erasure"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">erase_global_decls_deps_recursive</span></a> (<span class="id" title="var">X_type</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">PCUICWfEnvImpl.optimized_abstract_env_impl</span></a> (<span class="id" title="var">guard</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_guard_impl_instance"><span class="id" title="instance">fake_guard_impl_instance</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">PCUICWfEnvImpl.build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#d57803fc8bec82f3c6d053f67a63ffc7"><span class="id" title="variable">wfΣ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a>) <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:26"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:27"><span class="id" title="variable">ignore</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#optimize_prop_discr"><span class="id" title="projection">optimize_prop_discr</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:23"><span class="id" title="variable">params</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="b45015ea779d7a6908b541de791ac941" class="idref" href="#b45015ea779d7a6908b541de791ac941"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Utils.html#timed"><span class="id" title="definition">timed</span></a> "Removal of prop discrimination" (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_env"><span class="id" title="definition">OptimizePropDiscr.remove_match_on_box_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#eb789037a8f6adae4a3a57f4d9f80b3c"><span class="id" title="variable">Σ</span></a> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#compose_transforms"><span class="id" title="definition">compose_transforms</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_transforms"><span class="id" title="projection">extract_transforms</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:23"><span class="id" title="variable">params</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#b45015ea779d7a6908b541de791ac941"><span class="id" title="variable">Σ</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#eb789037a8f6adae4a3a57f4d9f80b3c"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">PCUICWfEnvImpl.wf_fresh_globals</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="extract_template_env_params" class="idref" href="#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a> :=<br/>
&nbsp;&nbsp;{ </div>

<div class="doc">
The transforms to apply at the template coq level, before translating to
        PCUIC and extracting.
        After performing all the transforms, the pipiline generates proofs that
        the transformed terms are convertible to the originals. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<a id="template_transforms" class="idref" href="#template_transforms"><span class="id" title="projection">template_transforms</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#TemplateTransform"><span class="id" title="definition">TemplateTransform</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Function to use to check wellformedness of the environment 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<a id="check_wf_env_func" class="idref" href="#check_wf_env_func"><span class="id" title="projection">check_wf_env_func</span></a> : <span class="id" title="keyword">∀</span> <a id="1beca3efe5883c5b6c82a78600a11ca9" class="idref" href="#1beca3efe5883c5b6c82a78600a11ca9"><span class="id" title="binder">Σ</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#1beca3efe5883c5b6c82a78600a11ca9"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="pcuic_args" class="idref" href="#pcuic_args"><span class="id" title="projection">pcuic_args</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_pcuic_params"><span class="id" title="record">extract_pcuic_params</span></a> }.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#MRMonadNotation"><span class="id" title="module">MRMonadNotation</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="check_wf_and_extract" class="idref" href="#check_wf_and_extract"><span class="id" title="definition">check_wf_and_extract</span></a> (<a id="params:35" class="idref" href="#params:35"><span class="id" title="binder">params</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="06f02a2e1ae1dbc558fdd78ca814765d" class="idref" href="#06f02a2e1ae1dbc558fdd78ca814765d"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>) (<a id="seeds:37" class="idref" href="#seeds:37"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>) (<a id="ignore:38" class="idref" href="#ignore:38"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) :=<br/>
&nbsp;&nbsp;<a id="33db4af4adbeefb7cbe82e1c614352f1" class="idref" href="#33db4af4adbeefb7cbe82e1c614352f1"><span class="id" title="binder">wfΣ</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#check_wf_env_func"><span class="id" title="projection">check_wf_env_func</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:35"><span class="id" title="variable">params</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#06f02a2e1ae1dbc558fdd78ca814765d"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_pcuic_env"><span class="id" title="definition">extract_pcuic_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#pcuic_args"><span class="id" title="projection">pcuic_args</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:35"><span class="id" title="variable">params</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#06f02a2e1ae1dbc558fdd78ca814765d"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#33db4af4adbeefb7cbe82e1c614352f1"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:37"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:38"><span class="id" title="variable">ignore</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extract_template_env_general" class="idref" href="#extract_template_env_general"><span class="id" title="definition">extract_template_env_general</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="pcuic_trans:40" class="idref" href="#pcuic_trans:40"><span class="id" title="binder">pcuic_trans</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICEnvironment.global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICEnvironment.global_env</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="params:41" class="idref" href="#params:41"><span class="id" title="binder">params</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="9cdd3744fef7e647d555c1b5b5ffd982" class="idref" href="#9cdd3744fef7e647d555c1b5b5ffd982"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="seeds:43" class="idref" href="#seeds:43"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ignore:44" class="idref" href="#ignore:44"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="8bac999218c391434ebfca8da64fb69b" class="idref" href="#8bac999218c391434ebfca8da64fb69b"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#trans_global_env"><span class="id" title="definition">trans_global_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#9cdd3744fef7e647d555c1b5b5ffd982"><span class="id" title="variable">Σ</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a id="f850f5b668e843742fbd7a0a15104996" class="idref" href="#f850f5b668e843742fbd7a0a15104996"><span class="id" title="binder">Σ</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#pcuic_trans:40"><span class="id" title="variable">pcuic_trans</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#trans_env_env"><span class="id" title="projection">PCUICProgram.trans_env_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#8bac999218c391434ebfca8da64fb69b"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#check_wf_and_extract"><span class="id" title="definition">check_wf_and_extract</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:41"><span class="id" title="variable">params</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#f850f5b668e843742fbd7a0a15104996"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:43"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:44"><span class="id" title="variable">ignore</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extract_template_env" class="idref" href="#extract_template_env"><span class="id" title="definition">extract_template_env</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_general"><span class="id" title="definition">extract_template_env_general</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#ret"><span class="id" title="method">ret</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="run_transforms_list" class="idref" href="#run_transforms_list"><span class="id" title="definition">run_transforms_list</span></a> (<a id="0f349382f796b4f2cbdf3887d61145a1" class="idref" href="#0f349382f796b4f2cbdf3887d61145a1"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a>) (<a id="ts:48" class="idref" href="#ts:48"><span class="id" title="binder">ts</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#TemplateTransform"><span class="id" title="definition">TemplateTransform</span></a>) : <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#TemplateMonad"><span class="id" title="inductive">TemplateMonad</span></a> <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a> :=<br/>
&nbsp;&nbsp;<a id="res:49" class="idref" href="#res:49"><span class="id" title="binder">res</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#tmEval"><span class="id" title="constructor">tmEval</span></a> <a class="idref" href="MetaRocq.Template.TemplateMonad.Common.html#lazy"><span class="id" title="constructor">lazy</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Transform.html#compose_transforms"><span class="id" title="definition">compose_transforms</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ts:48"><span class="id" title="variable">ts</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0f349382f796b4f2cbdf3887d61145a1"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#res:49"><span class="id" title="variable">res</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">Σ</span> ⇒ <a class="idref" href="MetaRocq.Utils.monad_utils.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#0f349382f796b4f2cbdf3887d61145a1"><span class="id" title="variable">Σ</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">s</span> ⇒ <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#tmFail"><span class="id" title="constructor">tmFail</span></a> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="run_transforms" class="idref" href="#run_transforms"><span class="id" title="definition">run_transforms</span></a> (<a id="cbbfa2396495d39f80c59fc2f71e0bb6" class="idref" href="#cbbfa2396495d39f80c59fc2f71e0bb6"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a>) (<a id="params:52" class="idref" href="#params:52"><span class="id" title="binder">params</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a>) : <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#TemplateMonad"><span class="id" title="inductive">TemplateMonad</span></a> <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="transforms:53" class="idref" href="#transforms:53"><span class="id" title="binder">transforms</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:52"><span class="id" title="variable">params</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#template_transforms"><span class="id" title="projection">template_transforms</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#run_transforms_list"><span class="id" title="definition">run_transforms_list</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#cbbfa2396495d39f80c59fc2f71e0bb6"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#transforms:53"><span class="id" title="variable">transforms</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extract_template_env_certifying_passes" class="idref" href="#extract_template_env_certifying_passes"><span class="id" title="definition">extract_template_env_certifying_passes</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="pcuic_trans:54" class="idref" href="#pcuic_trans:54"><span class="id" title="binder">pcuic_trans</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICEnvironment.global_env</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICEnvironment.global_env</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="params:55" class="idref" href="#params:55"><span class="id" title="binder">params</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="34c60bfd25671d67d270c0af76783542" class="idref" href="#34c60bfd25671d67d270c0af76783542"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.global_env"><span class="id" title="record">Ast.Env.global_env</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="seeds:57" class="idref" href="#seeds:57"><span class="id" title="binder">seeds</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.t"><span class="id" title="definition">KernameSet.t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="ignore:58" class="idref" href="#ignore:58"><span class="id" title="binder">ignore</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#TemplateMonad"><span class="id" title="inductive">TemplateMonad</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a> :=<br/>
&nbsp;&nbsp;<a id="1f1311b17b16a7294c39b23fb9bcf043" class="idref" href="#1f1311b17b16a7294c39b23fb9bcf043"><span class="id" title="binder">Σtrans</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#run_transforms"><span class="id" title="definition">run_transforms</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#34c60bfd25671d67d270c0af76783542"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:55"><span class="id" title="variable">params</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a id="mpath:60" class="idref" href="#mpath:60"><span class="id" title="binder">mpath</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#tmCurrentModPath"><span class="id" title="constructor">tmCurrentModPath</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a><a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Certifying.html#gen_defs_and_proofs"><span class="id" title="definition">gen_defs_and_proofs</span></a> (<a class="idref" href="MetaRocq.Template.Ast.html#Env.declarations"><span class="id" title="projection">Ast.Env.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#34c60bfd25671d67d270c0af76783542"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Template.Ast.html#Env.declarations"><span class="id" title="projection">Ast.Env.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#1f1311b17b16a7294c39b23fb9bcf043"><span class="id" title="variable">Σtrans</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#mpath:60"><span class="id" title="variable">mpath</span></a> "_cert_pass" <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:57"><span class="id" title="variable">seeds</span></a><a class="idref" href="MetaRocq.Utils.monad_utils.html#3d31a9d36591ef0fb917aef4149126dc"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a id="res:61" class="idref" href="#res:61"><span class="id" title="binder">res</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#tmEval"><span class="id" title="constructor">tmEval</span></a> <a class="idref" href="MetaRocq.Template.TemplateMonad.Common.html#lazy"><span class="id" title="constructor">lazy</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_general"><span class="id" title="definition">extract_template_env_general</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#pcuic_trans:54"><span class="id" title="variable">pcuic_trans</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#params:55"><span class="id" title="variable">params</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#1f1311b17b16a7294c39b23fb9bcf043"><span class="id" title="variable">Σtrans</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#seeds:57"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#ignore:58"><span class="id" title="variable">ignore</span></a>) <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#res:61"><span class="id" title="variable">res</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <span class="id" title="var">env</span> ⇒ <a class="idref" href="MetaRocq.Utils.monad_utils.html#ret"><span class="id" title="method">ret</span></a> <span class="id" title="var">env</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Err"><span class="id" title="constructor">Err</span></a> <span class="id" title="var">e</span> ⇒ <a class="idref" href="MetaRocq.Template.TemplateMonad.Core.html#tmFail"><span class="id" title="constructor">tmFail</span></a> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
MetaRocq's safe checker does not run from within Rocq, only when extracting.
    To work around this we assume environments are well formed when extracting
    from within Rocq. This is justified since our environments are produced by quoting
    and thus come directly from Rocq, where they have already been type checked. 
</div>
<div class="code">
<span class="id" title="keyword">Axiom</span> <a id="assume_env_wellformed" class="idref" href="#assume_env_wellformed"><span class="id" title="axiom">assume_env_wellformed</span></a> : <span class="id" title="keyword">∀</span> <a id="45eeb0a1cf4691796472cadbc1cb66fd" class="idref" href="#45eeb0a1cf4691796472cadbc1cb66fd"><span class="id" title="binder">Σ</span></a>, <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#45eeb0a1cf4691796472cadbc1cb66fd"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>.<br/>

<br/>
</div>

<div class="doc">
Extract an environment with some minimal checks. This assumes the environment
    is well-formed (to make it computable from within Rocq) but furthermore checks that the
    erased context is closed, expanded and that the masks are valid before dearging.
    Suitable for extraction of programs **from within Rocq**. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="extract_within_coq" class="idref" href="#extract_within_coq"><span class="id" title="definition">extract_within_coq</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env_params"><span class="id" title="record">extract_template_env_params</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#template_transforms"><span class="id" title="projection">template_transforms</span></a> := <span class="id" title="notation">[]</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#check_wf_env_func"><span class="id" title="projection">check_wf_env_func</span></a> <a id="2c4bc88cf29784b11cf0422588c29192" class="idref" href="#2c4bc88cf29784b11cf0422588c29192"><span class="id" title="binder">Σ</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#assume_env_wellformed"><span class="id" title="axiom">assume_env_wellformed</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#2c4bc88cf29784b11cf0422588c29192"><span class="id" title="variable">Σ</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#pcuic_args"><span class="id" title="projection">pcuic_args</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#optimize_prop_discr"><span class="id" title="projection">optimize_prop_discr</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_transforms"><span class="id" title="projection">extract_transforms</span></a> := <span class="id" title="notation">[</span><a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><span class="id" title="notation">]</span> |} |}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="extract_template_env_within_coq" class="idref" href="#extract_template_env_within_coq"><span class="id" title="definition">extract_template_env_within_coq</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_template_env"><span class="id" title="definition">extract_template_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_within_coq"><span class="id" title="definition">extract_within_coq</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#get_projections"><span class="id" title="definition">get_projections</span></a></span> returns a list of constructor names and the name of the inductive associated 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="get_projections" class="idref" href="#get_projections"><span class="id" title="definition">get_projections</span></a> (<a id="env:67" class="idref" href="#env:67"><span class="id" title="binder">env</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#ident"><span class="id" title="definition">ident</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#one_inductive_body"><span class="id" title="record">ExAst.one_inductive_body</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="get_projs:75" class="idref" href="#get_projs:75"><span class="id" title="binder">get_projs</span></a> (<a id="d:68" class="idref" href="#d:68"><span class="id" title="binder"><span id="d:74" class="id">d</span></span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_decl"><span class="id" title="inductive">ExAst.global_decl</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#ident"><span class="id" title="definition">ident</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#one_inductive_body"><span class="id" title="record">ExAst.one_inductive_body</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#d:68"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#InductiveDecl"><span class="id" title="constructor">ExAst.InductiveDecl</span></a> <span class="id" title="var">mind</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;assume&nbsp;no&nbsp;mutually&nbsp;inductive&nbsp;definitions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mind</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_bodies"><span class="id" title="projection">ExAst.ind_bodies</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;pair&nbsp;every&nbsp;constructor&nbsp;with&nbsp;the&nbsp;inductive's&nbsp;name&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><span class="id" title="var">oib</span><span class="id" title="notation">]</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">oib</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_ctors"><span class="id" title="projection">ExAst.ind_ctors</span></a>), <span class="id" title="var">oib</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_projs"><span class="id" title="projection">ExAst.ind_projs</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;1-ind&nbsp;with&nbsp;primitive&nbsp;projections&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><span class="id" title="var">_</span><span class="id" title="notation">]</span>,<span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">(</span></a><a id="na:70" class="idref" href="#na:70"><span class="id" title="binder"><span id="pat:71" class="id">na</span></span></a><a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">,</span></a> <a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">_</span></a><a id="pat:71" class="idref" href="#pat:71"><span class="id" title="binder">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#na:70"><span class="id" title="variable">na</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">oib</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">oib</span>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_projs"><span class="id" title="projection">ExAst.ind_projs</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;case&nbsp;1-ind&nbsp;without&nbsp;primitive&nbsp;projections&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="notation">[</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">ctor_args</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]</span>,<span class="id" title="notation">[]</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;let&nbsp;is_named&nbsp;'(nm,_)&nbsp;:=&nbsp;match&nbsp;nm&nbsp;with&nbsp;nNamed&nbsp;_&nbsp;=&gt;&nbsp;true&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;false&nbsp;end&nbsp;in&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;let&nbsp;named_args&nbsp;:=&nbsp;filter&nbsp;is_named&nbsp;ctor_args&nbsp;in&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> '<a id="pat:73" class="idref" href="#pat:73"><span class="id" title="binder">(</span></a><a id="na:72" class="idref" href="#na:72"><span class="id" title="binder"><span id="pat:73" class="id">na</span></span></a><a id="pat:73" class="idref" href="#pat:73"><span class="id" title="binder">,</span></a> <a id="pat:73" class="idref" href="#pat:73"><span class="id" title="binder">_</span></a><a id="pat:73" class="idref" href="#pat:73"><span class="id" title="binder">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Common.BasicAst.html#string_of_name"><span class="id" title="definition">string_of_name</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#na:72"><span class="id" title="variable">na</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">oib</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="var">ctor_args</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>,<span class="id" title="var">_</span> ⇒ <span class="id" title="notation">[]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="notation">[]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="notation">[]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="definition">List.concat</span> (<span class="id" title="abbreviation">List.map</span> (<span class="id" title="keyword">fun</span> <a id="p:76" class="idref" href="#p:76"><span class="id" title="binder">p</span></a> ⇒ <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#get_projs:75"><span class="id" title="variable">get_projs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#p:76"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#env:67"><span class="id" title="variable">env</span></a>).<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
