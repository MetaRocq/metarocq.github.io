<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.Erasure.Typed.ExtractionCorrectness</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">List</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">ssrbool</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#"><span class="id" title="library">ErasureCorrectness</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#"><span class="id" title="library">ExAst</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#"><span class="id" title="library">Extraction</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#"><span class="id" title="library">Optimize</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#"><span class="id" title="library">OptimizeCorrectness</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#"><span class="id" title="library">OptimizePropDiscr</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#"><span class="id" title="library">ResultMonad</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure.Typed</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#"><span class="id" title="library">WcbvEvalAux</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Equations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#"><span class="id" title="library">ErasureCorrectness</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#"><span class="id" title="library">ErasureFunction</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#"><span class="id" title="library">ErasureFunctionProperties</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#"><span class="id" title="library">EWcbvEval</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Erasure</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.Extract.html#"><span class="id" title="library">Extract</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#"><span class="id" title="library">PCUICAstUtils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICSafeLemmata.html#"><span class="id" title="library">PCUICSafeLemmata</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#"><span class="id" title="library">PCUICTyping</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICInversion.html#"><span class="id" title="library">PCUICInversion</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.Kernames.html#"><span class="id" title="library">Kernames</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="module">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="P" class="idref" href="#P"><span class="id" title="module">P</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="module">PCUICAst</span></a>.<br/>
<span class="id" title="keyword">Module</span> <a id="E" class="idref" href="#E"><span class="id" title="module">E</span></a> := <a class="idref" href="MetaRocq.Erasure.EAst.html#"><span class="id" title="module">EAst</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="0cb9631b9ab072cb900cf2fb3f66f9a2" class="idref" href="#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">&quot;</span></a>Σ 'p⊢' s ⇓ t" := (<a class="idref" href="MetaRocq.PCUIC.PCUICWcbvEval.html#eval"><span class="id" title="inductive">PCUICWcbvEval.eval</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">s</span>, <span class="id" title="var">t</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_squash" class="idref" href="#wf_squash"><span class="id" title="lemma">wf_squash</span></a> {<a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> []. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_env_In" class="idref" href="#lookup_env_In"><span class="id" title="lemma">lookup_env_In</span></a> <a id="d:2" class="idref" href="#d:2"><span class="id" title="binder">d</span></a> <a id="eb9571817dd417966f307c3a9de8fe7f" class="idref" href="#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:2"><span class="id" title="variable">d</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">∀</span> <a id="d':4" class="idref" href="#d':4"><span class="id" title="binder">d'</span></a>, <span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d':4"><span class="id" title="variable">d'</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eb9571817dd417966f307c3a9de8fe7f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:2"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d':4"><span class="id" title="variable">d'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:2"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d':4"><span class="id" title="variable">d'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">univs</span> <span class="id" title="var">decls</span> <span class="id" title="var">retro</span>]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">o</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d</span> |- *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">d'</span> [<span class="id" title="var">H'</span>|<span class="id" title="var">H'</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o0</span> <span class="id" title="keyword">as</span> [<span class="id" title="tactic">fresh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">kn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#fresh_global_iff_not_In"><span class="id" title="lemma">P.fresh_global_iff_not_In</span></a> <span class="id" title="tactic">in</span> <span class="id" title="tactic">fresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">in_map</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">d'</span> [<span class="id" title="var">H'</span>|<span class="id" title="var">H'</span>] <span class="id" title="var">eq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o0</span> <span class="id" title="keyword">as</span> [<span class="id" title="tactic">fresh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#fresh_global_iff_not_In"><span class="id" title="lemma">P.fresh_global_iff_not_In</span></a> <span class="id" title="tactic">in</span> <span class="id" title="tactic">fresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">in_map</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="lookup_global_In_wf" class="idref" href="#lookup_global_In_wf"><span class="id" title="lemma">lookup_global_In_wf</span></a> <a id="d:5" class="idref" href="#d:5"><span class="id" title="binder">d</span></a> <a id="f525610baade8c1419220d275a93fff0" class="idref" href="#f525610baade8c1419220d275a93fff0"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f525610baade8c1419220d275a93fff0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">In</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:5"><span class="id" title="variable">d</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f525610baade8c1419220d275a93fff0"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#P.lookup_global"><span class="id" title="definition">P.lookup_global</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#PEnv.declarations"><span class="id" title="projection">PEnv.declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f525610baade8c1419220d275a93fff0"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:5"><span class="id" title="variable">d</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span> <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">wfΣ</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">kn</span> <span class="id" title="var">decl</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hin</span>. <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">in_map</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hne</span>; <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#P.lookup_global_None"><span class="id" title="lemma">P.lookup_global_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hne</span>. <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="global_erased_with_deps_erases_deps_tConst" class="idref" href="#global_erased_with_deps_erases_deps_tConst"><span class="id" title="lemma">global_erased_with_deps_erases_deps_tConst</span></a> <a id="0f7fdea5e8c25e3e1a79edf27e9de540" class="idref" href="#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="binder">Σ</span></a> <a id="20f5a40dbf26134eddace4754b8af92e" class="idref" href="#20f5a40dbf26134eddace4754b8af92e"><span class="id" title="binder">Σer</span></a> <a id="kn:9" class="idref" href="#kn:9"><span class="id" title="binder">kn</span></a> <a id="cst:10" class="idref" href="#cst:10"><span class="id" title="binder">cst</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declared_constant"><span class="id" title="definition">P.declared_constant</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:9"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#cst:10"><span class="id" title="variable">cst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#global_erased_with_deps"><span class="id" title="definition">global_erased_with_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#20f5a40dbf26134eddace4754b8af92e"><span class="id" title="variable">Σer</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:9"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Extract.html#erases_deps"><span class="id" title="inductive">erases_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0f7fdea5e8c25e3e1a79edf27e9de540"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#20f5a40dbf26134eddace4754b8af92e"><span class="id" title="variable">Σer</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConst"><span class="id" title="constructor">E.tConst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:9"><span class="id" title="variable">kn</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">decl</span> <span class="id" title="var">glob</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">glob</span> <span class="id" title="keyword">as</span> [(?&amp;?&amp;?&amp;?&amp;?&amp;?)|(?&amp;?&amp;?&amp;?&amp;?)].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declared_constant"><span class="id" title="definition">P.declared_constant</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#declared_minductive"><span class="id" title="definition">PCUICAst.declared_minductive</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#lookup_env_In"><span class="id" title="lemma">lookup_env_In</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">decl</span>; <span class="id" title="var">tea</span>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">decl</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="PEnv" class="idref" href="#PEnv"><span class="id" title="module">PEnv</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment"><span class="id" title="module">PCUICAst.PCUICEnvironment</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#"><span class="id" title="module">PCUICWfEnv</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#"><span class="id" title="module">ErasureFunction</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#"><span class="id" title="module">ErasureFunctionProperties</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="extends_trans" class="idref" href="#extends_trans"><span class="id" title="lemma">extends_trans</span></a> <a id="0628ce849eb43988c0c2962e2467d294" class="idref" href="#0628ce849eb43988c0c2962e2467d294"><span class="id" title="binder">Σ</span></a> <a id="d3a6cb19da2224913352325341050262" class="idref" href="#d3a6cb19da2224913352325341050262"><span class="id" title="binder">Σ'</span></a> <a id="09e8f0fd08ef2231cf82de96bee56c8a" class="idref" href="#09e8f0fd08ef2231cf82de96bee56c8a"><span class="id" title="binder">Σ''</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0628ce849eb43988c0c2962e2467d294"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d3a6cb19da2224913352325341050262"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d3a6cb19da2224913352325341050262"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#09e8f0fd08ef2231cf82de96bee56c8a"><span class="id" title="variable">Σ''</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0628ce849eb43988c0c2962e2467d294"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#09e8f0fd08ef2231cf82de96bee56c8a"><span class="id" title="variable">Σ''</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> <span class="id" title="var">kn</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h'</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">e'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;trans_global_decl_erase&nbsp;{X_type&nbsp;X}&nbsp;:<br/>
&nbsp;&nbsp;trans_global_decl&nbsp;(@Erasure.erase_global_decl&nbsp;X_type&nbsp;X&nbsp;Σ&nbsp;prf&nbsp;kn&nbsp;decl&nbsp;ond)&nbsp;=&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="filter_deps_ext" class="idref" href="#filter_deps_ext"><span class="id" title="lemma">filter_deps_ext</span></a> <a id="deps:14" class="idref" href="#deps:14"><span class="id" title="binder">deps</span></a> <a id="deps':15" class="idref" href="#deps':15"><span class="id" title="binder">deps'</span></a> <a id="l:16" class="idref" href="#l:16"><span class="id" title="binder">l</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.Equal"><span class="id" title="definition">KernameSet.Equal</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:14"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':15"><span class="id" title="variable">deps'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#filter_deps"><span class="id" title="definition">filter_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:14"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#l:16"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#filter_deps"><span class="id" title="definition">filter_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':15"><span class="id" title="variable">deps'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#l:16"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|[<span class="id" title="var">kn</span> <span class="id" title="var">d</span>] <span class="id" title="var">decls</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">deps</span>, <span class="id" title="var">deps'</span> |- *; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kne</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">kne</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHdecls</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">kne</span>); <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">kne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps'</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hne</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e'</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="extends_cons_right" class="idref" href="#extends_cons_right"><span class="id" title="lemma">extends_cons_right</span></a> <a id="9e57768f7d1333d5d23f870b726fb0dd" class="idref" href="#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="binder">Σ</span></a> <a id="d4e9fc56244baf5f9222215002cc8566" class="idref" href="#d4e9fc56244baf5f9222215002cc8566"><span class="id" title="binder">Σ'</span></a> <a id="kn:19" class="idref" href="#kn:19"><span class="id" title="binder">kn</span></a> <a id="d:20" class="idref" href="#d:20"><span class="id" title="binder">d</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fresh_global"><span class="id" title="definition">EGlobalEnv.fresh_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:19"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d4e9fc56244baf5f9222215002cc8566"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9e57768f7d1333d5d23f870b726fb0dd"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:19"><span class="id" title="variable">kn</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d:20"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d4e9fc56244baf5f9222215002cc8566"><span class="id" title="variable">Σ'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hf</span> <span class="id" title="var">he</span> <span class="id" title="var">kn'</span> <span class="id" title="var">d'</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Utils.ReflectEq.html#eqb_spec"><span class="id" title="method">eqb_spec</span></a> <span class="id" title="var">kn'</span> <span class="id" title="var">kn</span>). <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#lookup_env_Some_fresh"><span class="id" title="lemma">EGlobalEnv.lookup_env_Some_fresh</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <span class="id" title="var">he</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.EnvMap.html#"><span class="id" title="module">EnvMap</span></a>.<br/>

<br/>
<span class="id" title="keyword">Opaque</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="erase_erasable" class="idref" href="#erase_erasable"><span class="id" title="lemma">erase_erasable</span></a> {<a id="X_type:21" class="idref" href="#X_type:21"><span class="id" title="binder">X_type</span></a> <a id="X:22" class="idref" href="#X:22"><span class="id" title="binder">X</span></a> <a id="nin:23" class="idref" href="#nin:23"><span class="id" title="binder">nin</span></a> <a id="c14c0b2265abf3ec26ac01165fe38870" class="idref" href="#c14c0b2265abf3ec26ac01165fe38870"><span class="id" title="binder">Γ</span></a> <a id="t:25" class="idref" href="#t:25"><span class="id" title="binder">t</span></a> <a id="wt:26" class="idref" href="#wt:26"><span class="id" title="binder">wt</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="2ce23d418d95c371330ae00e4301f160" class="idref" href="#2ce23d418d95c371330ae00e4301f160"><span class="id" title="binder">Σ</span></a>, <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_rel"><span class="id" title="method">abstract_env_ext_rel</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:22"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#2ce23d418d95c371330ae00e4301f160"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#isErasable"><span class="id" title="definition">isErasable</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#2ce23d418d95c371330ae00e4301f160"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c14c0b2265abf3ec26ac01165fe38870"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:25"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:21"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:22"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#nin:23"><span class="id" title="variable">nin</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c14c0b2265abf3ec26ac01165fe38870"><span class="id" title="variable">Γ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:25"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wt:26"><span class="id" title="variable">wt</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.EAst.html#tBox"><span class="id" title="constructor">EAst.tBox</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">his</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_equation_1"><span class="id" title="definition">erase_equation_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#inspect_bool"><span class="id" title="definition">inspect_bool</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>/<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssrbool.html#negP"><span class="id" title="lemma">negP</span></a>: <span class="id" title="var">i</span> ⇒ <span class="id" title="var">hi</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span>/<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#is_erasableP"><span class="id" title="lemma">is_erasableP</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="one_inductive_body_eq" class="idref" href="#one_inductive_body_eq"><span class="id" title="lemma">one_inductive_body_eq</span></a> <a id="x:28" class="idref" href="#x:28"><span class="id" title="binder">x</span></a> <a id="y:29" class="idref" href="#y:29"><span class="id" title="binder">y</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_name"><span class="id" title="projection">E.ind_name</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_name"><span class="id" title="projection">E.ind_name</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_propositional"><span class="id" title="projection">E.ind_propositional</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_propositional"><span class="id" title="projection">E.ind_propositional</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_kelim"><span class="id" title="projection">E.ind_kelim</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_kelim"><span class="id" title="projection">E.ind_kelim</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_ctors"><span class="id" title="projection">E.ind_ctors</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_ctors"><span class="id" title="projection">E.ind_ctors</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_projs"><span class="id" title="projection">E.ind_projs</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_projs"><span class="id" title="projection">E.ind_projs</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:28"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:29"><span class="id" title="variable">y</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">f_equal</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="fresh_global_filter_deps" class="idref" href="#fresh_global_filter_deps"><span class="id" title="lemma">fresh_global_filter_deps</span></a> {<a id="X_type:30" class="idref" href="#X_type:30"><span class="id" title="binder">X_type</span></a> <a id="X:31" class="idref" href="#X:31"><span class="id" title="binder">X</span></a>} {<a id="decls:32" class="idref" href="#decls:32"><span class="id" title="binder">decls</span></a> <a id="nin:33" class="idref" href="#nin:33"><span class="id" title="binder">nin</span></a> <a id="prf:34" class="idref" href="#prf:34"><span class="id" title="binder">prf</span></a>} {<a id="kn:35" class="idref" href="#kn:35"><span class="id" title="binder">kn</span></a> <a id="deps:36" class="idref" href="#deps:36"><span class="id" title="binder">deps</span></a>}:<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_global"><span class="id" title="definition">EnvMap.fresh_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:35"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:32"><span class="id" title="variable">decls</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#fresh_global"><span class="id" title="definition">EGlobalEnv.fresh_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:35"><span class="id" title="variable">kn</span></a> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#filter_deps"><span class="id" title="definition">filter_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:36"><span class="id" title="variable">deps</span></a> (@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_global"><span class="id" title="definition">erase_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:30"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:31"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:32"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#nin:33"><span class="id" title="variable">nin</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf:34"><span class="id" title="variable">prf</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1 <span class="id" title="tactic">in</span> <span class="id" title="var">X_type</span>, <span class="id" title="var">X</span>, <span class="id" title="var">nin</span>, <span class="id" title="var">prf</span>, <span class="id" title="var">deps</span> |- *; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">kn'</span> []]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> |- *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn'</span> <span class="id" title="var">deps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHForall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHForall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>. <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHForall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHForall</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trans_env_erase_global_decls" class="idref" href="#trans_env_erase_global_decls"><span class="id" title="lemma">trans_env_erase_global_decls</span></a> {<a id="X_type:37" class="idref" href="#X_type:37"><span class="id" title="binder">X_type</span></a> <a id="X:38" class="idref" href="#X:38"><span class="id" title="binder">X</span></a>} <a id="decls:39" class="idref" href="#decls:39"><span class="id" title="binder">decls</span></a> <a id="nin:40" class="idref" href="#nin:40"><span class="id" title="binder">nin</span></a> <a id="eq:41" class="idref" href="#eq:41"><span class="id" title="binder">eq</span></a> <a id="univs:42" class="idref" href="#univs:42"><span class="id" title="binder">univs</span></a> <a id="retro:43" class="idref" href="#retro:43"><span class="id" title="binder">retro</span></a> <a id="prf:44" class="idref" href="#prf:44"><span class="id" title="binder">prf</span></a> <a id="deps:45" class="idref" href="#deps:45"><span class="id" title="binder">deps</span></a> <a id="deps':46" class="idref" href="#deps':46"><span class="id" title="binder">deps'</span></a> <a id="ignored:47" class="idref" href="#ignored:47"><span class="id" title="binder">ignored</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:48" class="idref" href="#k:48"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:47"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:48"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.Subset"><span class="id" title="definition">KernameSet.Subset</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:45"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':46"><span class="id" title="variable">deps'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_globals"><span class="id" title="inductive">EnvMap.fresh_globals</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:39"><span class="id" title="variable">decls</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#extends"><span class="id" title="definition">EGlobalEnv.extends</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#filter_deps"><span class="id" title="definition">filter_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:45"><span class="id" title="variable">deps</span></a> (@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_global"><span class="id" title="definition">erase_global</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:37"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:38"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:39"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#nin:40"><span class="id" title="variable">nin</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eq:41"><span class="id" title="variable">eq</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:37"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:38"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:39"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:42"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retro:43"><span class="id" title="variable">retro</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf:44"><span class="id" title="variable">prf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':46"><span class="id" title="variable">deps'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:47"><span class="id" title="variable">ignored</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">decls</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X_type</span>, <span class="id" title="var">X</span>, <span class="id" title="var">deps</span>, <span class="id" title="var">deps'</span>, <span class="id" title="var">ignored</span>, <span class="id" title="var">eq</span>, <span class="id" title="var">nin</span>, <span class="id" title="var">prf</span> |- ×.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">hign</span> <span class="id" title="var">hsub</span> <span class="id" title="var">hf</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>; <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#filter_deps"><span class="id" title="definition">filter_deps</span></a>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">set</span> (<span class="id" title="var">er</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decl"><span class="id" title="definition">Erasure.erase_global_decl</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">set</span> (<span class="id" title="var">er'</span> := <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_constant_decl"><span class="id" title="definition">erase_constant_decl</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">set</span> (<span class="id" title="var">prf'</span> := <span class="id" title="keyword">fun</span> (<a id="bee78f44e79dd1f39e7aa3afe03ef2db" class="idref" href="#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="binder"><span id="cbbfa2396495d39f80c59fc2f71e0bb6" class="id"><span id="2419f67097a80bf54d8cab0e41eb773a" class="id">Σ</span></span></span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICAst.PCUICEnvironment.global_env</span></a>) ⇒ <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">set</span> (<span class="id" title="var">prf''</span> := <span class="id" title="keyword">fun</span> (<a id="4f3c8cf463ede8c1c75dc6e27df02d2d" class="idref" href="#4f3c8cf463ede8c1c75dc6e27df02d2d"><span class="id" title="binder"><span id="20d7c0ecc86fe88fa924e57d0c585b54" class="id"><span id="7674e0ce7f4ec5e4ff169924724c4b41" class="id">Σ</span></span></span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICAst.PCUICEnvironment.global_env</span></a>) ⇒ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps'</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> <span class="id" title="var">er</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ConstantDecl"><span class="id" title="constructor">E.ConstantDecl</span></a> <span class="id" title="var">er'</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">er</span> <span class="id" title="var">er'</span>. <span class="id" title="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ty</span> [] <span class="id" title="var">rel</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl_clause_1"><span class="id" title="definition">Erasure.erase_constant_decl_clause_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>), <span class="id" title="var">conv_ar</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_constant_decl"><span class="id" title="definition">erase_constant_decl</span></a>, <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_constant_body"><span class="id" title="definition">erase_constant_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl_clause_1"><span class="id" title="definition">Erasure.erase_constant_decl_clause_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>), <span class="id" title="var">conv_ar</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#conv_arity_Is_conv_to_Arity"><span class="id" title="lemma">Erasure.conv_arity_Is_conv_to_Arity</span></a> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Σ</span> := {| <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a> := <span class="id" title="var">_</span> |}) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Σ'</span> := {| <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a> := <span class="id" title="var">_</span> ; <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a> := <span class="id" title="var">decls</span> |}) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_erasable"><span class="id" title="lemma">erase_erasable</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">HΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ar</span> [[] <span class="id" title="var">isar</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl</span> := <span class="id" title="keyword">fun</span> (<a id="f1e8fd5f016d0a22b08224b45bb8ae16" class="idref" href="#f1e8fd5f016d0a22b08224b45bb8ae16"><span class="id" title="binder"><span id="34c60bfd25671d67d270c0af76783542" class="id">Σ</span></span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">PCUICAst.PCUICEnvironment.global_env</span></a>) <span class="id" title="var">_</span> ⇒ <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">HΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#abstract_eq_wf"><span class="id" title="lemma">Erasure.abstract_eq_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">prf</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HΣ'</span> [<span class="id" title="keyword">wf</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_exists"><span class="id" title="method">abstract_env_exists</span></a> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls"><span class="id" title="method">abstract_pop_decls</span></a> <span class="id" title="var">X</span>)) <span class="id" title="keyword">as</span> [[<span class="id" title="var">Σpop</span> <span class="id" title="var">hΣpop</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HΣ</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">Σ0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls_correct"><span class="id" title="method">abstract_pop_decls_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hΣpop</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_irr"><span class="id" title="method">abstract_env_irr</span></a> <span class="id" title="var">_</span> <span class="id" title="var">HΣ'</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">Σ0</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hΣpop</span> <span class="id" title="keyword">as</span> [? []]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Σpop</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="keyword">wf</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">o0</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">o1</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">on_global_decl_d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sq</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">ar</span>. <span class="id" title="tactic">split</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">left</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICSR.html#type_reduction"><span class="id" title="lemma">PCUICSR.type_reduction</span></a>. 4:<span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#unlift_TermTyp"><span class="id" title="lemma">unlift_TermTyp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a>]. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_cst"><span class="id" title="definition">trans_cst</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#cst_body"><span class="id" title="projection">cst_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_constant_body"><span class="id" title="definition">erase_constant_body</span></a>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a>]. <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_irrel_global_env"><span class="id" title="lemma">erase_irrel_global_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span>; <span class="id" title="tactic">intros</span> ?? <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_exists"><span class="id" title="method">abstract_env_exists</span></a> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_pop_decls"><span class="id" title="method">abstract_pop_decls</span></a> <span class="id" title="var">X</span>)) <span class="id" title="keyword">as</span> [[[] <span class="id" title="var">hΣpop</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_lookup_correct'"><span class="id" title="lemma">abstract_env_lookup_correct'</span></a>; <span class="id" title="var">tea</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h2</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 (<span class="id" title="var">erewrite</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_primitive_constant_correct"><span class="id" title="method">abstract_primitive_constant_correct</span></a>; <span class="id" title="var">tea</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">h2</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">congruence</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#extends_cons"><span class="id" title="lemma">extends_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHdecls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">IHdecls</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">prf''</span>); <span class="id" title="tactic">eauto</span>. <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hign</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kn'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#constant_decls_deps"><span class="id" title="definition">constant_decls_deps</span></a> <span class="id" title="var">er'</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>) <span class="id" title="keyword">with</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#global_decl_deps"><span class="id" title="definition">global_decl_deps</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ConstantDecl"><span class="id" title="constructor">E.ConstantDecl</span></a> <span class="id" title="var">er'</span><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a>)) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">H2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">er</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">ty</span> []] | |[]]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>; <span class="id" title="var">knset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps'</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hign</span>. <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#extends_cons_right"><span class="id" title="lemma">extends_cons_right</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#fresh_global_filter_deps"><span class="id" title="lemma">fresh_global_filter_deps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">cbn</span> -[<span class="id" title="var">er</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">kn'</span>. <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps'</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem_spec"><span class="id" title="lemma">KernameSet.mem_spec</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a>]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">er</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> <span class="id" title="var">er</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#InductiveDecl"><span class="id" title="constructor">E.InductiveDecl</span></a> (<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_mutual_inductive_body"><span class="id" title="definition">erase_mutual_inductive_body</span></a> <span class="id" title="var">m</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">er</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_mib"><span class="id" title="definition">trans_mib</span></a>, <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_mutual_inductive_body"><span class="id" title="definition">erase_mutual_inductive_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_ind"><span class="id" title="definition">Erasure.erase_ind</span></a>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_In"><span class="id" title="lemma">map_map_In</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#abstract_eq_wf"><span class="id" title="lemma">Erasure.abstract_eq_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">prf</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">h</span> [<span class="id" title="keyword">wf</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_mapIn_eq"><span class="id" title="lemma">map_mapIn_eq</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase_one_inductive_body"><span class="id" title="definition">erase_one_inductive_body</span></a>. <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_ind_body"><span class="id" title="definition">Erasure.erase_ind_body</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#one_inductive_body_eq"><span class="id" title="lemma">one_inductive_body_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1-3:<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_ctors"><span class="id" title="projection">E.ind_ctors</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a>]. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_ctors"><span class="id" title="definition">trans_ctors</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_ind_body"><span class="id" title="definition">Erasure.erase_ind_body</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_ctors"><span class="id" title="projection">ExAst.ind_ctors</span></a>]. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_In"><span class="id" title="lemma">map_map_In</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_mapIn_eq"><span class="id" title="lemma">map_mapIn_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [] <span class="id" title="var">hin'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#decompose_arr"><span class="id" title="definition">decompose_arr</span></a>; <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_In_spec"><span class="id" title="lemma">map_In_spec</span></a> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a> //. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#extends_cons"><span class="id" title="lemma">extends_cons</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kn'</span>; <span class="id" title="var">knset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">kn</span> <span class="id" title="var">deps'</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">e'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hign</span>. <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#extends_cons_right"><span class="id" title="lemma">extends_cons_right</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#fresh_global_filter_deps"><span class="id" title="lemma">fresh_global_filter_deps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">cbn</span> -[<span class="id" title="var">er</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">kn'</span>. <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_trans_inductives" class="idref" href="#wf_trans_inductives"><span class="id" title="lemma">wf_trans_inductives</span></a> (<a id="m:57" class="idref" href="#m:57"><span class="id" title="binder">m</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.mutual_inductive_body"><span class="id" title="record">PCUICAst.PCUICEnvironment.mutual_inductive_body</span></a>) {<a id="X_type:58" class="idref" href="#X_type:58"><span class="id" title="binder">X_type</span></a> <a id="X:59" class="idref" href="#X:59"><span class="id" title="binder">X</span></a> <a id="no:60" class="idref" href="#no:60"><span class="id" title="binder">no</span></a> <a id="nin:61" class="idref" href="#nin:61"><span class="id" title="binder">nin</span></a>} <a id="e4cd9633ec2d0ee09ebe5d497f8dd196" class="idref" href="#e4cd9633ec2d0ee09ebe5d497f8dd196"><span class="id" title="binder">Σ</span></a> <a id="358628cd45b8730c1d0b9c7cb7792529" class="idref" href="#358628cd45b8730c1d0b9c7cb7792529"><span class="id" title="binder">hΣ</span></a> <a id="kn:64" class="idref" href="#kn:64"><span class="id" title="binder">kn</span></a> <a id="prf:65" class="idref" href="#prf:65"><span class="id" title="binder">prf</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">forallb</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_inductive"><span class="id" title="definition">EWellformed.wf_inductive</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_ind"><span class="id" title="definition">Erasure.erase_ind</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:58"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:59"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#no:60"><span class="id" title="variable">no</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#nin:61"><span class="id" title="variable">nin</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#e4cd9633ec2d0ee09ebe5d497f8dd196"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#358628cd45b8730c1d0b9c7cb7792529"><span class="id" title="variable">hΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:64"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#m:57"><span class="id" title="variable">m</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf:65"><span class="id" title="variable">prf</span></a>).(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#ind_bodies"><span class="id" title="projection">ind_bodies</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">prf'</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_ind_obligation_1"><span class="id" title="lemma">Erasure.erase_ind_obligation_1</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="var">clearbody</span> <span class="id" title="var">prf'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.All_Forall.html#forallb_map"><span class="id" title="lemma">forallb_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">fn</span> := <span class="id" title="keyword">fun</span> <a id="oib:66" class="idref" href="#oib:66"><span class="id" title="binder"><span id="oib:67" class="id">oib</span></span></a> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">∀</span> <a id="x:68" class="idref" href="#x:68"><span class="id" title="binder"><span id="x:70" class="id">x</span></span></a> <a id="y:69" class="idref" href="#y:69"><span class="id" title="binder"><span id="y:71" class="id">y</span></span></a>, <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_inductive"><span class="id" title="definition">EWellformed.wf_inductive</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_oib"><span class="id" title="definition">trans_oib</span></a> (<span class="id" title="var">fn</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#x:68"><span class="id" title="variable">x</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#y:69"><span class="id" title="variable">y</span></a>))).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [] <span class="id" title="var">hin</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_ind_body_wellformed"><span class="id" title="lemma">erase_ind_body_wellformed</span></a> <span class="id" title="keyword">no</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">nin</span> <span class="id" title="var">Σ</span> <span class="id" title="var">hΣ</span> <span class="id" title="var">kn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">prf'</span> <span class="id" title="var">_</span> <span class="id" title="var">hin</span>)). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">H</span>. <span class="id" title="var">clearbody</span> <span class="id" title="var">fn</span>. <span class="id" title="tactic">clear</span> -<span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ind_bodies</span>; <span class="id" title="var">cbn</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHind_bodies</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">andb_true_r</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_erase_global_decl" class="idref" href="#wf_erase_global_decl"><span class="id" title="lemma">wf_erase_global_decl</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="H:72" class="idref" href="#H:72"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="X_type:73" class="idref" href="#X_type:73"><span class="id" title="binder">X_type</span></a> <a id="X:74" class="idref" href="#X:74"><span class="id" title="binder">X</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="k:75" class="idref" href="#k:75"><span class="id" title="binder">k</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a>) (<a id="g:76" class="idref" href="#g:76"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">PCUICAst.PCUICEnvironment.global_decl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="decls:77" class="idref" href="#decls:77"><span class="id" title="binder">decls</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">PCUICAst.PCUICEnvironment.global_decl</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="univs:78" class="idref" href="#univs:78"><span class="id" title="binder">univs</span></a> : <a class="idref" href="MetaRocq.Common.Universes.html#ContextSet.t"><span class="id" title="definition">Universes.ContextSet.t</span></a>) <a id="retros:79" class="idref" href="#retros:79"><span class="id" title="binder">retros</span></a> <a id="prf:80" class="idref" href="#prf:80"><span class="id" title="binder">prf</span></a> <a id="w:81" class="idref" href="#w:81"><span class="id" title="binder">w</span></a> <a id="wt:82" class="idref" href="#wt:82"><span class="id" title="binder">wt</span></a> (<a id="e30c9d99823af5649716d4de66218fd1" class="idref" href="#e30c9d99823af5649716d4de66218fd1"><span class="id" title="binder">Σex</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) <a id="prf':84" class="idref" href="#prf':84"><span class="id" title="binder">prf'</span></a> <a id="seeds:85" class="idref" href="#seeds:85"><span class="id" title="binder">seeds</span></a> <a id="ignored:86" class="idref" href="#ignored:86"><span class="id" title="binder">ignored</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="eg:87" class="idref" href="#eg:87"><span class="id" title="binder">eg</span></a> := (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decl"><span class="id" title="definition">Erasure.erase_global_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:73"><span class="id" title="variable">X_type</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:74"><span class="id" title="variable">X</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICLookup.universes_decl_of_decl"><span class="id" title="definition">PCUICAst.PCUICLookup.universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:76"><span class="id" title="variable">g</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf:80"><span class="id" title="variable">prf</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">({|</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:78"><span class="id" title="variable">univs</span></a>; <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:77"><span class="id" title="variable">decls</span></a>; <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retroknowledge"><span class="id" title="projection">PEnv.retroknowledge</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retros:79"><span class="id" title="variable">retros</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|},</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICLookup.universes_decl_of_decl"><span class="id" title="definition">PCUICAst.PCUICLookup.universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:76"><span class="id" title="variable">g</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#w:81"><span class="id" title="variable">w</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:75"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:76"><span class="id" title="variable">g</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wt:82"><span class="id" title="variable">wt</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="kn:88" class="idref" href="#kn:88"><span class="id" title="binder">kn</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:86"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:88"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#e30c9d99823af5649716d4de66218fd1"><span class="id" title="variable">Σex</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> @<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:73"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:74"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:77"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:78"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retros:79"><span class="id" title="variable">retros</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf':84"><span class="id" title="variable">prf'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#decl_deps"><span class="id" title="definition">Erasure.decl_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eg:87"><span class="id" title="variable">eg</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:85"><span class="id" title="variable">seeds</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:86"><span class="id" title="variable">ignored</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#e30c9d99823af5649716d4de66218fd1"><span class="id" title="variable">Σex</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_global_decl"><span class="id" title="definition">EWellformed.wf_global_decl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#e30c9d99823af5649716d4de66218fd1"><span class="id" title="variable">Σex</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eg:87"><span class="id" title="variable">eg</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span> <span class="id" title="var">decls</span> <span class="id" title="var">univs</span> <span class="id" title="var">retros</span> <span class="id" title="var">prf</span> <span class="id" title="var">w</span> <span class="id" title="var">wt</span> <span class="id" title="var">Σex</span> <span class="id" title="var">prf'</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignored</span> <span class="id" title="var">eg</span> <span class="id" title="var">hign</span> <span class="id" title="var">eqex</span> <span class="id" title="var">wf_global</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">eqex</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">eg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decl"><span class="id" title="definition">Erasure.erase_global_decl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hdecl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>,<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl_clause_1"><span class="id" title="definition">Erasure.erase_constant_decl_clause_1</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>), <span class="id" title="var">conv_ar</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hdecl</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hdecl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a>,<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_cst"><span class="id" title="definition">trans_cst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_global_decl"><span class="id" title="definition">EWellformed.wf_global_decl</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MROption.html#option_default"><span class="id" title="definition">MROption.option_default</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">heq</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">deps</span> := <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_constant_body_correct''"><span class="id" title="lemma">erase_constant_body_correct''</span></a> (<span class="id" title="var">X_type</span> := <span class="id" title="var">X_type</span>) (<span class="id" title="var">decls</span> := <span class="id" title="var">decls</span>) <span class="id" title="var">seeds</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">heq</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">t0</span> [<span class="id" title="var">T</span> [[] ?]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">shelve</span>. 4:<span class="id" title="tactic">exact</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">prf'</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> →. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#extends_wellformed"><span class="id" title="lemma">EWellformed.extends_wellformed</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">prf''</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">_</span>). <span class="id" title="var">clearbody</span> <span class="id" title="var">prf''</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">prf''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_deps_erase_global"><span class="id" title="lemma">erase_global_deps_erase_global</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#trans_env_erase_global_decls"><span class="id" title="lemma">trans_env_erase_global_decls</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">deps</span>. <span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#decl_deps"><span class="id" title="definition">Erasure.decl_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#cst_body"><span class="id" title="projection">cst_body</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#cst_type"><span class="id" title="projection">cst_type</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kn'</span>. <span class="id" title="tactic">rewrite</span> !<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union_spec"><span class="id" title="lemma">KernameSet.union_spec</span></a>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_wf"><span class="id" title="method">abstract_env_ext_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="var">w</span>) <span class="id" title="keyword">as</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">PCUICWfEnvImpl.wf_fresh_globals</span></a> <span class="id" title="var">_</span> <span class="id" title="var">X0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> →. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> ⇒ //=.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">he</span> ⇒ /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_trans_inductives"><span class="id" title="lemma">wf_trans_inductives</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#"><span class="id" title="module">EEtaExpandedFix</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="includes_deps_equiv" class="idref" href="#includes_deps_equiv"><span class="id" title="lemma">includes_deps_equiv</span></a> <a id="c51b7ec861f7c17647e5cb8afff8d01c" class="idref" href="#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="binder">Σ</span></a> <a id="bfc10697e38b86eb0cca6c7b077fa47d" class="idref" href="#bfc10697e38b86eb0cca6c7b077fa47d"><span class="id" title="binder">Σ'</span></a> <a id="deps:91" class="idref" href="#deps:91"><span class="id" title="binder">deps</span></a> <a id="deps':92" class="idref" href="#deps':92"><span class="id" title="binder">deps'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.Equal"><span class="id" title="definition">KernameSet.Equal</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:91"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':92"><span class="id" title="variable">deps'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#includes_deps"><span class="id" title="definition">includes_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#bfc10697e38b86eb0cca6c7b077fa47d"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:91"><span class="id" title="variable">deps</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#includes_deps"><span class="id" title="definition">includes_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#bfc10697e38b86eb0cca6c7b077fa47d"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps':92"><span class="id" title="variable">deps'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#includes_deps"><span class="id" title="definition">includes_deps</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">eq</span> <span class="id" title="var">hn</span> <span class="id" title="var">kn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="expanded_erase" class="idref" href="#expanded_erase"><span class="id" title="lemma">expanded_erase</span></a> (<a id="cf:93" class="idref" href="#cf:93"><span class="id" title="binder">cf</span></a> := <a class="idref" href="MetaRocq.Common.config.html#extraction_checker_flags"><span class="id" title="instance">config.extraction_checker_flags</span></a>)<br/>
&nbsp;&nbsp;(<a id="no:94" class="idref" href="#no:94"><span class="id" title="binder">no</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#normalizing_flags"><span class="id" title="class">PCUICSN.normalizing_flags</span></a>)<br/>
&nbsp;&nbsp;{<a id="X_type:95" class="idref" href="#X_type:95"><span class="id" title="binder">X_type</span></a> <a id="X:96" class="idref" href="#X:96"><span class="id" title="binder">X</span></a>} <a id="univs:97" class="idref" href="#univs:97"><span class="id" title="binder">univs</span></a> <a id="68a541049a4e5d8beaf6a87476a33f44" class="idref" href="#68a541049a4e5d8beaf6a87476a33f44"><span class="id" title="binder">wfΣ</span></a> <a id="t:99" class="idref" href="#t:99"><span class="id" title="binder">t</span></a> <a id="wtp:100" class="idref" href="#wtp:100"><span class="id" title="binder">wtp</span></a> <a id="ignored:101" class="idref" href="#ignored:101"><span class="id" title="binder">ignored</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="kn:102" class="idref" href="#kn:102"><span class="id" title="binder">kn</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:101"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:102"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="b0c243fdea575b06d729ab1bfbed1dd2" class="idref" href="#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="binder">Σ</span></a> <a id="prf':104" class="idref" href="#prf':104"><span class="id" title="binder">prf'</span></a>, <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_rel"><span class="id" title="method">abstract_env_rel</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:96"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded"><span class="id" title="inductive">PCUICEtaExpand.expanded</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:99"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="X':105" class="idref" href="#X':105"><span class="id" title="binder">X'</span></a> :=  <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:96"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:97"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#68a541049a4e5d8beaf6a87476a33f44"><span class="id" title="variable">wfΣ</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="normalization_in':107" class="idref" href="#normalization_in':107"><span class="id" title="binder">normalization_in'</span></a> : <span class="id" title="keyword">∀</span> <a id="c15f7ce5d7211986b526059c4461e1ec" class="idref" href="#c15f7ce5d7211986b526059c4461e1ec"><span class="id" title="binder">Σ</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c15f7ce5d7211986b526059c4461e1ec"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c15f7ce5d7211986b526059c4461e1ec"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X':105"><span class="id" title="variable">X'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">PCUICSN.NormalizationIn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c15f7ce5d7211986b526059c4461e1ec"><span class="id" title="variable">Σ</span></a>,<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="et:108" class="idref" href="#et:108"><span class="id" title="binder">et</span></a> := (@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:95"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X':105"><span class="id" title="variable">X'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#normalization_in':107"><span class="id" title="variable">normalization_in'</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:99"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wtp:100"><span class="id" title="variable">wtp</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="deps:109" class="idref" href="#deps:109"><span class="id" title="binder">deps</span></a> := <a class="idref" href="MetaRocq.Erasure.EAstUtils.html#term_global_deps"><span class="id" title="definition">EAstUtils.term_global_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#et:108"><span class="id" title="variable">et</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded"><span class="id" title="inductive">expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:95"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:96"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b0c243fdea575b06d729ab1bfbed1dd2"><span class="id" title="variable">Σ</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retroknowledge"><span class="id" title="projection">PEnv.retroknowledge</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf':104"><span class="id" title="variable">prf'</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:109"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:101"><span class="id" title="variable">ignored</span></a>)) <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#et:108"><span class="id" title="variable">et</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">hign</span> <span class="id" title="var">Σ</span> <span class="id" title="var">heq</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">hexp</span> <span class="id" title="var">X'</span> <span class="id" title="var">normalization_in'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_wf"><span class="id" title="method">abstract_env_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="keyword">wf</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wf'</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_exists"><span class="id" title="method">abstract_env_ext_exists</span></a> <span class="id" title="var">X'</span>) <span class="id" title="keyword">as</span> [[? <span class="id" title="var">wfmake</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_wf"><span class="id" title="method">abstract_env_ext_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="var">wfmake</span>) <span class="id" title="keyword">as</span> [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext_correct"><span class="id" title="definition">abstract_make_wf_env_ext_correct</span></a> <span class="id" title="var">X</span> <span class="id" title="var">univs</span> <span class="id" title="var">wfΣ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">wfmake</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#expanded_erases"><span class="id" title="lemma">expanded_erases</span></a> (<span class="id" title="var">Σ</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">univs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)); <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erases_erase"><span class="id" title="lemma">erases_erase</span></a> (<span class="id" title="var">X</span> := <span class="id" title="var">X'</span>)); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">wtp</span> <span class="id" title="var">_</span> <span class="id" title="var">wfmake</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_erases_deps"><span class="id" title="lemma">erase_global_erases_deps</span></a> (<span class="id" title="var">Σ</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">univs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erases_erase"><span class="id" title="lemma">erases_erase</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_global_decls_deps_recursive_correct_gen"><span class="id" title="lemma">erase_global_decls_deps_recursive_correct_gen</span></a> ⇒ //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#term_global_deps_spec"><span class="id" title="lemma">term_global_deps_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>; <span class="id" title="var">tea</span>. 2:<span class="id" title="tactic">eapply</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span> <span class="id" title="var">hl</span>]]. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erases_erase"><span class="id" title="lemma">erases_erase</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="expanded_erase_global_decl" class="idref" href="#expanded_erase_global_decl"><span class="id" title="lemma">expanded_erase_global_decl</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="H:110" class="idref" href="#H:110"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="X_type:111" class="idref" href="#X_type:111"><span class="id" title="binder">X_type</span></a> <a id="X:112" class="idref" href="#X:112"><span class="id" title="binder">X</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="k:113" class="idref" href="#k:113"><span class="id" title="binder">k</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a>) (<a id="g:114" class="idref" href="#g:114"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">PCUICAst.PCUICEnvironment.global_decl</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="env:115" class="idref" href="#env:115"><span class="id" title="binder">env</span></a> <a id="prf:116" class="idref" href="#prf:116"><span class="id" title="binder">prf</span></a> <a id="w:117" class="idref" href="#w:117"><span class="id" title="binder">w</span></a> <a id="wt:118" class="idref" href="#wt:118"><span class="id" title="binder">wt</span></a> (<a id="9176cf18828029859a538ca4cab2d795" class="idref" href="#9176cf18828029859a538ca4cab2d795"><span class="id" title="binder">Σex</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">global_env</span></a>) <a id="prf':120" class="idref" href="#prf':120"><span class="id" title="binder">prf'</span></a> <a id="seeds:121" class="idref" href="#seeds:121"><span class="id" title="binder">seeds</span></a> <a id="ignored:122" class="idref" href="#ignored:122"><span class="id" title="binder">ignored</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="eg:123" class="idref" href="#eg:123"><span class="id" title="binder">eg</span></a> := (@<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decl"><span class="id" title="definition">Erasure.erase_global_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:111"><span class="id" title="variable">X_type</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:112"><span class="id" title="variable">X</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICLookup.universes_decl_of_decl"><span class="id" title="definition">PCUICAst.PCUICLookup.universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:114"><span class="id" title="variable">g</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf:116"><span class="id" title="variable">prf</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#env:115"><span class="id" title="variable">env</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICLookup.universes_decl_of_decl"><span class="id" title="definition">PCUICAst.PCUICLookup.universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:114"><span class="id" title="variable">g</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#w:117"><span class="id" title="variable">w</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:113"><span class="id" title="variable">k</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:114"><span class="id" title="variable">g</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wt:118"><span class="id" title="variable">wt</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="kn:124" class="idref" href="#kn:124"><span class="id" title="binder">kn</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:122"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:124"><span class="id" title="variable">kn</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9176cf18828029859a538ca4cab2d795"><span class="id" title="variable">Σex</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> @<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:111"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:112"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#env:115"><span class="id" title="variable">env</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#env:115"><span class="id" title="variable">env</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#env:115"><span class="id" title="variable">env</span></a>.(<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retroknowledge"><span class="id" title="projection">PEnv.retroknowledge</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#prf':120"><span class="id" title="variable">prf'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#decl_deps"><span class="id" title="definition">Erasure.decl_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eg:123"><span class="id" title="variable">eg</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:121"><span class="id" title="variable">seeds</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:122"><span class="id" title="variable">ignored</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9176cf18828029859a538ca4cab2d795"><span class="id" title="variable">Σex</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_decl"><span class="id" title="definition">PCUICEtaExpand.expanded_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#env:115"><span class="id" title="variable">env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#g:114"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_decl"><span class="id" title="definition">expanded_decl</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9176cf18828029859a538ca4cab2d795"><span class="id" title="variable">Σex</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#eg:123"><span class="id" title="variable">eg</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span> [<span class="id" title="var">univs</span> <span class="id" title="var">decls</span> <span class="id" title="var">retros</span>] <span class="id" title="var">prf</span> <span class="id" title="var">w</span> <span class="id" title="var">wt</span> <span class="id" title="var">Σex</span> <span class="id" title="var">prf'</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignored</span> <span class="id" title="var">eg</span> <span class="id" title="var">hign</span> <span class="id" title="var">eqex</span> <span class="id" title="var">wf_global</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">eqex</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">eg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Σ</span> := {| <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a> := <span class="id" title="var">_</span> |}) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_exists"><span class="id" title="method">abstract_env_exists</span></a> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">Σ'</span> <span class="id" title="var">hΣ</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">prf'</span> <span class="id" title="var">_</span> <span class="id" title="var">hΣ</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">Σ'</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">prf</span> <span class="id" title="var">_</span> <span class="id" title="var">hΣ</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">wfΣ</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decl"><span class="id" title="definition">Erasure.erase_global_decl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hdecl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl"><span class="id" title="definition">Erasure.erase_constant_decl</span></a>,<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_constant_decl_clause_1"><span class="id" title="definition">Erasure.erase_constant_decl_clause_1</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>), <span class="id" title="var">conv_ar</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hdecl</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hdecl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_global_decl"><span class="id" title="definition">trans_global_decl</span></a>,<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_cst"><span class="id" title="definition">trans_cst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_global_decl"><span class="id" title="definition">EWellformed.wf_global_decl</span></a>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MROption.html#option_default"><span class="id" title="definition">MROption.option_default</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.EAst.html#cst_body"><span class="id" title="projection">EAst.cst_body</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">heq</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">deps</span> := <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ty</span> [<span class="id" title="var">b</span>|] <span class="id" title="var">cunivs</span> <span class="id" title="var">rel</span>]. 2:<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">heq</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">eq</span> []. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">expanded_body</span>. <span class="id" title="tactic">move</span>: <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_constant_body_correct''"><span class="id" title="lemma">erase_constant_body_correct''</span></a> (<span class="id" title="var">X_type</span> := <span class="id" title="var">X_type</span>) (<span class="id" title="var">decls</span> := <span class="id" title="var">decls</span>) <span class="id" title="var">seeds</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">heq</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">t0'</span> [<span class="id" title="var">T</span> [[] ?]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">shelve</span>. 4:<span class="id" title="tactic">exact</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">prf'</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> →. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">eq</span> ?] ?]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>. <span class="id" title="var">noconf</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#expanded_erases"><span class="id" title="lemma">expanded_erases</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wfΣ</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">i</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_erases_deps"><span class="id" title="lemma">erase_global_erases_deps</span></a> (<span class="id" title="var">Σ</span> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">cunivs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)); <span class="id" title="tactic">eauto</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">ert</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_type"><span class="id" title="definition">Erasure.erase_type</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">deps</span>. <span class="id" title="var">clearbody</span> <span class="id" title="var">ert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">deps</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">wf_global</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_global_decls_deps_recursive_correct_gen"><span class="id" title="lemma">erase_global_decls_deps_recursive_correct_gen</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">deps</span>. <span class="id" title="var">knset</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#term_global_deps_spec"><span class="id" title="lemma">term_global_deps_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>; <span class="id" title="var">tea</span>. 2:<span class="id" title="tactic">eapply</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span> <span class="id" title="var">hl</span>]]. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">intros</span> →. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> ⇒ //=. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hdecl</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">he</span> ⇒ //=.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Transparent</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#flag_of_type"><span class="id" title="definition">Erasure.flag_of_type</span></a>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">invert_wf</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="var">sq</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#on_global_decls"><span class="id" title="inductive">P.on_global_decls</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×<br/>
&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#on_global_decls_data"><span class="id" title="record">P.on_global_decls_data</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wf_erase_global_decls_recursive" class="idref" href="#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a> (<a id="H:125" class="idref" href="#H:125"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X_type:126" class="idref" href="#X_type:126"><span class="id" title="binder">X_type</span></a> <a id="X:127" class="idref" href="#X:127"><span class="id" title="binder">X</span></a> <a id="decls:128" class="idref" href="#decls:128"><span class="id" title="binder">decls</span></a> <a id="univs:129" class="idref" href="#univs:129"><span class="id" title="binder">univs</span></a> <a id="retros:130" class="idref" href="#retros:130"><span class="id" title="binder">retros</span></a> <a id="w:131" class="idref" href="#w:131"><span class="id" title="binder">w</span></a> <a id="seeds:132" class="idref" href="#seeds:132"><span class="id" title="binder">seeds</span></a> (<a id="ignored:133" class="idref" href="#ignored:133"><span class="id" title="binder">ignored</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:134" class="idref" href="#k:134"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:133"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:134"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="17ee4b2267b2f14884253775e9beb707" class="idref" href="#17ee4b2267b2f14884253775e9beb707"><span class="id" title="binder">Σex</span></a> := @<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:126"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:127"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:128"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:129"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retros:130"><span class="id" title="variable">retros</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#w:131"><span class="id" title="variable">w</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:132"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:133"><span class="id" title="variable">ignored</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#17ee4b2267b2f14884253775e9beb707"><span class="id" title="variable">Σex</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">univs</span> <span class="id" title="var">retros</span> <span class="id" title="var">w</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignored</span> <span class="id" title="var">hign</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">seeds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">decls</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X_type</span>, <span class="id" title="var">X</span>, <span class="id" title="var">w</span> |- *;<span class="id" title="tactic">intros</span> <span class="id" title="var">seeds</span>;<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#test_snd"><span class="id" title="definition">MRProd.test_snd</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHdecls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">kns</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hign</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqkns</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqkns</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <span class="id" title="var">decls</span> <span class="id" title="var">univs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">Σex</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -/(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decl"><span class="id" title="lemma">wf_erase_global_decl</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HeqΣex</span>. <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Heqkns</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_global"><span class="id" title="lemma">OptimizePropDiscr.trans_env_fresh_global</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">decls</span> <span class="id" title="keyword">with</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#universes"><span class="id" title="projection">PEnv.universes</span></a> := <span class="id" title="var">univs</span>; <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a> := <span class="id" title="var">decls</span>; <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retroknowledge"><span class="id" title="projection">PEnv.retroknowledge</span></a> := <span class="id" title="var">retros</span> |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#abstract_eq_wf"><span class="id" title="lemma">Erasure.abstract_eq_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [? []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">PCUICWfEnvImpl.wf_fresh_globals</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#wf_pop_decl"><span class="id" title="lemma">Erasure.wf_pop_decl</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>; <span class="id" title="var">trea</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_global_erase_global_decl_rec"><span class="id" title="lemma">fresh_global_erase_global_decl_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#abstract_eq_wf"><span class="id" title="lemma">Erasure.abstract_eq_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [? []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">PCUICWfEnvImpl.wf_fresh_globals</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">now</span> <span class="id" title="var">depelim</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHdecls</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="expanded_erase_global_decls_recursive" class="idref" href="#expanded_erase_global_decls_recursive"><span class="id" title="lemma">expanded_erase_global_decls_recursive</span></a> (<a id="H:136" class="idref" href="#H:136"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X_type:137" class="idref" href="#X_type:137"><span class="id" title="binder">X_type</span></a> <a id="X:138" class="idref" href="#X:138"><span class="id" title="binder">X</span></a> <a id="decls:139" class="idref" href="#decls:139"><span class="id" title="binder">decls</span></a> <a id="univs:140" class="idref" href="#univs:140"><span class="id" title="binder">univs</span></a> <a id="retros:141" class="idref" href="#retros:141"><span class="id" title="binder">retros</span></a> <a id="w:142" class="idref" href="#w:142"><span class="id" title="binder">w</span></a> <a id="seeds:143" class="idref" href="#seeds:143"><span class="id" title="binder">seeds</span></a> (<a id="ignored:144" class="idref" href="#ignored:144"><span class="id" title="binder">ignored</span></a> : <a class="idref" href="MetaRocq.Common.Kernames.html#kername"><span class="id" title="definition">kername</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:145" class="idref" href="#k:145"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:144"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:145"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="82e4b0c108d13dac2e782bb6ed8f5c1e" class="idref" href="#82e4b0c108d13dac2e782bb6ed8f5c1e"><span class="id" title="binder">Σex</span></a> := @<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X_type:137"><span class="id" title="variable">X_type</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#X:138"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:139"><span class="id" title="variable">decls</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:140"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retros:141"><span class="id" title="variable">retros</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#w:142"><span class="id" title="variable">w</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:143"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:144"><span class="id" title="variable">ignored</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICEtaExpand.html#expanded_global_declarations"><span class="id" title="inductive">PCUICEtaExpand.expanded_global_declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#univs:140"><span class="id" title="variable">univs</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#retros:141"><span class="id" title="variable">retros</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#decls:139"><span class="id" title="variable">decls</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EEtaExpandedFix.html#expanded_global_env"><span class="id" title="definition">expanded_global_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#82e4b0c108d13dac2e782bb6ed8f5c1e"><span class="id" title="variable">Σex</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">decls</span> <span class="id" title="var">univs</span> <span class="id" title="var">retros</span> <span class="id" title="var">w</span> <span class="id" title="var">seeds</span> <span class="id" title="var">ignored</span> <span class="id" title="var">hign</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">seeds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">decls</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X_type</span>, <span class="id" title="var">X</span>, <span class="id" title="var">w</span> |- *;<span class="id" title="tactic">intros</span> <span class="id" title="var">seeds</span>;<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.mem"><span class="id" title="definition">KernameSet.mem</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Utils.MRProd.html#test_snd"><span class="id" title="definition">MRProd.test_snd</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="tactic">in</span> *;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHdecls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">cbn</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.union"><span class="id" title="definition">KernameSet.union</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">kns</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hign</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqkns</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heqkns</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <span class="id" title="var">decls</span> <span class="id" title="var">univs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#expanded_erase_global_decl"><span class="id" title="lemma">expanded_erase_global_decl</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">erewrite</span> &lt;- <span class="id" title="var">Heqkns</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">HeqΣex</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">Σex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H0</span>; <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHdecls</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="optimize_correct" class="idref" href="#optimize_correct"><span class="id" title="lemma">optimize_correct</span></a> `{<a id="H:147" class="idref" href="#H:147"><span class="id" title="binder">EWellformed.EEnvFlags</span></a>} <a id="6b1879b3537ab71ccb79966068a4600f" class="idref" href="#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="binder">Σ</span></a> <a id="d9384e09307a43df377a855753fedecf" class="idref" href="#d9384e09307a43df377a855753fedecf"><span class="id" title="binder">fgΣ</span></a> <a id="t:150" class="idref" href="#t:150"><span class="id" title="binder">t</span></a> <a id="v:151" class="idref" href="#v:151"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closed"><span class="id" title="abbreviation">ELiftSubst.closed</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:150"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">EGlobalEnv.closed_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">default_wcbv_flags</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:150"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:151"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#disable_prop_cases"><span class="id" title="definition">EWcbvEval.disable_prop_cases</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_decl"><span class="id" title="definition">remove_match_on_box_decl</span></a> (<a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_globals"><span class="id" title="lemma">OptimizePropDiscr.trans_env_fresh_globals</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d9384e09307a43df377a855753fedecf"><span class="id" title="variable">fgΣ</span></a>)))) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> (<a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_globals"><span class="id" title="lemma">OptimizePropDiscr.trans_env_fresh_globals</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d9384e09307a43df377a855753fedecf"><span class="id" title="variable">fgΣ</span></a>)) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:150"><span class="id" title="variable">t</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> (<a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6b1879b3537ab71ccb79966068a4600f"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_globals"><span class="id" title="lemma">OptimizePropDiscr.trans_env_fresh_globals</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d9384e09307a43df377a855753fedecf"><span class="id" title="variable">fgΣ</span></a>)) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:151"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cl_t</span> <span class="id" title="var">cl_env</span> <span class="id" title="var">wfg</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Σ0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_decl"><span class="id" title="definition">remove_match_on_box_decl</span></a> <span class="id" title="var">Σ0</span>)) <span class="id" title="var">Σ</span>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_env"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box_env</span></a> <span class="id" title="var">Σ0</span>) <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">HeqΣ0</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_map_compose"><span class="id" title="lemma">map_map_compose</span></a> /<a class="idref" href="MetaRocq.Utils.MRProd.html#on_snd"><span class="id" title="definition">on_snd</span></a>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Utils.MRList.html#map_ext"><span class="id" title="lemma">map_ext</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[] []]; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [[] []] ⇒ //. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_constant_decl"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box_constant_decl</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>; <span class="id" title="var">cbn</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_correct"><span class="id" title="lemma">EOptimizePropDiscr.remove_match_on_box_correct</span></a> (<span class="id" title="var">fl</span> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">default_wcbv_flags</span></a>) (<span class="id" title="var">Σ</span> := <span class="id" title="var">Σ0</span>));<span class="id" title="tactic">subst</span>;<span class="id" title="var">cbn</span>;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="extract_correct" class="idref" href="#extract_correct"><span class="id" title="lemma">extract_correct</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H:152" class="idref" href="#H:152"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="wfl:153" class="idref" href="#wfl:153"><span class="id" title="binder">wfl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="5854b9c8272a298e61fb008eccdcfef8" class="idref" href="#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#P.global_env_ext"><span class="id" title="definition">P.global_env_ext</span></a>) (<a id="6f52473403a8be9097d813997c44195c" class="idref" href="#6f52473403a8be9097d813997c44195c"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="kn:156" class="idref" href="#kn:156"><span class="id" title="binder">kn</span></a> <a id="ui:157" class="idref" href="#ui:157"><span class="id" title="binder">ui</span></a> <a id="ind:158" class="idref" href="#ind:158"><span class="id" title="binder">ind</span></a> <a id="c:159" class="idref" href="#c:159"><span class="id" title="binder">c</span></a> <a id="ui':160" class="idref" href="#ui':160"><span class="id" title="binder">ui'</span></a> <a id="ignored:161" class="idref" href="#ignored:161"><span class="id" title="binder">ignored</span></a> <a id="f423d2fb97e3c788459d51c0ce66fa4a" class="idref" href="#f423d2fb97e3c788459d51c0ce66fa4a"><span class="id" title="binder">exΣ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Extract.html#axiom_free"><span class="id" title="definition">axiom_free</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#welltyped"><span class="id" title="inductive">welltyped</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConst"><span class="id" title="constructor">P.tConst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:156"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ui:157"><span class="id" title="variable">ui</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">p</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConst"><span class="id" title="constructor">P.tConst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:156"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ui:157"><span class="id" title="variable">ui</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConstruct"><span class="id" title="constructor">P.tConstruct</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind:158"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c:159"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ui':160"><span class="id" title="variable">ui'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#isErasable"><span class="id" title="definition">isErasable</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConstruct"><span class="id" title="constructor">P.tConstruct</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind:158"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c:159"><span class="id" title="variable">c</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ui':160"><span class="id" title="variable">ui'</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:163" class="idref" href="#k:163"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:161"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:163"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_pcuic_env"><span class="id" title="definition">extract_pcuic_env</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#pcuic_args"><span class="id" title="projection">pcuic_args</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#extract_within_coq"><span class="id" title="definition">extract_within_coq</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#5854b9c8272a298e61fb008eccdcfef8"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_squash"><span class="id" title="lemma">wf_squash</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#6f52473403a8be9097d813997c44195c"><span class="id" title="variable">wfΣ</span></a>) (<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.singleton"><span class="id" title="definition">KernameSet.singleton</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:156"><span class="id" title="variable">kn</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:161"><span class="id" title="variable">ignored</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f423d2fb97e3c788459d51c0ce66fa4a"><span class="id" title="variable">exΣ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f423d2fb97e3c788459d51c0ce66fa4a"><span class="id" title="variable">exΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConst"><span class="id" title="constructor">E.tConst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#kn:156"><span class="id" title="variable">kn</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#tConstruct"><span class="id" title="constructor">E.tConstruct</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind:158"><span class="id" title="variable">ind</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c:159"><span class="id" title="variable">c</span></a> <span class="id" title="notation">[]</span><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ax</span> [<span class="id" title="var">T</span> <span class="id" title="var">wt</span>] <span class="id" title="var">ev</span> <span class="id" title="var">not_erasable</span> <span class="id" title="var">no_ignores</span> <span class="id" title="var">ex</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">dt</span>; <span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a>] <span class="id" title="tactic">in</span> *; [|<span class="id" title="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">ex</span> <span class="id" title="keyword">as</span> →.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#erases_correct"><span class="id" title="lemma">erases_correct</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Σ'</span> := <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">PCUICAst.PCUICEnvironment.declarations</span></a> <span class="id" title="var">Σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">PCUICAst.PCUICEnvironment.universes</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.singleton"><span class="id" title="definition">KernameSet.singleton</span></a> <span class="id" title="var">kn</span>) <span class="id" title="var">ignored</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">erv</span>&amp;<span class="id" title="var">erase_to</span>&amp;[<span class="id" title="var">erev</span>]);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">depelim</span> <span class="id" title="var">erase_to</span>;[|<span class="id" title="var">easy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_transform_correct"><span class="id" title="lemma">dearg_transform_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">dt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (@<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#optimize_correct"><span class="id" title="lemma">optimize_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.Erasure.EAst.html#tConst"><span class="id" title="constructor">tConst</span></a> <span class="id" title="var">kn</span>) (<a class="idref" href="MetaRocq.Erasure.EAst.html#tConstruct"><span class="id" title="constructor">tConstruct</span></a> <span class="id" title="var">ind</span> <span class="id" title="var">c</span> <span class="id" title="notation">[]</span>));<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">remember</span> (<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">eΣ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">eΣ</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">eΣ</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">EWellformed.wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICInversion.html#inversion_Const"><span class="id" title="lemma">inversion_Const</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">wt</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">dt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#global_erased_with_deps_erases_deps_tConst"><span class="id" title="lemma">global_erased_with_deps_erases_deps_tConst</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ0</span> <span class="id" title="var">univ_decls</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">univs</span> <span class="id" title="var">Σ1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext_wf"><span class="id" title="lemma">wf_ext_wf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> <span class="id" title="var">w1</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_global_decls_deps_recursive_correct"><span class="id" title="lemma">erase_global_decls_deps_recursive_correct</span></a>;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#declared_constant"><span class="id" title="definition">PCUICAst.declared_constant</span></a> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? -&gt;%<a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.singleton_spec"><span class="id" title="lemma">KernameSet.singleton_spec</span></a>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">env</span> := {| <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#declarations"><span class="id" title="projection">PEnv.declarations</span></a> := <span class="id" title="var">Σ1</span> |}) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#lookup_global_In_wf"><span class="id" title="lemma">lookup_global_In_wf</span></a> <span class="id" title="var">_</span> <span class="id" title="var">env</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">d</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Common.Kernames.html#KernameSet.singleton_spec"><span class="id" title="lemma">KernameSet.singleton_spec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">PCUICWfEnvImpl.wf_fresh_globals</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">String</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#MRMonadNotation"><span class="id" title="module">MRMonadNotation</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="compute_masks" class="idref" href="#compute_masks"><span class="id" title="definition">compute_masks</span></a> <a id="overridden_masks:164" class="idref" href="#overridden_masks:164"><span class="id" title="binder">overridden_masks</span></a> <a id="do_trim_const_masks:165" class="idref" href="#do_trim_const_masks:165"><span class="id" title="binder">do_trim_const_masks</span></a> <a id="do_trim_ctor_masks:166" class="idref" href="#do_trim_ctor_masks:166"><span class="id" title="binder">do_trim_ctor_masks</span></a> <a id="def0ae1d6f53f9edf7fdc46f0ff85f41" class="idref" href="#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#result"><span class="id" title="inductive">result</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_set"><span class="id" title="record">dearg_set</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">bytestring.string</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="const_masks:168" class="idref" href="#const_masks:168"><span class="id" title="binder">const_masks</span></a>, <a id="ind_masks:169" class="idref" href="#ind_masks:169"><span class="id" title="binder">ind_masks</span></a>) := <a class="idref" href="MetaRocq.Erasure.Typed.Utils.html#timed"><span class="id" title="definition">Utils.timed</span></a> "Dearg analysis" (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#analyze_env"><span class="id" title="definition">analyze_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#overridden_masks:164"><span class="id" title="variable">overridden_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="variable">Σ</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="const_masks:170" class="idref" href="#const_masks:170"><span class="id" title="binder">const_masks</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_const_masks:165"><span class="id" title="variable">do_trim_const_masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#trim_const_masks"><span class="id" title="definition">trim_const_masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">const_masks</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="ind_masks:171" class="idref" href="#ind_masks:171"><span class="id" title="binder">ind_masks</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_ctor_masks:166"><span class="id" title="variable">do_trim_ctor_masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#trim_ind_masks"><span class="id" title="definition">trim_ind_masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.ssr.ssreflect.html#::boolean_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">ind_masks</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded_env"><span class="id" title="definition">is_expanded_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_masks:171"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#const_masks:170"><span class="id" title="variable">const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="variable">Σ</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"Erased environment is not expanded enough for dearging to be provably correct"%<span class="id" title="var">bs</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#3d31a9d36591ef0fb917aef4149126dc"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_masks_env"><span class="id" title="definition">valid_masks_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_masks:171"><span class="id" title="variable">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#const_masks:170"><span class="id" title="variable">const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#def0ae1d6f53f9edf7fdc46f0ff85f41"><span class="id" title="variable">Σ</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"Analysis produced masks that ask to remove live arguments"%<span class="id" title="var">bs</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#3d31a9d36591ef0fb917aef4149126dc"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#Build_dearg_set"><span class="id" title="constructor">Build_dearg_set</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#const_masks:170"><span class="id" title="variable">const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ind_masks:171"><span class="id" title="variable">ind_masks</span></a>).<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#"><span class="id" title="module">PCUICWfEnvImpl</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment"><span class="id" title="module">PCUICAst.PCUICEnvironment</span></a>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="make_env" class="idref" href="#make_env"><span class="id" title="definition">make_env</span></a> {<a id="0646a2f53c44ced826a07974c20c1488" class="idref" href="#0646a2f53c44ced826a07974c20c1488"><span class="id" title="binder">Σ</span></a>} (<a id="c5d1316cfc1e557b2b814b13adfac312" class="idref" href="#c5d1316cfc1e557b2b814b13adfac312"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0646a2f53c44ced826a07974c20c1488"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) :=<br/>
&nbsp;&nbsp;@<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <span class="id" title="var">_</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> (<span class="id" title="var">guard</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_guard_impl_instance"><span class="id" title="instance">Erasure.fake_guard_impl_instance</span></a>)) (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">PCUICWfEnvImpl.build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0646a2f53c44ced826a07974c20c1488"><span class="id" title="variable">Σ</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c5d1316cfc1e557b2b814b13adfac312"><span class="id" title="variable">wfΣ</span></a>)) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0646a2f53c44ced826a07974c20c1488"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="erase_env" class="idref" href="#erase_env"><span class="id" title="definition">erase_env</span></a> {<a id="f058463ac94c66c241345aec4af19ada" class="idref" href="#f058463ac94c66c241345aec4af19ada"><span class="id" title="binder">Σ</span></a>} <a id="86134f31138a0ce8b1f8f84460b1d4e0" class="idref" href="#86134f31138a0ce8b1f8f84460b1d4e0"><span class="id" title="binder">wfΣ</span></a> <a id="seeds:176" class="idref" href="#seeds:176"><span class="id" title="binder">seeds</span></a> <a id="ignore:177" class="idref" href="#ignore:177"><span class="id" title="binder">ignore</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#erase_global_decls_deps_recursive"><span class="id" title="definition">Erasure.erase_global_decls_deps_recursive</span></a> (<span class="id" title="var">X_type</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">PCUICWfEnvImpl.optimized_abstract_env_impl</span></a> (<span class="id" title="var">guard</span> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_guard_impl_instance"><span class="id" title="instance">Erasure.fake_guard_impl_instance</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#build_wf_env_from_env"><span class="id" title="definition">PCUICWfEnvImpl.build_wf_env_from_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f058463ac94c66c241345aec4af19ada"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#86134f31138a0ce8b1f8f84460b1d4e0"><span class="id" title="variable">wfΣ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f058463ac94c66c241345aec4af19ada"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f058463ac94c66c241345aec4af19ada"><span class="id" title="variable">Σ</span></a>) (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#f058463ac94c66c241345aec4af19ada"><span class="id" title="variable">Σ</span></a>) <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:176"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignore:177"><span class="id" title="variable">ignore</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="erase_term" class="idref" href="#erase_term"><span class="id" title="definition">erase_term</span></a> {<a id="9578c8ca712ef7a7ad3e8570c0f38f92" class="idref" href="#9578c8ca712ef7a7ad3e8570c0f38f92"><span class="id" title="binder">Σ</span></a>} (<a id="315cc331318866a6ac225207c37564a1" class="idref" href="#315cc331318866a6ac225207c37564a1"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9578c8ca712ef7a7ad3e8570c0f38f92"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) (<a id="t:180" class="idref" href="#t:180"><span class="id" title="binder">t</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#term"><span class="id" title="inductive">PCUICAst.term</span></a>) (<a id="w:181" class="idref" href="#w:181"><span class="id" title="binder">w</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#welltyped"><span class="id" title="inductive">welltyped</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9578c8ca712ef7a7ad3e8570c0f38f92"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:180"><span class="id" title="variable">t</span></a>) : <a class="idref" href="MetaRocq.Erasure.EAst.html#term"><span class="id" title="inductive">term</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="wfext:182" class="idref" href="#wfext:182"><span class="id" title="binder">wfext</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#make_env"><span class="id" title="definition">make_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#315cc331318866a6ac225207c37564a1"><span class="id" title="variable">wfΣ</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wfext:182"><span class="id" title="variable">wfext</span></a> (<span class="id" title="var">normalization_in</span> := <span class="id" title="var">_</span>) <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:180"><span class="id" title="variable">t</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="keyword">let</span> '<a class="idref" href="MetaRocq.Utils.MRSquash.html#sq"><span class="id" title="constructor">sq</span></a> <span class="id" title="var">wfΣ</span> := <span class="id" title="var">wfΣ</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">let</span> <a id="nin:184" class="idref" href="#nin:184"><span class="id" title="binder"><span id="nin:186" class="id">nin</span></span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">wfΣ</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">nin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="remove_match_on_box_env_lemma" class="idref" href="#remove_match_on_box_env_lemma"><span class="id" title="lemma">remove_match_on_box_env_lemma</span></a> {<a id="13ce99c998910778525c07f31a0be534" class="idref" href="#13ce99c998910778525c07f31a0be534"><span class="id" title="binder">Σ</span></a>} (<a id="d1bb18a8336e57afea8c69f395fea759" class="idref" href="#d1bb18a8336e57afea8c69f395fea759"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#13ce99c998910778525c07f31a0be534"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) <a id="seeds:189" class="idref" href="#seeds:189"><span class="id" title="binder">seeds</span></a> <a id="ignore:190" class="idref" href="#ignore:190"><span class="id" title="binder">ignore</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#fresh_globals"><span class="id" title="inductive">fresh_globals</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#d1bb18a8336e57afea8c69f395fea759"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:189"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignore:190"><span class="id" title="variable">ignore</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a>, <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">wf_fresh_globals</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="remove_match_on_box_trans_env" class="idref" href="#remove_match_on_box_trans_env"><span class="id" title="lemma">remove_match_on_box_trans_env</span></a> {<a id="0b04ef40381eef0cc372f397be8cde43" class="idref" href="#0b04ef40381eef0cc372f397be8cde43"><span class="id" title="binder">Σ</span></a>} (<a id="c6b10766fe4b1f55e1b229e8732d96f1" class="idref" href="#c6b10766fe4b1f55e1b229e8732d96f1"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf"><span class="id" title="class">wf</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0b04ef40381eef0cc372f397be8cde43"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>) <a id="seeds:193" class="idref" href="#seeds:193"><span class="id" title="binder">seeds</span></a> <a id="ignore:194" class="idref" href="#ignore:194"><span class="id" title="binder">ignore</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Common.EnvMap.html#EnvMap.fresh_globals"><span class="id" title="inductive">EnvMap.fresh_globals</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#c6b10766fe4b1f55e1b229e8732d96f1"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#seeds:193"><span class="id" title="variable">seeds</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignore:194"><span class="id" title="variable">ignore</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_env_obligation_1"><span class="id" title="lemma">OptimizePropDiscr.remove_match_on_box_env_obligation_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Extraction.html#fresh_globals_erase_global_decl_rec"><span class="id" title="lemma">fresh_globals_erase_global_decl_rec</span></a>, <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_fresh_globals"><span class="id" title="lemma">wf_fresh_globals</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#"><span class="id" title="module">EWellformed</span></a>.<br/>
<span class="id" title="keyword">Theorem</span> <a id="extract_correct_gen" class="idref" href="#extract_correct_gen"><span class="id" title="lemma">extract_correct_gen</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H:195" class="idref" href="#H:195"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="wfl:196" class="idref" href="#wfl:196"><span class="id" title="binder">wfl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">default_wcbv_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="00141100b2eec50e7a09b3593cab343f" class="idref" href="#00141100b2eec50e7a09b3593cab343f"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#P.global_env_ext"><span class="id" title="definition">P.global_env_ext</span></a>) (<a id="9b6f7ebed165915dbf9322952986f206" class="idref" href="#9b6f7ebed165915dbf9322952986f206"><span class="id" title="binder">wfΣ</span></a> : <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a><a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="t:199" class="idref" href="#t:199"><span class="id" title="binder">t</span></a> <a id="v:200" class="idref" href="#v:200"><span class="id" title="binder">v</span></a> <a id="ignored:201" class="idref" href="#ignored:201"><span class="id" title="binder">ignored</span></a> <a id="masks:202" class="idref" href="#masks:202"><span class="id" title="binder">masks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="overridden_masks:203" class="idref" href="#overridden_masks:203"><span class="id" title="binder">overridden_masks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="do_trim_const_masks:204" class="idref" href="#do_trim_const_masks:204"><span class="id" title="binder">do_trim_const_masks</span></a> <a id="do_trim_ctor_masks:205" class="idref" href="#do_trim_ctor_masks:205"><span class="id" title="binder">do_trim_ctor_masks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Extract.html#axiom_free"><span class="id" title="definition">axiom_free</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="wt:206" class="idref" href="#wt:206"><span class="id" title="binder">wt</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#welltyped"><span class="id" title="inductive">welltyped</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:199"><span class="id" title="variable">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">p</span></a><a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:199"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#0cb9631b9ab072cb900cf2fb3f66f9a2"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:200"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#isErasable"><span class="id" title="definition">isErasable</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:199"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:207" class="idref" href="#k:207"><span class="id" title="binder">k</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:201"><span class="id" title="variable">ignored</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#k:207"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="t':208" class="idref" href="#t':208"><span class="id" title="binder">t'</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9b6f7ebed165915dbf9322952986f206"><span class="id" title="variable">wfΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:199"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wt:206"><span class="id" title="variable">wt</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="deps:209" class="idref" href="#deps:209"><span class="id" title="binder">deps</span></a> := (<a class="idref" href="MetaRocq.Erasure.EAstUtils.html#term_global_deps"><span class="id" title="definition">EAstUtils.term_global_deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t':208"><span class="id" title="variable">t'</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="88ce20138670be1b8bd0847d6d924ca5" class="idref" href="#88ce20138670be1b8bd0847d6d924ca5"><span class="id" title="binder">erΣ</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9b6f7ebed165915dbf9322952986f206"><span class="id" title="variable">wfΣ</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:209"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:201"><span class="id" title="variable">ignored</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="b7ecec57b9ba76acdbdd4c332afa2502" class="idref" href="#b7ecec57b9ba76acdbdd4c332afa2502"><span class="id" title="binder">gerΣ</span></a> := <a class="idref" href="MetaRocq.Erasure.EEnvMap.html#GlobalContextMap.make"><span class="id" title="definition">EEnvMap.GlobalContextMap.make</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#88ce20138670be1b8bd0847d6d924ca5"><span class="id" title="variable">erΣ</span></a>)<br/>
&nbsp;&nbsp;(<a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_fresh_globals"><span class="id" title="lemma">trans_env_fresh_globals</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#88ce20138670be1b8bd0847d6d924ca5"><span class="id" title="variable">erΣ</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#remove_match_on_box_env_lemma"><span class="id" title="lemma">remove_match_on_box_env_lemma</span></a> (<a class="idref" href="MetaRocq.Utils.MRSquash.html#map_squash"><span class="id" title="lemma">map_squash</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#9b6f7ebed165915dbf9322952986f206"><span class="id" title="variable">wfΣ</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:209"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:201"><span class="id" title="variable">ignored</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="202028b5be86517a7143c0dbc47b0b4e" class="idref" href="#202028b5be86517a7143c0dbc47b0b4e"><span class="id" title="binder">erΣ</span></a> := <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#remove_match_on_box_env"><span class="id" title="definition">remove_match_on_box_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#88ce20138670be1b8bd0847d6d924ca5"><span class="id" title="variable">erΣ</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#remove_match_on_box_env_lemma"><span class="id" title="lemma">remove_match_on_box_env_lemma</span></a> <span class="id" title="var">_</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#deps:209"><span class="id" title="variable">deps</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#ignored:201"><span class="id" title="variable">ignored</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">compute_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#overridden_masks:203"><span class="id" title="variable">overridden_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_const_masks:204"><span class="id" title="variable">do_trim_const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_ctor_masks:205"><span class="id" title="variable">do_trim_ctor_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#202028b5be86517a7143c0dbc47b0b4e"><span class="id" title="variable">erΣ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="t'':213" class="idref" href="#t'':213"><span class="id" title="binder">t''</span></a> := <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b7ecec57b9ba76acdbdd4c332afa2502"><span class="id" title="variable">gerΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t':208"><span class="id" title="variable">t'</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t'':213"><span class="id" title="variable">t''</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t'':213"><span class="id" title="variable">t''</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v':214" class="idref" href="#v':214"><span class="id" title="binder">v'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#00141100b2eec50e7a09b3593cab343f"><span class="id" title="variable">Σ</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">;;;</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">|-</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:200"><span class="id" title="variable">v</span></a> <a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">⇝</span></a><a class="idref" href="MetaRocq.Erasure.Extract.html#0343a91997e2a7c4174c89d27a2fb981"><span class="id" title="notation">ℇ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v':214"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a> (<span class="id" title="var">wfl</span> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#202028b5be86517a7143c0dbc47b0b4e"><span class="id" title="variable">erΣ</span></a>)) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_term"><span class="id" title="definition">dearg_term</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t'':213"><span class="id" title="variable">t''</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_term"><span class="id" title="definition">dearg_term</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:202"><span class="id" title="variable">masks</span></a> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box"><span class="id" title="definition">EOptimizePropDiscr.remove_match_on_box</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#b7ecec57b9ba76acdbdd4c332afa2502"><span class="id" title="variable">gerΣ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v':214"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ax</span> [<span class="id" title="var">T</span> <span class="id" title="var">wt</span>] <span class="id" title="var">ev</span> <span class="id" title="var">not_erasable</span> <span class="id" title="var">no_ignores</span> <span class="id" title="var">t'</span> <span class="id" title="var">deps</span> <span class="id" title="var">er</span> <span class="id" title="var">ger</span> <span class="id" title="var">er'</span> <span class="id" title="var">hmas</span> <span class="id" title="var">t''</span> <span class="id" title="var">vcs</span> <span class="id" title="var">isexp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> -[<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#dearg_transform"><span class="id" title="definition">dearg_transform</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">wfΣ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_term"><span class="id" title="definition">erase_term</span></a>, <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#make_env"><span class="id" title="definition">make_env</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_make_wf_env_ext"><span class="id" title="definition">abstract_make_wf_env_ext</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#abstract_env_ext_exists"><span class="id" title="method">abstract_env_ext_exists</span></a> <span class="id" title="var">e</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">Σe</span> <span class="id" title="var">he</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;[<span class="id" title="var">H</span> := <span class="id" title="keyword">context</span> [ @<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erase"><span class="id" title="definition">erase</span></a> ?<span class="id" title="var">X_type</span> ?<span class="id" title="var">X</span> ?<span class="id" title="var">nin</span> ?<span class="id" title="var">Γ</span> <span class="id" title="var">t</span> ?<span class="id" title="var">wt</span> ] |- <span class="id" title="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (@<a class="idref" href="MetaRocq.Erasure.ErasureFunction.html#erases_erase"><span class="id" title="lemma">erases_erase</span></a> <span class="id" title="var">X_type</span> <span class="id" title="var">X</span> <span class="id" title="var">nin</span> <span class="id" title="var">Γ</span> <span class="id" title="var">t</span> <span class="id" title="var">wt</span> <span class="id" title="var">_</span> <span class="id" title="var">he</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">he</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">Σe</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Σ</span> <span class="id" title="var">univs</span>]; <span class="id" title="var">cbn</span> [<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">wv</span> : <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#welltyped"><span class="id" title="inductive">welltyped</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">Σ</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">univs</span><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">[]</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.PCUICClassification.html#subject_reduction_eval"><span class="id" title="lemma">PCUICClassification.subject_reduction_eval</span></a>; <span class="id" title="var">tea</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureCorrectness.html#erases_correct"><span class="id" title="lemma">erases_correct</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">Σ'</span> := <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">er</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">erv</span>&amp;<span class="id" title="var">erase_to</span>&amp;[<span class="id" title="var">erev</span>]);<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;2:{ <span class="id" title="var">now</span> <span class="id" title="tactic">eexists</span>. }<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">∃</span> <span class="id" title="var">erv</span>. <span class="id" title="tactic">split</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_transform_gen_correct"><span class="id" title="lemma">dearg_transform_gen_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<a class="idref" href="MetaRocq.Erasure.EWellformed.html#wf_glob"><span class="id" title="inductive">EWellformed.wf_glob</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <span class="id" title="var">er'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">er'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_remove_match_on_box_env"><span class="id" title="lemma">trans_env_remove_match_on_box_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_env_wf"><span class="id" title="lemma">EOptimizePropDiscr.remove_match_on_box_env_wf</span></a> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">EWellformed.wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">t''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#closed_remove_match_on_box"><span class="id" title="lemma">EOptimizePropDiscr.closed_remove_match_on_box</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">EWellformed.wellformed_closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_wellformed_weaken"><span class="id" title="lemma">erase_wellformed_weaken</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Γ</span>:=<span class="id" title="notation">[]</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="var">cbn</span>; <span class="id" title="tactic">congruence</span>. } 2:<span class="id" title="tactic">exact</span> <span class="id" title="var">deps</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span> <span class="id" title="var">t''</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizePropDiscr.html#trans_env_remove_match_on_box_env"><span class="id" title="lemma">trans_env_remove_match_on_box_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.EOptimizePropDiscr.html#remove_match_on_box_correct"><span class="id" title="lemma">EOptimizePropDiscr.remove_match_on_box_correct</span></a> (<span class="id" title="var">fl</span> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#default_wcbv_flags"><span class="id" title="definition">default_wcbv_flags</span></a>)) ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed_env"><span class="id" title="lemma">EWellformed.wellformed_closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#wf_erase_global_decls_recursive"><span class="id" title="lemma">wf_erase_global_decls_recursive</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.EWellformed.html#wellformed_closed"><span class="id" title="lemma">wellformed_closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_wellformed_weaken"><span class="id" title="lemma">erase_wellformed_weaken</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <span class="id" title="var">Σ</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Γ</span> := <span class="id" title="notation">[]</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="var">cbn</span>; <span class="id" title="tactic">congruence</span>. } 2:<span class="id" title="tactic">exact</span> <span class="id" title="var">deps</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.Erasure.html#fake_normalization"><span class="id" title="axiom">Erasure.fake_normalization</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#erase_global_erases_deps"><span class="id" title="lemma">erase_global_erases_deps</span></a>; <span class="id" title="var">tea</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">er</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#erase_env"><span class="id" title="definition">erase_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">obl</span> := <span class="id" title="keyword">fun</span> (<a id="90d602eb136ac1f4790797075c8740d2" class="idref" href="#90d602eb136ac1f4790797075c8740d2"><span class="id" title="binder"><span id="21cecec8697596f45c23c85be55a6269" class="id">Σ'</span></span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>) ⇒ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Σ</span>; <span class="id" title="var">cbn</span> [<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a>] <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="MetaRocq.Erasure.Typed.ErasureCorrectness.html#erase_global_decls_deps_recursive_correct"><span class="id" title="lemma">erase_global_decls_deps_recursive_correct</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">obl</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.ErasureFunctionProperties.html#term_global_deps_spec"><span class="id" title="lemma">term_global_deps_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">hin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">hin</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">decl</span> <span class="id" title="var">eq</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">w</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="extract_correct_gen'" class="idref" href="#extract_correct_gen'"><span class="id" title="lemma">extract_correct_gen'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H:217" class="idref" href="#H:217"><span class="id" title="binder">H</span></a> := <a class="idref" href="MetaRocq.Erasure.EWellformed.html#all_env_flags"><span class="id" title="definition">EWellformed.all_env_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="wfl:218" class="idref" href="#wfl:218"><span class="id" title="binder">wfl</span></a> := <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#opt_wcbv_flags"><span class="id" title="definition">opt_wcbv_flags</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="1ab40656d5e5c89572799d4533e92d93" class="idref" href="#1ab40656d5e5c89572799d4533e92d93"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#global_env"><span class="id" title="definition">ExAst.global_env</span></a>) <a id="t:220" class="idref" href="#t:220"><span class="id" title="binder">t</span></a> <a id="v:221" class="idref" href="#v:221"><span class="id" title="binder">v</span></a> <a id="masks:222" class="idref" href="#masks:222"><span class="id" title="binder">masks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="overridden_masks:223" class="idref" href="#overridden_masks:223"><span class="id" title="binder">overridden_masks</span></a> <a id="do_trim_const_masks:224" class="idref" href="#do_trim_const_masks:224"><span class="id" title="binder">do_trim_const_masks</span></a> <a id="do_trim_ctor_masks:225" class="idref" href="#do_trim_ctor_masks:225"><span class="id" title="binder">do_trim_ctor_masks</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.EGlobalEnv.html#closed_env"><span class="id" title="definition">EGlobalEnv.closed_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#1ab40656d5e5c89572799d4533e92d93"><span class="id" title="variable">Σ</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.ELiftSubst.html#closedn"><span class="id" title="definition">ELiftSubst.closedn</span></a> 0 <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:220"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#1ab40656d5e5c89572799d4533e92d93"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">e</span></a><a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⊢</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:220"><span class="id" title="variable">t</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.WcbvEvalAux.html#980e857420eb625c55a05cb0d6ed74af"><span class="id" title="notation">⇓</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:221"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#compute_masks"><span class="id" title="definition">compute_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#overridden_masks:223"><span class="id" title="variable">overridden_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_const_masks:224"><span class="id" title="variable">do_trim_const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#do_trim_ctor_masks:225"><span class="id" title="variable">do_trim_ctor_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#1ab40656d5e5c89572799d4533e92d93"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ResultMonad.html#Ok"><span class="id" title="constructor">Ok</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#valid_cases"><span class="id" title="definition">valid_cases</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:220"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#is_expanded"><span class="id" title="definition">is_expanded</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#ind_masks"><span class="id" title="projection">ind_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.Optimize.html#const_masks"><span class="id" title="projection">const_masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a>) <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:220"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="MetaRocq.Erasure.EWcbvEval.html#eval"><span class="id" title="inductive">EWcbvEval.eval</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.ExAst.html#trans_env"><span class="id" title="definition">trans_env</span></a> (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_env"><span class="id" title="definition">dearg_env</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#1ab40656d5e5c89572799d4533e92d93"><span class="id" title="variable">Σ</span></a>)) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_term"><span class="id" title="definition">dearg_term</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#t:220"><span class="id" title="variable">t</span></a>) (<a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_term"><span class="id" title="definition">dearg_term</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#masks:222"><span class="id" title="variable">masks</span></a> <a class="idref" href="MetaRocq.Erasure.Typed.ExtractionCorrectness.html#v:221"><span class="id" title="variable">v</span></a>) <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cle</span> <span class="id" title="var">clt</span> <span class="id" title="var">ev</span> <span class="id" title="var">hmas</span> <span class="id" title="var">vcs</span> <span class="id" title="var">isexp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">sq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.Erasure.Typed.OptimizeCorrectness.html#dearg_transform_gen_correct"><span class="id" title="lemma">dearg_transform_gen_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Print&nbsp;Assumptions&nbsp;extract_correct.&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
There are some assumptions of which almost all are in MetaRocq.
    From this project is only assume_env_wellformed assumption which is
    used to assume that the environments we extract are
    wellformed. MetaRocq's safe checker does not run from within Rocq, so
    we cannot type check the environments. However, our environments
    are unquoted directly from Rocq's kernel where they are already
    welltyped, so this is justified (and the same assumption is used in
    MetaRocq when they run their erasure).

<div class="paragraph"> </div>

    The rest of the assumptions are normal MetaRocq assumptions
    (which are justified in Rocq Rocq Correct!).

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">JMeq.JMeq_eq</span></span> leaks from the use of some tactics and probably can be avoided.
 
</div>
<div class="code">
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
