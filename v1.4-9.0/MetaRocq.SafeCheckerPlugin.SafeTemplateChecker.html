<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./index.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">Library MetaRocq.SafeCheckerPlugin.SafeTemplateChecker</h1>

<div class="code">
<span class="comment">(*&nbsp;Distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;MIT&nbsp;license.&nbsp;*)</span><br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Program</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.utils.html#"><span class="id" title="library">utils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Common</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Common.config.html#"><span class="id" title="library">config</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.Template</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Template.AstUtils.html#"><span class="id" title="library">AstUtils</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.PCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#"><span class="id" title="library">PCUICAst</span></a> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#"><span class="id" title="library">PCUICAstUtils</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#"><span class="id" title="library">PCUICTyping</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#"><span class="id" title="library">PCUICSN</span></a> <a class="idref" href="MetaRocq.PCUIC.Bidirectional.BDToPCUIC.html#"><span class="id" title="library">BDToPCUIC</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICProgram.html#"><span class="id" title="library">PCUICProgram</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.SafeChecker</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#"><span class="id" title="library">PCUICErrors</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#"><span class="id" title="library">PCUICSafeChecker</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#"><span class="id" title="library">PCUICWfEnv</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#"><span class="id" title="library">PCUICWfEnvImpl</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.Utils.monad_utils.html#MRMonadNotation"><span class="id" title="module">MRMonadNotation</span></a>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MetaRocq.TemplatePCUIC</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#"><span class="id" title="library">TemplateToPCUIC</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="trans_program" class="idref" href="#trans_program"><span class="id" title="definition">trans_program</span></a> (<a id="p:1" class="idref" href="#p:1"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.program"><span class="id" title="definition">Ast.Env.program</span></a>) : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.program"><span class="id" title="definition">program</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="3d19765a7cabb12219cbdf7f2c787f02" class="idref" href="#3d19765a7cabb12219cbdf7f2c787f02"><span class="id" title="binder">Σ'</span></a> := <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#trans_global_env"><span class="id" title="definition">trans_global_env</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:1"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#3d19765a7cabb12219cbdf7f2c787f02"><span class="id" title="variable">Σ'</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#trans"><span class="id" title="definition">trans</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#3d19765a7cabb12219cbdf7f2c787f02"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:1"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="EnvCheck_wf_env_ext" class="idref" href="#EnvCheck_wf_env_ext"><span class="id" title="definition">EnvCheck_wf_env_ext</span></a> {<a id="cf:3" class="idref" href="#cf:3"><span class="id" title="binder">cf</span></a>:<a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} {<a id="guard:4" class="idref" href="#guard:4"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} := <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#EnvCheck"><span class="id" title="inductive">EnvCheck</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_ext"><span class="id" title="record">wf_env_ext</span></a>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <a id="Monad_EnvCheck_wf_env_ext" class="idref" href="#Monad_EnvCheck_wf_env_ext"><span class="id" title="instance">Monad_EnvCheck_wf_env_ext</span></a> {<a id="cf:5" class="idref" href="#cf:5"><span class="id" title="binder">cf</span></a>:<a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} {<a id="guard:6" class="idref" href="#guard:6"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>} : <a class="idref" href="MetaRocq.Utils.monad_utils.html#Monad"><span class="id" title="class">Monad</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#EnvCheck_wf_env_ext"><span class="id" title="definition">EnvCheck_wf_env_ext</span></a> := <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="infer_template_program" class="idref" href="#infer_template_program"><span class="id" title="definition">infer_template_program</span></a> {<a id="cf:7" class="idref" href="#cf:7"><span class="id" title="binder">cf</span></a> : <a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} {<a id="nor:8" class="idref" href="#nor:8"><span class="id" title="binder">nor</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#normalizing_flags"><span class="id" title="class">normalizing_flags</span></a>} {<a id="guard:9" class="idref" href="#guard:9"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>}<br/>
&nbsp;&nbsp;(<a id="p:10" class="idref" href="#p:10"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.program"><span class="id" title="definition">Ast.Env.program</span></a>) <a id="e6d4c98ae473993ff04763d655d26b6f" class="idref" href="#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="binder">φ</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;this&nbsp;is&nbsp;the&nbsp;hypothesis&nbsp;we&nbsp;need,&nbsp;idk&nbsp;how&nbsp;to&nbsp;simplify&nbsp;it&nbsp;or&nbsp;appropriately&nbsp;generalize&nbsp;it,&nbsp;maybe&nbsp;use&nbsp;check_wf_env_ext_prop&nbsp;to&nbsp;simplify&nbsp;Σ0&nbsp;∼_ext&nbsp;X'&nbsp;into&nbsp;_&nbsp;∼&nbsp;X&nbsp;so&nbsp;that&nbsp;we&nbsp;get&nbsp;an&nbsp;equality?&nbsp;*)</span><br/>
&nbsp;&nbsp;{<a id="normalization_in:18" class="idref" href="#normalization_in:18"><span class="id" title="binder">normalization_in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> (<a id="g:12" class="idref" href="#g:12"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">global_decl</span></a>) (<a id="Hdecls':13" class="idref" href="#Hdecls':13"><span class="id" title="binder">Hdecls'</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="X:14" class="idref" href="#X:14"><span class="id" title="binder">X</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_type"><span class="id" title="definition">X_env_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="a785852d37ccfd41c2d02c947d0b9883" class="idref" href="#a785852d37ccfd41c2d02c947d0b9883"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#a785852d37ccfd41c2d02c947d0b9883"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#9897e19d536bda84609b8ab92c34be9b"><span class="id" title="notation">∼</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X:14"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#a785852d37ccfd41c2d02c947d0b9883"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a> := <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#Hdecls':13"><span class="id" title="variable">Hdecls'</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X':16" class="idref" href="#X':16"><span class="id" title="binder">X'</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_ext_type"><span class="id" title="definition">X_env_ext_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#check_wf_env_ext_prop"><span class="id" title="definition">check_wf_env_ext_prop</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X:14"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X':16"><span class="id" title="variable">X'</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#universes_decl_of_decl"><span class="id" title="definition">universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#g:12"><span class="id" title="variable">g</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="17f79c9b403698cdd47860561138788d" class="idref" href="#17f79c9b403698cdd47860561138788d"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">global_env_ext</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#17f79c9b403698cdd47860561138788d"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#17f79c9b403698cdd47860561138788d"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X':16"><span class="id" title="variable">X'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">NormalizationIn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#17f79c9b403698cdd47860561138788d"><span class="id" title="variable">Σ0</span></a>}<br/>
&nbsp;&nbsp;{<a id="normalization_in':21" class="idref" href="#normalization_in':21"><span class="id" title="binder">normalization_in'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> <a id="x:19" class="idref" href="#x:19"><span class="id" title="binder">x</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_ext_type"><span class="id" title="definition">X_env_ext_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="variable">φ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#x:19"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="f8cd4500ff4fee5cd966dfeb97ee3847" class="idref" href="#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">global_env_ext</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#x:19"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">NormalizationIn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;: <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#EnvCheck_wf_env_ext"><span class="id" title="definition">EnvCheck_wf_env_ext</span></a> (<span class="id" title="keyword">let</span> <a id="p':22" class="idref" href="#p':22"><span class="id" title="binder">p'</span></a> := <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">∑</span></a> <a id="A:23" class="idref" href="#A:23"><span class="id" title="binder">A</span></a><a class="idref" href="MetaRocq.Utils.MRPrelude.html#cd4bc1b07c8b3bdc9f3bbc7941b56107"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">{</span></a> <a id="X:24" class="idref" href="#X:24"><span class="id" title="binder">X</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">:</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_ext"><span class="id" title="record">wf_env_ext</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p':22"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="variable">φ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X:24"><span class="id" title="variable">X</span></a>.(<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#wf_env_ext_reference"><span class="id" title="projection">wf_env_ext_reference</span></a>).(<a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#reference_impl_env_ext"><span class="id" title="projection">reference_impl_env_ext</span></a>) <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p':22"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="variable">φ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#52eddd74560fa276f934634af83eeaf4"><span class="id" title="notation">×</span></a>  <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p':22"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="variable">φ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#f6519f471ad5acf69089466a686d7a45"><span class="id" title="notation">;;;</span></a> <span class="id" title="notation">[]</span> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#f6519f471ad5acf69089466a686d7a45"><span class="id" title="notation">|-</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p':22"><span class="id" title="variable">p'</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#f6519f471ad5acf69089466a686d7a45"><span class="id" title="notation">:</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#A:23"><span class="id" title="variable">A</span></a> <a class="idref" href="MetaRocq.Utils.MRSquash.html#2403cb4f4230cf3f6910dd7542d09118"><span class="id" title="notation">∥</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#6556914db359db999889decec6a4a562"><span class="id" title="notation">}</span></a>) :=<br/>
&nbsp;&nbsp;<a id="pp:25" class="idref" href="#pp:25"><span class="id" title="binder">pp</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#typecheck_program"><span class="id" title="definition">typecheck_program</span></a> (<span class="id" title="var">cf</span> := <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#cf:7"><span class="id" title="variable">cf</span></a>) (<span class="id" title="var">nor</span>:=<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#nor:8"><span class="id" title="variable">nor</span></a>) <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> (<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:10"><span class="id" title="variable">p</span></a>) <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#e6d4c98ae473993ff04763d655d26b6f"><span class="id" title="variable">φ</span></a> <a class="idref" href="MetaRocq.Utils.monad_utils.html#8af26cd2ebe96eaae34c9438ab910a63"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="MetaRocq.Utils.monad_utils.html#ret"><span class="id" title="method">ret</span></a> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#pp:25"><span class="id" title="variable">pp</span></a><a class="idref" href="MetaRocq.Utils.MRPrelude.html#9068efa82fa7bcf30341b045859b1c5b"><span class="id" title="notation">.π1</span></a> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">;</span></a> <a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#pp:25"><span class="id" title="variable">pp</span></a><a class="idref" href="MetaRocq.Utils.MRPrelude.html#777d545f3df7a0e7c9a56d33a4f5d56c"><span class="id" title="notation">.π2</span></a>) <span class="id" title="var">_</span><a class="idref" href="MetaRocq.Utils.MRPrelude.html#7957360534ce47b451efaf295515cd1d"><span class="id" title="notation">))</span></a>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">sq</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p0</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="MetaRocq.PCUIC.Bidirectional.BDToPCUIC.html#infering_typing"><span class="id" title="lemma">infering_typing</span></a>; <span class="id" title="var">tea</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="infer_and_print_template_program" class="idref" href="#infer_and_print_template_program"><span class="id" title="definition">infer_and_print_template_program</span></a> {<a id="cf:26" class="idref" href="#cf:26"><span class="id" title="binder">cf</span></a> : <a class="idref" href="MetaRocq.Common.config.html#checker_flags"><span class="id" title="class">checker_flags</span></a>} {<a id="nor:27" class="idref" href="#nor:27"><span class="id" title="binder">nor</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#normalizing_flags"><span class="id" title="class">normalizing_flags</span></a>} {<a id="guard:28" class="idref" href="#guard:28"><span class="id" title="binder">guard</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#abstract_guard_impl"><span class="id" title="class">abstract_guard_impl</span></a>}<br/>
&nbsp;&nbsp;(<a id="p:29" class="idref" href="#p:29"><span class="id" title="binder">p</span></a> : <a class="idref" href="MetaRocq.Template.Ast.html#Env.program"><span class="id" title="definition">Ast.Env.program</span></a>) <a id="33c066d1e6b296e2606e1d62c300d1f1" class="idref" href="#33c066d1e6b296e2606e1d62c300d1f1"><span class="id" title="binder">φ</span></a><br/>
<span class="comment">(*&nbsp;this&nbsp;is&nbsp;the&nbsp;hypothesis&nbsp;we&nbsp;need,&nbsp;idk&nbsp;how&nbsp;to&nbsp;simplify&nbsp;it&nbsp;or&nbsp;appropriately&nbsp;generalize&nbsp;it,&nbsp;maybe&nbsp;use&nbsp;check_wf_env_ext_prop&nbsp;to&nbsp;simplify&nbsp;Σ0&nbsp;∼_ext&nbsp;X'&nbsp;into&nbsp;_&nbsp;∼&nbsp;X&nbsp;so&nbsp;that&nbsp;we&nbsp;get&nbsp;an&nbsp;equality?&nbsp;*)</span><br/>
&nbsp;&nbsp;{<a id="normalization_in:37" class="idref" href="#normalization_in:37"><span class="id" title="binder">normalization_in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> (<a id="g:31" class="idref" href="#g:31"><span class="id" title="binder">g</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_decl"><span class="id" title="inductive">global_decl</span></a>) (<a id="Hdecls':32" class="idref" href="#Hdecls':32"><span class="id" title="binder">Hdecls'</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="X:33" class="idref" href="#X:33"><span class="id" title="binder">X</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_type"><span class="id" title="definition">X_env_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="698abbbe4810bf2acf7196dc109f7495" class="idref" href="#698abbbe4810bf2acf7196dc109f7495"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env"><span class="id" title="record">global_env</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#698abbbe4810bf2acf7196dc109f7495"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#9897e19d536bda84609b8ab92c34be9b"><span class="id" title="notation">∼</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X:33"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#698abbbe4810bf2acf7196dc109f7495"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">{|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.universes"><span class="id" title="projection">universes</span></a> := <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Lists.ListDef.html#skipn"><span class="id" title="definition">skipn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#Hdecls':32"><span class="id" title="variable">Hdecls'</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.declarations"><span class="id" title="projection">declarations</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> := <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.retroknowledge"><span class="id" title="projection">retroknowledge</span></a> <a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">|}</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="X':35" class="idref" href="#X':35"><span class="id" title="binder">X'</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_ext_type"><span class="id" title="definition">X_env_ext_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#check_wf_env_ext_prop"><span class="id" title="definition">check_wf_env_ext_prop</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X:33"><span class="id" title="variable">X</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X':35"><span class="id" title="variable">X'</span></a> (<a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#universes_decl_of_decl"><span class="id" title="definition">universes_decl_of_decl</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#g:31"><span class="id" title="variable">g</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="135a7bc307c133d297b9be08b92e3e3c" class="idref" href="#135a7bc307c133d297b9be08b92e3e3c"><span class="id" title="binder">Σ0</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">global_env_ext</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#135a7bc307c133d297b9be08b92e3e3c"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#135a7bc307c133d297b9be08b92e3e3c"><span class="id" title="variable">Σ0</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#X':35"><span class="id" title="variable">X'</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">NormalizationIn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#135a7bc307c133d297b9be08b92e3e3c"><span class="id" title="variable">Σ0</span></a>}<br/>
&nbsp;&nbsp;{<a id="normalization_in':40" class="idref" href="#normalization_in':40"><span class="id" title="binder">normalization_in'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> <a id="x:38" class="idref" href="#x:38"><span class="id" title="binder">x</span></a> : <a class="idref" href="MetaRocq.SafeChecker.PCUICSafeChecker.html#X_env_ext_type"><span class="id" title="definition">X_env_ext_type</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnvImpl.html#optimized_abstract_env_impl"><span class="id" title="definition">optimized_abstract_env_impl</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">(</span></a><a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#trans_program"><span class="id" title="definition">trans_program</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">).1</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#33c066d1e6b296e2606e1d62c300d1f1"><span class="id" title="variable">φ</span></a><a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#x:38"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="35567acd9698191de072da28ede88db8" class="idref" href="#35567acd9698191de072da28ede88db8"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="MetaRocq.PCUIC.PCUICAst.html#PCUICEnvironment.global_env_ext"><span class="id" title="definition">global_env_ext</span></a>, <a class="idref" href="MetaRocq.PCUIC.PCUICTyping.html#wf_ext"><span class="id" title="class">wf_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#35567acd9698191de072da28ede88db8"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#35567acd9698191de072da28ede88db8"><span class="id" title="variable">Σ</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">∼</span></a><a class="idref" href="MetaRocq.SafeChecker.PCUICWfEnv.html#bac0a333394e2541f259f5481a301f86"><span class="id" title="notation">_ext</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#x:38"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="MetaRocq.PCUIC.PCUICSN.html#NormalizationIn"><span class="id" title="class">NormalizationIn</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#35567acd9698191de072da28ede88db8"><span class="id" title="variable">Σ</span></a>}  : <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#infer_template_program"><span class="id" title="definition">infer_template_program</span></a> (<span class="id" title="var">cf</span>:=<a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#cf:26"><span class="id" title="variable">cf</span></a>) <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#33c066d1e6b296e2606e1d62c300d1f1"><span class="id" title="variable">φ</span></a> <span class="id" title="keyword">return</span> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> <a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="MetaRocq.Utils.bytestring.html#string"><span class="id" title="abbreviation">string</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#CorrectDecl"><span class="id" title="constructor">CorrectDecl</span></a> <span class="id" title="var">t</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="f7ddf502e84bf8c656bf4f40aab5a78d" class="idref" href="#f7ddf502e84bf8c656bf4f40aab5a78d"><span class="id" title="binder">Σ'</span></a> := <a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#trans_global_env"><span class="id" title="definition">trans_global_env</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.1'"><span class="id" title="notation">.1</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> ("Environment is well-formed and " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#string_of_term"><span class="id" title="definition">string_of_term</span></a> (<a class="idref" href="MetaRocq.TemplatePCUIC.TemplateToPCUIC.html#trans"><span class="id" title="definition">trans</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#f7ddf502e84bf8c656bf4f40aab5a78d"><span class="id" title="variable">Σ'</span></a> <a class="idref" href="MetaRocq.SafeCheckerPlugin.SafeTemplateChecker.html#p:29"><span class="id" title="variable">p</span></a><a class="idref" href="MetaRocq.Utils.MRProd.html#::pair_scope:x_'.2'"><span class="id" title="notation">.2</span></a>) <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" has type: " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <a class="idref" href="MetaRocq.PCUIC.utils.PCUICAstUtils.html#string_of_term"><span class="id" title="definition">string_of_term</span></a> <span class="id" title="var">t</span><a class="idref" href="MetaRocq.Utils.MRPrelude.html#9068efa82fa7bcf30341b045859b1c5b"><span class="id" title="notation">.π1</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#EnvError"><span class="id" title="constructor">EnvError</span></a> <span class="id" title="var">Σ</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#AlreadyDeclared"><span class="id" title="constructor">AlreadyDeclared</span></a> <span class="id" title="var">id</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> ("Already declared: " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <span class="id" title="var">id</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#EnvError"><span class="id" title="constructor">EnvError</span></a> <span class="id" title="var">Σ</span> (<a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#IllFormedDecl"><span class="id" title="constructor">IllFormedDecl</span></a> <span class="id" title="var">id</span> <span class="id" title="var">e</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V9.0.0/stdlib//Corelib.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> ("Type error: " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <a class="idref" href="MetaRocq.SafeChecker.PCUICErrors.html#string_of_type_error"><span class="id" title="definition">string_of_type_error</span></a> <span class="id" title="var">Σ</span> <span class="id" title="var">e</span> <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> ", while checking " <a class="idref" href="MetaRocq.Utils.utils.html#ee0c685eaa3e4bb6fc08727e7542b6f9"><span class="id" title="notation">^</span></a> <span class="id" title="var">id</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Program&nbsp;Definition&nbsp;check_template_program&nbsp;{cf&nbsp;:&nbsp;checker_flags}&nbsp;(p&nbsp;:&nbsp;Ast.Env.program)&nbsp;(ty&nbsp;:&nbsp;Ast.Env.term)&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;:&nbsp;EnvCheck&nbsp;(∥&nbsp;trans_global&nbsp;(AstUtils.empty_ext&nbsp;(List.rev&nbsp;p.1))&nbsp;;;;&nbsp;<span class="inlinecode"></span>&nbsp;|-&nbsp;trans&nbsp;p.2&nbsp;:&nbsp;trans&nbsp;ty&nbsp;∥)&nbsp;:=&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;p&nbsp;&lt;-&nbsp;typecheck_program&nbsp;(cf:=cf)&nbsp;((trans_global&nbsp;(AstUtils.empty_ext&nbsp;p.1)).1,&nbsp;trans&nbsp;p.2)&nbsp;;;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;wrap_error&nbsp;"During&nbsp;checking&nbsp;of&nbsp;type&nbsp;constraints"&nbsp;(check&nbsp;p.1&nbsp;_&nbsp;_&nbsp;_&nbsp;(trans&nbsp;ty));;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;ret&nbsp;(Monad:=envcheck_monad)&nbsp;_.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Next&nbsp;Obligation.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;trans_global.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;simpl.&nbsp;unfold&nbsp;empty_ext&nbsp;in&nbsp;X.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;unfold&nbsp;trans_global_decls&nbsp;in&nbsp;X.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;&lt;-map_rev&nbsp;in&nbsp;X.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Program&nbsp;Definition&nbsp;typecheck_template_program'&nbsp;{cf&nbsp;:&nbsp;checker_flags}&nbsp;(p&nbsp;:&nbsp;Ast.Env.program)&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;:&nbsp;EnvCheck&nbsp;(∑&nbsp;A,&nbsp;∥&nbsp;Typing.typing&nbsp;(AstUtils.empty_ext&nbsp;(List.rev&nbsp;p.1))&nbsp;<span class="inlinecode"></span>&nbsp;p.2&nbsp;A&nbsp;∥)&nbsp;:=&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;p&nbsp;&lt;-&nbsp;typecheck_template_program&nbsp;(cf:=cf)&nbsp;p&nbsp;;;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;ret&nbsp;(Monad:=envcheck_monad)&nbsp;(p.π1&nbsp;;&nbsp;_).&nbsp;*)</span><br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
